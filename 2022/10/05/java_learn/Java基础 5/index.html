

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.ico">
  <link rel="icon" href="/img/favicon.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Sean">
  <meta name="keywords" content="">
  
    <meta name="description" content="本章记录 MySQL 数据库相关内容">
<meta property="og:type" content="article">
<meta property="og:title" content="Java基础 第五章">
<meta property="og:url" content="https://s1.gitee.io/2022/10/05/java_learn/Java%E5%9F%BA%E7%A1%80%205/index.html">
<meta property="og:site_name" content="灵感集市">
<meta property="og:description" content="本章记录 MySQL 数据库相关内容">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s1.gitee.io/img/mk-2022-08-10-09-25.png">
<meta property="og:image" content="https://s1.gitee.io/img/mk-2022-08-10-10-14.png">
<meta property="og:image" content="https://s1.gitee.io/img/mk-2022-08-10-10-21.png">
<meta property="og:image" content="https://s1.gitee.io/img/mk-2022-08-10-10-22.png">
<meta property="og:image" content="https://s1.gitee.io/img/mk-2022-08-10-10-30.png">
<meta property="og:image" content="https://s1.gitee.io/img/mk-2022-08-10-11-56.png">
<meta property="og:image" content="https://s1.gitee.io/img/diagrams/MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B.svg">
<meta property="og:image" content="https://s1.gitee.io/img/mk-2022-08-13-10-27.png">
<meta property="og:image" content="https://s1.gitee.io/img/mk-2022-09-15-11-26.png">
<meta property="og:image" content="https://s1.gitee.io/img/mk-2022-09-16-20-59.png">
<meta property="og:image" content="https://s1.gitee.io/img/mk-2022-09-20-10-04.png">
<meta property="og:image" content="https://s1.gitee.io/img/mk-2022-09-21-10-24.png">
<meta property="og:image" content="https://s1.gitee.io/img/mk-2022-09-21-10-32.png">
<meta property="og:image" content="https://s1.gitee.io/img/mk-2022-09-21-10-31.png">
<meta property="og:image" content="https://s1.gitee.io/img/mk-2022-09-22-20-31.png">
<meta property="og:image" content="https://s1.gitee.io/img/mk-2022-09-23-14-50.png">
<meta property="og:image" content="https://s1.gitee.io/img/mk-2022-09-25-10-16.png">
<meta property="og:image" content="https://s1.gitee.io/img/mk-2022-09-25-16-26.png">
<meta property="og:image" content="https://s1.gitee.io/img/mk-2022-09-25-16-35.png">
<meta property="article:published_time" content="2022-10-05T02:05:00.000Z">
<meta property="article:modified_time" content="2022-10-05T03:12:51.808Z">
<meta property="article:author" content="Sean">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="学习">
<meta property="article:tag" content="技术">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://s1.gitee.io/img/mk-2022-08-10-09-25.png">
  
  
  
  <title>Java基础 第五章 - 灵感集市</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hint.css@2/hint.min.css" />

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"s1.gitee.io","root":"/","version":"1.9.3","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.1.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Sean的博客</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-books"></i>
                库
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" target="_blank" rel="noopener" href="https://hexo.fluid-dev.com/">
                    
                    知识分享
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" target="_blank" rel="noopener" href="https://hexo.fluid-dev.com/">
                    
                    摄影日记
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" target="_blank" rel="noopener" href="https://hexo.fluid-dev.com/">
                    
                    经验杂谈
                  </a>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/bg/bg3.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Java基础 第五章"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-10-05 10:05" pubdate>
          2022年10月5日 上午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          <!-- compatible with older versions-->
          61k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          <!-- compatible with older versions-->
          513 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Java基础 第五章</h1>
            
            
              <div class="markdown-body">
                
                <blockquote>
<p>本章记录 MySQL 数据库相关内容</p>
</blockquote>
<span id="more"></span>

<h1 id="Java基础-5"><a href="#Java基础-5" class="headerlink" title="Java基础 5"></a>Java基础 5</h1><h2 id="二十二、MySQL-数据库"><a href="#二十二、MySQL-数据库" class="headerlink" title="二十二、MySQL 数据库"></a>二十二、MySQL 数据库</h2><h3 id="初识-MySQL"><a href="#初识-MySQL" class="headerlink" title="初识 MySQL"></a>初识 MySQL</h3><h4 id="命令行连接数据库"><a href="#命令行连接数据库" class="headerlink" title="命令行连接数据库"></a>命令行连接数据库</h4><ol>
<li><p>Doc 命令启动数据库<br> <code>net start mysql服务名</code><br> <code>net stop mysql服务名</code></p>
</li>
<li><p>连接到 MySQL 服务<br> <img src="/img/mk-2022-08-10-09-25.png" srcset="/img/loading.gif" lazyload alt="连接数据库"></p>
<ul>
<li><p>连接到 MySQL 服务的指令：<br> <code>mysql -h 主机IP -P 端口 -u 用户名 -p密码</code></p>
<ol>
<li><code>-p密码</code>不要有空格</li>
<li><code>-p</code>后面如果没有密码，回车会要求输入密码</li>
<li><code>-h 主机</code>默认为本机</li>
<li><code>-P 端口</code>默认为 <code>3306</code></li>
</ol>
<p>  如：<code>mysql -h 127.0.0.1 -P 3306 -u root -p1234</code></p>
</li>
</ul>
</li>
</ol>
<h4 id="MySQL-数据库的三层结构【重要】"><a href="#MySQL-数据库的三层结构【重要】" class="headerlink" title="MySQL 数据库的三层结构【重要】"></a>MySQL 数据库的三层结构【重要】</h4><ol>
<li><p>所谓安装 <code>MySQL</code> 数据库，就是在主机安装一个数据库管理系统(DBMS)，这个管理程序可以管理多个数据库。DBMS：Database Manage System</p>
</li>
<li><p>一个数据库中可以创建多个表，以保存数据（信息）</p>
</li>
<li><p>数据库管理系统(DBMS)、数据库和表的关系如图所示：<br> <img src="/img/mk-2022-08-10-10-14.png" srcset="/img/loading.gif" lazyload alt="数据库的三层结构"></p>
</li>
<li><p>MySQL 数据库-普通表 的本质仍然是<strong>文件</strong></p>
<ul>
<li>DBMS 数据库管理系统<br>  <code>[mysqld.exe] : 3306</code></li>
<li>MySQL 数据库存储位置<br>  <img src="/img/mk-2022-08-10-10-21.png" srcset="/img/loading.gif" lazyload alt="数据库"></li>
<li>普通表存储位置<br>  <img src="/img/mk-2022-08-10-10-22.png" srcset="/img/loading.gif" lazyload alt="表"></li>
</ul>
</li>
</ol>
<h4 id="数据在数据库中的存储方式"><a href="#数据在数据库中的存储方式" class="headerlink" title="数据在数据库中的存储方式"></a>数据在数据库中的存储方式</h4><p><img src="/img/mk-2022-08-10-10-30.png" srcset="/img/loading.gif" lazyload alt="数据在数据库中的存储方式"></p>
<ul>
<li>表的一行称之为一条记录</li>
<li>在 Java 程序中，一行记录往往使用<strong>对象</strong>表示</li>
</ul>
<h4 id="SQL-语句分类"><a href="#SQL-语句分类" class="headerlink" title="SQL 语句分类"></a>SQL 语句分类</h4><ul>
<li>DDL: 数据定义语句（<code>create</code> 表、库…）</li>
<li>DML: 数据操作语句（增加 <code>insert</code>、修改 <code>update</code>、删除 <code>delete</code>）</li>
<li>DQL: 数据查询语句（查找 <code>select</code>）</li>
<li>DCL: 数据控制语句（管理数据库：如用户权限 <code>grant, revoke</code>）</li>
</ul>
<h4 id="演示-Java-程序编写-MySQL"><a href="#演示-Java-程序编写-MySQL" class="headerlink" title="演示 Java 程序编写 MySQL"></a>演示 Java 程序编写 MySQL</h4><ul>
<li><p>要求：</p>
<ol>
<li>创建一个商品 <code>my_goods</code> 表，选用适当的数据类型</li>
<li>添加 2 条数据</li>
<li>删除表 <code>my_goods</code></li>
<li>注意：需要先下载导入 <code>jdbc</code> 驱动包</li>
</ol>
<table>
<thead>
<tr>
<th align="center">字段</th>
<th align="center">类型</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>id</code></td>
<td align="center">整形</td>
</tr>
<tr>
<td align="center"><code>name</code></td>
<td align="center">字符型</td>
</tr>
<tr>
<td align="center"><code>price</code></td>
<td align="center">小数类型</td>
</tr>
<tr>
<td align="center"><code>introduce</code></td>
<td align="center">文本类型</td>
</tr>
</tbody></table>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment"> * 演示 Java 编写 MySQL</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JavaMysql</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-comment">// 加载类，得到 mysql 连接</span><br>        Class.forName(<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>);<br>        <span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> DriverManager.getConnection(<span class="hljs-string">&quot;jdbc:mysql://127.0.0.1:3306/db01&quot;</span>, <span class="hljs-string">&quot;root&quot;</span>, <span class="hljs-string">&quot;123456&quot;</span>);<br><br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">         * 创建一个商品 my_goods 表，选用适当的数据类型</span><br><span class="hljs-comment">         * 添加 2 条数据</span><br><span class="hljs-comment">         * 删除表 my_goods</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-comment">// 编写 sql （create, select, insert, update, delete...）</span><br>        <span class="hljs-comment">// 创建表</span><br>        <span class="hljs-comment">// String sql = &quot;create table my_goods (id int, name varchar(32), price double,</span><br>        <span class="hljs-comment">// introduce text)&quot;;</span><br>        <span class="hljs-comment">// 添加数据</span><br>        <span class="hljs-comment">// String sql = &quot;insert into my_goods values(1, &#x27;华为手机&#x27;, 2000, &#x27;这是一个手机&#x27;)&quot;;</span><br>        <span class="hljs-comment">// 删除表</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;drop table my_goods&quot;</span>;<br><br>        <span class="hljs-comment">// 得到 Statement 对象，把 sql 语句发送给 mysql(DBMS) 执行</span><br>        <span class="hljs-type">Statement</span> <span class="hljs-variable">statement</span> <span class="hljs-operator">=</span> connection.createStatement();<br>        statement.executeUpdate(sql);<br><br>        <span class="hljs-comment">// 关闭连接</span><br>        statement.close();<br>        connection.close();<br>        System.out.println(<span class="hljs-string">&quot;成功！&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="MySQL-数据库"><a href="#MySQL-数据库" class="headerlink" title="MySQL 数据库"></a>MySQL 数据库</h3><h4 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h4><p><img src="/img/mk-2022-08-10-11-56.png" srcset="/img/loading.gif" lazyload alt="创建数据库"></p>
<ol>
<li><code>CHARACTER SET</code>: 指定数据库采用的字符集，如果不指定字符集，默认 <code>utf8</code></li>
<li><code>COLLATE</code>: 指定数据库字符集的校对规则<br> 常用字符集：<ul>
<li><code>utf8_bin</code>: <strong>区分</strong>大小写</li>
<li><code>utf8_general_ci</code>: <strong>不区分</strong>大小写，默认为 <code>utf8_general_ci</code></li>
</ul>
</li>
</ol>
<ul>
<li><p>演示创建数据库</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 演示数据库的操作<br># 创建一个名称为 db01 的数据库<br><br># 使用指令创建数据库<br><span class="hljs-keyword">CREATE</span> DATABASE db01;<br><br># 在创建数据库、表的时候，为了规避关键字，可以使用反引号解决<br><span class="hljs-keyword">CREATE</span> DATABASE `<span class="hljs-keyword">create</span>`;<br><span class="hljs-keyword">DROP</span> DATABASE `<span class="hljs-keyword">create</span>`;<br><br># 删除数据库<br><span class="hljs-keyword">DROP</span> DATABASE db01;<br><br># 创建一个使用 utf8 字符集的 db02 数据库<br><span class="hljs-keyword">CREATE</span> DATABASE db02 <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> utf8;<br><br># 创建一个使用 utf8 字符集，并带校对规则的 db03 数据库<br># 校对规则 utf8_bin 区分大小写，默认 utf8_general_ci 不区分大小写<br><span class="hljs-keyword">CREATE</span> DATABASE db03 <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> utf8 <span class="hljs-keyword">COLLATE</span> utf8_bin;<br><br># 查询语句，<span class="hljs-operator">*</span> 表示所有字段<br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t1 <span class="hljs-keyword">WHERE</span> NAME <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;tom&#x27;</span>;<br></code></pre></td></tr></table></figure></li>
</ul>
<h4 id="查询、删除数据库"><a href="#查询、删除数据库" class="headerlink" title="查询、删除数据库"></a>查询、删除数据库</h4><ol>
<li>显示数据库语句：<br> <code>SHOW DATABASES</code></li>
<li>显示数据库创建语句：<br> <code>SHOW CREATE DATABASE db_name</code></li>
<li>数据库删除语句：<br> <code>DROP DATABASE [IF EXISTS] db_name</code></li>
</ol>
<p>练习：</p>
<ol>
<li>查看当前数据库服务器中的所有数据库</li>
<li>查看前面创建的 <code>db01</code> 数据库的定义信息</li>
<li>删除前面创建的 <code>db01</code> 数据库</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 演示 删除和查询数据库<br><br># 查看当前数据库服务器中的所有数据库<br><span class="hljs-keyword">SHOW</span> DATABASES;<br><br># 查看前面创建的 db01 数据库的定义信息<br><span class="hljs-keyword">SHOW</span> <span class="hljs-keyword">CREATE</span> DATABASE db02;<br><br># 删除前面创建的 db01 数据库，`[]`括号中为可选参数<br><span class="hljs-keyword">DROP</span> DATABASE [IF <span class="hljs-keyword">EXISTS</span>] db01;<br></code></pre></td></tr></table></figure>

<h4 id="备份恢复数据库"><a href="#备份恢复数据库" class="headerlink" title="备份恢复数据库"></a>备份恢复数据库</h4><ul>
<li>备份数据库（在 DOS 执行）<br>  <code>mysqldump -u 用户名 -p密码 -B 数据库1 数据库2 数据库n &gt; 文件名.sql</code></li>
<li>恢复数据库（进入 MySQL 再执行）<br>  <code>Source 文件名.sql</code></li>
<li>备份库中的表<br>  <code>mysqldump -u 用户名 -p密码 数据库 表1 表2 表n &gt; 文件名.sql</code></li>
</ul>
<p>练习：</p>
<ul>
<li>在 <code>database03.sql</code> 中备份 <code>db02</code> 和 <code>db03</code> 库中的数据，并恢复</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 在 database03.sql 中备份 db02 和 db03 库中的数据，并恢复<br><br># 备份，在 DOS 下执行，mysqldump 指令其实在 mysql 安装目录 bin 下<br># 这个备份文件，就是对应的 <span class="hljs-keyword">sql</span> 语句<br>mysqldump <span class="hljs-operator">-</span>u root <span class="hljs-operator">-</span>p <span class="hljs-operator">-</span>B db02 db03 <span class="hljs-operator">&gt;</span> e:\\bak.sql<br><br><span class="hljs-keyword">DROP</span> DATABASE db02;<br><br># 恢复数据库（进入 MySQL 命令行执行）<br>source e:\\bak.sql<br><br># 第二个恢复方法<br># 把 bak.sql 中的所有语句在查询编辑器中复制执行一遍<br><br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> t1;<br># 备份 db02 库中的表 t1（DOS 下执行）<br>mysqldump <span class="hljs-operator">-</span>u root <span class="hljs-operator">-</span>p db02 t1 <span class="hljs-operator">&gt;</span> e:\\bak02.sql<br><br># 恢复表（MySQL 命令行下执行）<br>USE db02;<br>source e:\\bak02.sql<br></code></pre></td></tr></table></figure>

<h3 id="MySQL-表"><a href="#MySQL-表" class="headerlink" title="MySQL 表"></a>MySQL 表</h3><h4 id="创建表"><a href="#创建表" class="headerlink" title="创建表"></a>创建表</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> table_name<br>(<br>    field1 datatype,<br>    field2 datatype,<br>    field3 datatype,<br>)<span class="hljs-type">character</span> <span class="hljs-keyword">set</span><span class="hljs-operator">=</span>字符集 <span class="hljs-keyword">collate</span><span class="hljs-operator">=</span>校对规则 engine 引擎<br></code></pre></td></tr></table></figure>

<ul>
<li><code>field</code>: 指定列名</li>
<li><code>datatype</code>: 指定列类型（字段类型）</li>
<li><code>character set</code>: 字符集，如不指定则为所在数据库字符集</li>
<li><code>collate</code>: 校对规则，如不指定则为所在数据库校对规则</li>
<li><code>engine</code>: 引擎</li>
<li>有些数据类型需指定长度，比如 <code>varchar</code> 类型</li>
</ul>
<p>注意：创建表时，要根据需保存的数据创建相应的列，并根据数据的类型定义相应的列类型。例如：在 <code>db02</code> 中创建 <code>user</code> 表</p>
<table>
<thead>
<tr>
<th align="center">名称</th>
<th align="center">数据类型</th>
</tr>
</thead>
<tbody><tr>
<td align="center">id</td>
<td align="center">整形</td>
</tr>
<tr>
<td align="center">name</td>
<td align="center">字符串</td>
</tr>
<tr>
<td align="center">password</td>
<td align="center">字符串</td>
</tr>
<tr>
<td align="center">birthday</td>
<td align="center">日期</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 在 db02 中创建表 <span class="hljs-keyword">user</span><br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> `<span class="hljs-keyword">user</span>`;<br><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `<span class="hljs-keyword">user</span>` (<br>  `id` <span class="hljs-type">INT</span>, <span class="hljs-comment">-- 用户 id;</span><br>  `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">255</span>), <span class="hljs-comment">-- 用户名;</span><br>  `password` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>), <span class="hljs-comment">-- 密码;</span><br>  `birthday` <span class="hljs-type">DATE</span> <span class="hljs-comment">-- 生日;</span><br>) <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span><span class="hljs-operator">=</span>utf8 <span class="hljs-keyword">COLLATE</span><span class="hljs-operator">=</span>utf8_unicode_ci ENGINE<span class="hljs-operator">=</span>INNODB;<br></code></pre></td></tr></table></figure>

<ul>
<li><p>创建表练习<br>  创建一个员工表 <code>emp</code>，选用适当的数据类型</p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th align="left">属性</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>id</code></td>
<td align="left">整形</td>
</tr>
<tr>
<td align="left"><code>name</code></td>
<td align="left">字符型</td>
</tr>
<tr>
<td align="left"><code>sex</code></td>
<td align="left">字符型</td>
</tr>
<tr>
<td align="left"><code>birthday</code></td>
<td align="left">日期型</td>
</tr>
<tr>
<td align="left"><code>entry_date</code></td>
<td align="left">日期型</td>
</tr>
<tr>
<td align="left"><code>job</code></td>
<td align="left">字符型</td>
</tr>
<tr>
<td align="left"><code>salary</code></td>
<td align="left">小数型</td>
</tr>
<tr>
<td align="left"><code>resume</code></td>
<td align="left">文本型</td>
</tr>
</tbody></table>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 创建表练习<br># 创建一个员工表 emp，选用适当的数据类型<br><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `emp` (<br>    `id` <span class="hljs-type">INT</span>, <span class="hljs-comment">-- 整形</span><br>    `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>), <span class="hljs-comment">-- 字符型，(32)表示字符数</span><br>    `sex` <span class="hljs-type">CHAR</span>(<span class="hljs-number">1</span>), <span class="hljs-comment">-- 字符型</span><br>    `birthday` <span class="hljs-type">DATE</span>, <span class="hljs-comment">-- 日期型</span><br>    `entry_date` DATETIME, <span class="hljs-comment">-- 日期型</span><br>    `job` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>), <span class="hljs-comment">-- 字符型</span><br>    `salary` <span class="hljs-keyword">DOUBLE</span>, <span class="hljs-comment">-- 小数型</span><br>    `resume` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">255</span>) <span class="hljs-comment">-- 文本型</span><br>) CHARSET<span class="hljs-operator">=</span>utf8 <span class="hljs-keyword">COLLATE</span><span class="hljs-operator">=</span>utf8_bin ENGINE<span class="hljs-operator">=</span>INNODB;<br><br># 添加数据<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `emp` <span class="hljs-keyword">VALUES</span> <br>(<span class="hljs-number">100</span>, <span class="hljs-string">&#x27;孙悟空&#x27;</span>, <span class="hljs-string">&#x27;男&#x27;</span>, <span class="hljs-string">&#x27;2000-11-11&#x27;</span>, <span class="hljs-string">&#x27;2000-11-11 10:10:10&#x27;</span>, <span class="hljs-string">&#x27;取经的&#x27;</span>, <span class="hljs-number">500000</span>, <span class="hljs-string">&#x27;西天取经&#x27;</span>);<br><br># 查询数据<br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `emp`;<br></code></pre></td></tr></table></figure></li>
</ul>
<h4 id="修改与删除表【重要】"><a href="#修改与删除表【重要】" class="headerlink" title="修改与删除表【重要】"></a>修改与删除表【重要】</h4><ol>
<li><p>使用 <code>ALTER TABLE</code> 语句追加、修改、或删除列</p>
<ul>
<li><p>添加</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> table_name<br><span class="hljs-keyword">ADD</span>       (<span class="hljs-keyword">column</span> datatype [<span class="hljs-keyword">DEFAULT</span> expr]<br>          [, <span class="hljs-keyword">column</span> datatype]...);<br></code></pre></td></tr></table></figure>
</li>
<li><p>修改</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> table_name<br>MODIFY    (<span class="hljs-keyword">column</span> datatype [<span class="hljs-keyword">DEFAULT</span> expr]<br>          [, <span class="hljs-keyword">column</span> datatype]...);<br></code></pre></td></tr></table></figure>
</li>
<li><p>删除</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> table_name<br><span class="hljs-keyword">DROP</span>     (<span class="hljs-keyword">column</span>);<br></code></pre></td></tr></table></figure>
</li>
<li><p>查看表的结构: <code>desc 表名;</code> 可以查看表的列</p>
</li>
<li><p>修改表名: <code>rename table 表名 to 新表名;</code></p>
</li>
<li><p>修改列名：<code>alter table 表名 change 列名 新列名 数据类型;</code></p>
</li>
<li><p>修改表字符集: <code>alter table 表名 charset 字符集;</code></p>
</li>
</ul>
</li>
<li><p>应用实例</p>
<ul>
<li><p>员工表 <code>emp</code> 上增加一个 <code>image</code> 列，<code>varchar</code> 类型（要求在 <code>resume</code> 后面）</p>
</li>
<li><p>修改 <code>job</code> 列，使其长度为 <code>60</code></p>
</li>
<li><p>删除 <code>sex</code> 列。</p>
</li>
<li><p>表名改为 <code>employee</code></p>
</li>
<li><p>修改表的字符集为 <code>utf8</code></p>
</li>
<li><p>列名 <code>name</code> 修改为 <code>user_name</code></p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 修改列名<br><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> `table_name`<br>    change `name` `user_name` <span class="hljs-type">varchar</span>(<span class="hljs-number">20</span>);<br></code></pre></td></tr></table></figure></li>
</ul>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 修改表练习（以 emp 表为例）<br><span class="hljs-comment">-- 在 resume 后面增加一个 varchar 类型的 image 列</span><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> `emp` <br>    <span class="hljs-keyword">ADD</span> `image` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>) <br>    <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;&#x27;</span>  <span class="hljs-comment">-- 不允许为 null，默认为 &#x27;&#x27;</span><br>    AFTER `resume`; <span class="hljs-comment">-- 添加在 resume 后面</span><br><br><span class="hljs-comment">-- 修改 job 列，使其长度为 60</span><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> employee <br>    MODIFY job <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">60</span>)<br>    <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;&#x27;</span>;<br><br><span class="hljs-comment">-- 删除 sex 列。</span><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> emp <br>    <span class="hljs-keyword">DROP</span> sex;<br><br><span class="hljs-comment">-- 表名改为 employee</span><br>RENAME <span class="hljs-keyword">TABLE</span> emp <span class="hljs-keyword">TO</span> employee;<br><br><span class="hljs-comment">-- 修改表的字符集为 utf8</span><br><span class="hljs-comment">-- charset 是 character set 的缩写</span><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> employee CHARSET utf8;<br><br><span class="hljs-comment">-- 列名 name 修改为 user_name</span><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> `employee`<br>    CHANGE `name` `user_name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>)<br>    <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;&#x27;</span>;<br><br><span class="hljs-comment">-- 查看表</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `employee`;<br><span class="hljs-comment">-- 查看表的结构（列）</span><br><span class="hljs-keyword">DESC</span> employee; <br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="MySQL-数据类型（列类型-x2F-字段类型）【重要】"><a href="#MySQL-数据类型（列类型-x2F-字段类型）【重要】" class="headerlink" title="MySQL 数据类型（列类型&#x2F;字段类型）【重要】"></a>MySQL 数据类型（列类型&#x2F;字段类型）【重要】</h3><p><img src="/img/diagrams/MySQL%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B.svg" srcset="/img/loading.gif" lazyload alt="MySQL 数据类型"></p>
<table>
<thead>
<tr>
<th>分类</th>
<th>数据类型（列类型）</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>位类型</td>
<td><code>BIN</code></td>
<td>大约 <code>(M+7)/8</code> 个字节，M 指定位数，默认值 1，M 的范围 <code>1~64</code></td>
</tr>
<tr>
<td>数值类型</td>
<td><code>TINYINT</code></td>
<td>1 个字节，带符号的范围是 <code>128~127</code>。无符号 <code>0~255</code>。默认是有符号</td>
</tr>
<tr>
<td>数值类型</td>
<td><code>SMALLINT</code></td>
<td>2 个字节，带符号是 <code>-2^15~2^15-1</code>，无符号 <code>0~2^16-1</code></td>
</tr>
<tr>
<td>数值类型</td>
<td><code>MEDIUMINT</code></td>
<td>3 个字节，带符号是 <code>-2^23~2^23-1</code>，无符号 <code>0~2^24-1</code></td>
</tr>
<tr>
<td>数值类型</td>
<td><code>INT</code></td>
<td>4 个字节，带符号是 <code>-2^31~2^31-1</code>，无符号 <code>0~2^32-1</code></td>
</tr>
<tr>
<td>数值类型</td>
<td><code>BIGINT</code></td>
<td>8 个字节，带符号是 <code>-2^63~2^63-1</code>，无符号 <code>0~2^64-1</code></td>
</tr>
<tr>
<td>数值类型</td>
<td><code>FLOAT</code></td>
<td>单精度小数，占用 4 个字节</td>
</tr>
<tr>
<td>数值类型</td>
<td><code>DOUBLE</code></td>
<td>比 <code>float</code> 精度更大的双精度小数，占用 8 个字节</td>
</tr>
<tr>
<td>数值类型</td>
<td><code>DECIMAL(M, D)</code></td>
<td>定点数 M 指定长度，D 表示小数点的位数</td>
</tr>
<tr>
<td>文本类型</td>
<td><code>CHAR(M)</code></td>
<td>M 个字节，固定长度字符串，大小 <code>0~255 bytes</code></td>
</tr>
<tr>
<td>文本类型</td>
<td><code>VARCHAR(M)</code></td>
<td>可变长度字符串，大小 <code>0~2^16-1 bytes</code></td>
</tr>
<tr>
<td>文本类型</td>
<td><code>TEXT</code></td>
<td>大小 <code>0~2^16 bytes</code></td>
</tr>
<tr>
<td>文本类型</td>
<td><code>LONGTEXT</code></td>
<td>大小 <code>0~2^32 bytes</code></td>
</tr>
<tr>
<td>二进制类型</td>
<td><code>BLOB</code></td>
<td>大小 <code>0~2^16-1 bytes</code></td>
</tr>
<tr>
<td>二进制类型</td>
<td><code>LONGBLOB</code></td>
<td>大小 <code>0~2^32-1 bytes</code></td>
</tr>
<tr>
<td>时间日期</td>
<td><code>DATE</code></td>
<td>占用 3 个字节符，表示年月日 <code>(YYYY-MM-DD)</code></td>
</tr>
<tr>
<td>时间日期</td>
<td><code>YEAR</code></td>
<td>占用 1 个字节符，表示年份 <code>(YYYY)</code></td>
</tr>
<tr>
<td>时间日期</td>
<td><code>TIME</code></td>
<td>占用 3 个字节符，表示时分秒 <code>(HH:MM:SS)</code></td>
</tr>
<tr>
<td>时间日期</td>
<td><code>DATETIME</code></td>
<td>占用 8 个字节符，表示年月日时分秒 <code>(YYYY-MM-DD hh:mm:ss)</code></td>
</tr>
<tr>
<td>时间日期</td>
<td><code>TIMESTAMP</code></td>
<td>占用 4 个字节符，表示时间戳</td>
</tr>
</tbody></table>
<h4 id="数值类型（整数）"><a href="#数值类型（整数）" class="headerlink" title="数值类型（整数）"></a>数值类型（整数）</h4><p>数值型（整数）的基本使用<br><img src="/img/mk-2022-08-13-10-27.png" srcset="/img/loading.gif" lazyload alt="整数"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 以 tinyint 为例，演示整形的使用<br># tinyint 的范围：有符号 <span class="hljs-number">-128</span><span class="hljs-operator">~</span><span class="hljs-number">127</span>；无符号：<span class="hljs-number">0</span><span class="hljs-operator">~</span><span class="hljs-number">255</span><br># 表的字符集，校验规则，存储引擎，使用默认<br># <span class="hljs-number">1.</span> 如果没有指定 unsigned，则 tinyint 就是有符号的<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t3(id TINYINT); <span class="hljs-comment">-- 有符号</span><br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t3 <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">127</span>); <span class="hljs-comment">-- 添加语句</span><br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t3; <span class="hljs-comment">-- 在 t3 中查询所有数据</span><br><br># <span class="hljs-number">2.</span> 如果指定了 unsigned，则 tinyint 就是无符号的<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t4 (id TINYINT UNSIGNED); <span class="hljs-comment">-- 无符号</span><br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t4 <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">256</span>); <span class="hljs-comment">-- 添加语句</span><br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t4; <span class="hljs-comment">-- 在 t3 中查询所有数据</span><br></code></pre></td></tr></table></figure>

<h4 id="位值型（bit）"><a href="#位值型（bit）" class="headerlink" title="位值型（bit）"></a>位值型（bit）</h4><ol>
<li><p>基本使用</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t5 (num bit(<span class="hljs-number">8</span>));<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t5 (<span class="hljs-number">1</span>,<span class="hljs-number">3</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t5 <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">2</span>,<span class="hljs-number">65</span>);<br></code></pre></td></tr></table></figure>
</li>
<li><p>细节说明</p>
<ul>
<li><code>bit</code> 字段显示时，按照<strong>位</strong>的方式显示</li>
<li>查询的时候仍然可以用使用添加的数值</li>
<li>如果一个值只有 <code>0,1</code> 可以考虑使用 <code>bit(1)</code>，可以节约空间</li>
<li>位类型，<code>M</code> 指定位数，默认值为 <code>1</code>，范围 <code>1~64</code></li>
<li><code>bit</code> 使用不多</li>
</ul>
</li>
<li><p>代码示例</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 演示 bit 类型的使用<br># <span class="hljs-number">1.</span> BIT(M)，M 在 <span class="hljs-number">1</span><span class="hljs-operator">~</span><span class="hljs-number">64</span> 之间<br># <span class="hljs-number">2.</span> 添加数据的范围按照给定的位数来确定，如 M<span class="hljs-operator">=</span><span class="hljs-number">8</span> 表示一个字节 <span class="hljs-number">0</span><span class="hljs-operator">~</span><span class="hljs-number">255</span><br># <span class="hljs-number">3.</span> 显示按照 bit 的方式<br># <span class="hljs-number">4.</span> 查询时，仍然可以按照数值来查询<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t5 (num BIT(<span class="hljs-number">8</span>)); <span class="hljs-comment">-- 大小 1字节，0~255</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t5 <span class="hljs-keyword">VALUE</span> (<span class="hljs-number">1</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t5 <span class="hljs-keyword">VALUE</span> (<span class="hljs-number">3</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t5 <span class="hljs-keyword">VALUE</span> (<span class="hljs-number">255</span>);<br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t5;<br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t5 <span class="hljs-keyword">WHERE</span> num <span class="hljs-operator">=</span> <span class="hljs-number">3</span>;<br></code></pre></td></tr></table></figure></li>
</ol>
<h4 id="数值类型（小数）"><a href="#数值类型（小数）" class="headerlink" title="数值类型（小数）"></a>数值类型（小数）</h4><ol>
<li><p>基本使用</p>
<ol>
<li><code>FLOAT/DOUBLE [UNSIGNED]</code>: <code>Float</code> 单精度，<code>Double</code> 双精度</li>
<li><code>DECIMAL(M,D) [UNSIGNED]</code><ul>
<li>可以支持更加精确的小数位。<code>M</code> 是小数位数（精度）的总数，<code>D</code> 是小数点（标度）后面的位数</li>
<li>如果 <code>D</code> 是 <code>0</code>，则值没有小数点或分数部分。<code>M</code> 最大 <code>65</code>。<code>D</code> 最大 <code>30</code>。如果 <code>D</code> 被省略，默认为 <code>0</code>。如果 <code>M</code> 被省略，默认为 <code>10</code></li>
<li>建议：如果希望小数的<strong>精度高</strong>或者<strong>数值较大</strong>，推荐使用 <code>DECIMAL</code></li>
</ul>
</li>
</ol>
</li>
<li><p>代码示例</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 演示 <span class="hljs-type">decimal</span>、<span class="hljs-type">float</span> <span class="hljs-keyword">double</span> 类型的使用<br><br># 创建表<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t6 (<br>    `num1` <span class="hljs-type">FLOAT</span>,<br>    `num2` <span class="hljs-keyword">DOUBLE</span>,<br>    `num3` <span class="hljs-type">DECIMAL</span>(<span class="hljs-number">30</span>,<span class="hljs-number">20</span>)<br>);<br><br># 添加数据<br># 三个数据分别添加到 num1, num2, num3<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t6 <span class="hljs-keyword">VALUES</span>(<span class="hljs-number">88.12345678912345</span>, <span class="hljs-number">88.12345678912345</span>, <span class="hljs-number">88.12345678912345</span>);<br><br># 查询数据<br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t6;<br><br># <span class="hljs-type">decimal</span> 可以存放很大的数<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t7 (<br>    num <span class="hljs-type">DECIMAL</span>(<span class="hljs-number">65</span>));<br><br># 添加大数值<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t7 <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">80999999999999999999999999999999999999999999999999999997</span>);<br><br># 查询数据<br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t7;<br></code></pre></td></tr></table></figure></li>
</ol>
<h4 id="字符串类型"><a href="#字符串类型" class="headerlink" title="字符串类型"></a>字符串类型</h4><ol>
<li><p>基本介绍</p>
<ol>
<li><code>char(size)</code>: <strong>固定长度</strong>字符串，最大 <code>255</code> <strong>字符</strong></li>
<li><code>varchar(size)</code>: <strong>可变长度</strong>字符串，最大 <code>65532</code> <strong>字节</strong>（<code>1-3</code> 个字节用户记录大小，<code>utf8</code> 编码 <code>3</code> 个字节表示一个字符，最大 <code>21844(65532/3)</code> <strong>字符</strong>，<code>gbk</code> 编码 <code>2</code> 个字节表示一个字符，最大 <code>32766(65532/2)</code> <strong>字符</strong>）</li>
</ol>
</li>
<li><p>代码示例</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs sql">#  演示字符串类型的使用 <span class="hljs-type">char</span> <span class="hljs-type">varchar</span><br><span class="hljs-comment">-- char(size): 固定长度字符串，最大 255 字符</span><br><span class="hljs-comment">-- varchar(size): 可变长度字符串，最大 65532 字节</span><br><span class="hljs-comment">-- 1-3 个字节用户记录大小，</span><br><span class="hljs-comment">-- utf8 编码最大 21844(65532/3) 字符，gbk 编码最大 32766(65532/2) 字符</span><br><br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> `t8`;<br># 创建表 utf8 编码<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `t8` (<br>    <span class="hljs-comment">-- `str1` CHAR(255), -- 最大 255</span><br>    `str2` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">21844</span>) <span class="hljs-comment">-- 最大 21844</span><br>)CHARSET<span class="hljs-operator">=</span>utf8;<br><br># gbk 编码<br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> `t9`;<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `t9` (<br>    `str2` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32766</span>) <span class="hljs-comment">-- 最大 32766</span><br>)CHARSET<span class="hljs-operator">=</span>gbk;<br></code></pre></td></tr></table></figure>
</li>
<li><p>使用细节</p>
<ol>
<li><p>字节与字符</p>
<ol>
<li><code>char(4)</code>，这个<code>4</code> 表示<strong>字符数</strong>（最大 <code>255</code>），不是字节数，不管是中文还是英文都是放 <code>4</code> 个，按字符计算</li>
<li><code>varchar(4)</code>，这个 <code>4</code> 表示<strong>字符数</strong>，不管是中文还是英文都以<strong>指定的编码</strong>来存放数据。占用的字节受编码的影响，<code>utf8=4*3=12 bytes</code>，<code>gbk=4*2=8 bytes</code></li>
</ol>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 演示字符串的使用细节<br># <span class="hljs-type">char</span>(<span class="hljs-number">4</span>) 和 <span class="hljs-type">varchar</span>(<span class="hljs-number">4</span>) 中的 <span class="hljs-number">4</span> 表示字符，不是字节<br><br># 删除表<br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> `t10`;<br># 创建表<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `t10`(<br>    `name` <span class="hljs-type">CHAR</span>(<span class="hljs-number">4</span>),<br>    `price` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">4</span>));<br># 添加英文字符<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `t10` <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;book&#x27;</span>, <span class="hljs-string">&#x27;360&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `t10` <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;keys&#x27;</span>, <span class="hljs-string">&#x27;5400&#x27;</span>);<br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t10;<br><br># 添加中文字符<br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> `t11`;<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `t11` (<br>    `name` <span class="hljs-type">CHAR</span>(<span class="hljs-number">4</span>),<br>    `price` <span class="hljs-type">VARCHAR</span> (<span class="hljs-number">4</span>));<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `t11` <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;电动牙刷&#x27;</span>, <span class="hljs-string">&#x27;三千五百&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `t11` <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;阿莫西林&#x27;</span>, <span class="hljs-string">&#x27;七八九十&#x27;</span>);<br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t11;<br></code></pre></td></tr></table></figure>
</li>
<li><p>定长与变长</p>
<ul>
<li><code>char(4)</code> 是<strong>定长</strong>（固定大小），就是说，即使插入 <code>&#39;aa&#39;</code>，也<strong>会占用</strong>分配的 <code>4</code> 个字符</li>
<li><code>varchar(4)</code> 是<strong>变长</strong>（可变大小），就是说，如果你插入了 <code>&#39;aa&#39;</code>，<strong>实际占用</strong>空间大小并<strong>不是</strong> <code>4</code>个字符，而是按照实际占用空间来分配（<code>varchar</code> 本身还需要占用 <code>1-3</code> 个字节来记录存放内容长度）</li>
</ul>
</li>
<li><p><code>CHAR</code> 与 <code>VARCHAR</code> 的选择</p>
<ol>
<li>如果数据是<strong>定长</strong>，使用 <code>char</code>，比如 <code>md5</code> 的密码，邮编，手机号，身份证号码等</li>
<li>如果一个字段的长度是不确定，使用 <code>varchar</code>，比如留言，文章等</li>
<li>查询速度 <code>char &gt; varchar</code></li>
</ol>
</li>
<li><p><code>TEXT</code> 类型<br> 在存放文本时，也可以使用 <code>TEXT</code> 数据类型。可以将 <code>TEXT</code> 列视为 <code>VARCHAR</code> 列，注意 <code>TEXT</code> 不能有默认值。大小 <code>0~2^16</code> 字节。如果希望存放更多字符，可以选择 <code>MEDIUMTEXT 0-2^24</code> 或者 <code>LONGTEXT 0~232</code></p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 如果 <span class="hljs-type">varchar</span> 不够用，可以考虑使用 mediumtext 或者 longtext，<br># 如果想简单点，也可以直接使用 text<br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> `t12`;<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `t12` (<br>    content TEXT,<br>    content2 MEDIUMTEXT,<br>    content3 LONGTEXT<br>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `t12` <span class="hljs-keyword">VALUES</span> (<br>    <span class="hljs-string">&#x27;名称&#x27;</span>, <span class="hljs-comment">-- 2 * 3 = 6 bytes</span><br>    <span class="hljs-string">&#x27;名称100&#x27;</span>, <span class="hljs-comment">-- 2 * 3 + 3 = 9 bytes</span><br>    <span class="hljs-string">&#x27;名称1000~&#x27;</span> <span class="hljs-comment">-- 2 * 3 + 5 = 11 bytes</span><br>);<br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `t12`;<br></code></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
<h4 id="日期类型"><a href="#日期类型" class="headerlink" title="日期类型"></a>日期类型</h4><ol>
<li><p>基本介绍</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> birthday (<br>    t1 <span class="hljs-type">DATE</span>,<br>    t2 DATETIME,<br>    t3 <span class="hljs-type">TIMESTAMP</span><br>        <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span><br>        <span class="hljs-keyword">ON</span> <span class="hljs-keyword">UPDATE</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span><br>);<br></code></pre></td></tr></table></figure>
</li>
<li><p>代码示例</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 演示时间相关的类型<br># 创建表 <span class="hljs-type">date</span>, datetime, <span class="hljs-type">timestamp</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t13 (<br>    birthday <span class="hljs-type">DATE</span>, <span class="hljs-comment">-- 年月日</span><br>    job_time DATETIME, <span class="hljs-comment">-- 年月日时分秒</span><br>    login_time <span class="hljs-type">TIMESTAMP</span> <span class="hljs-comment">-- 登录时间，如果希望 login_time 列自动更新，需要配置</span><br>        <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span><br>        <span class="hljs-keyword">ON</span> <span class="hljs-keyword">UPDATE</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span><br>);<br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t13;<br># 添加数据，login_time 会自动设置为当前时间<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t13 (<br>    birthday, job_time )<br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;2022-11-11&#x27;</span>, <span class="hljs-string">&#x27;2022-11-11 10:10:10&#x27;</span>);<br># 如果更新 t13 表的某条记录，login_time 列会自动的以当前时间进行更新<br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t13;<br></code></pre></td></tr></table></figure>
</li>
<li><p>使用细节<br> <code>TIMESTAMP</code> 在 <code>INSERT</code> 和 <code>UPDATE</code> 时，自动更新</p>
</li>
</ol>
<h3 id="MySQL-增删改查-CRUD【重要】"><a href="#MySQL-增删改查-CRUD【重要】" class="headerlink" title="MySQL 增删改查 CRUD【重要】"></a>MySQL 增删改查 CRUD【重要】</h3><blockquote>
<p>C: <code>create</code> 创建<br>R: <code>read</code> 读取<br>U: <code>update</code> 修改<br>D: <code>delete</code> 删除</p>
</blockquote>
<h4 id="添加-Insert"><a href="#添加-Insert" class="headerlink" title="添加 Insert"></a>添加 Insert</h4><ol>
<li><p>基本语法</p>
<ul>
<li><p>使用 <code>INSERT</code> 语句向表中插入数据</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `table_name` [(<span class="hljs-keyword">column</span> [, column...])]<br><span class="hljs-keyword">VALUES</span> (<span class="hljs-keyword">value</span> [, value...]);<br></code></pre></td></tr></table></figure>
</li>
<li><p>应用案例 1</p>
<ol>
<li>创建一张商品表 <code>goods (id int, goods_name varchar(10), price double);</code></li>
<li>添加两条记录</li>
</ol>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 练习 <span class="hljs-keyword">insert</span> 语句<br><span class="hljs-comment">-- 创建 goods 表</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `goods` (<br>    `id` <span class="hljs-type">INT</span>,<br>    `goods_name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">10</span>),<br>    `price` <span class="hljs-keyword">DOUBLE</span><br>);<br><br><span class="hljs-comment">-- 添加数据</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `goods` (id, goods_name, price)<br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;牛奶&#x27;</span>, <span class="hljs-number">200</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `goods` (id, goods_name, price)<br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">2</span>, <span class="hljs-string">&#x27;手机&#x27;</span>, <span class="hljs-number">2000</span>);<br><br><span class="hljs-comment">-- 查询表</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `goods`;<br></code></pre></td></tr></table></figure>
</li>
<li><p>应用案例 2</p>
<ul>
<li>使用 <code>insert</code> 语句向表 <code>employee</code> 中插入 <code>2</code> 个员工的信息</li>
</ul>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql"># <span class="hljs-keyword">INSERT</span> 练习 <span class="hljs-number">2</span><br><span class="hljs-comment">-- 添加语句</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `employee` (id, user_name, salary)<br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">200</span>, <span class="hljs-string">&#x27;张三&#x27;</span>, <span class="hljs-number">2000</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `employee` (id, user_name, salary)<br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">300</span>, <span class="hljs-string">&#x27;李四&#x27;</span>, <span class="hljs-number">3000</span>);<br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `employee`;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>注意事项与使用细节</p>
<ol>
<li>插入的数据应与字段的数据类型相同。比如把 <code>&#39;abc&#39;</code> 添加到 <code>int</code> 类型会错误</li>
<li>数据的长度应在列的规定范围内，例如：不能将一个长度为 <code>80</code> 的字符串加入到长度为 <code>40</code> 的列中</li>
<li>在 <code>values</code> 中列出的数据位置必须与被加入的列的排列位置相对应</li>
<li>字符和日期型数据应包含在单引号中</li>
<li>列可以插入空值【前提是该字段允许为空】，<code>insert into table values (null)</code></li>
<li><code>insert into 表名(列名..) values (),(),()</code> 的形式添加多条记录</li>
<li>如果是给表中的所有字段添加数据，可以不写前面的字段名称</li>
<li>默认值的使用，当不给某个字段值时，如果有默认值就会添加，否则报错</li>
<li>如果某个列没有指定 <code>not null</code>，那么默认值为 <code>null</code></li>
</ol>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs sql"># <span class="hljs-keyword">insert</span> 语句的注意事项与使用细节<br><span class="hljs-comment">-- 1.插入的数据应与字段的数据类型相同</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `goods` (id, goods_name, price) <span class="hljs-keyword">VALUES</span><br>        (<span class="hljs-string">&#x27;abc&#x27;</span>, <span class="hljs-string">&#x27;电脑&#x27;</span>, <span class="hljs-number">2000</span>); <span class="hljs-comment">-- 错误</span><br>        (<span class="hljs-string">&#x27;30&#x27;</span>, <span class="hljs-string">&#x27;电脑&#x27;</span>, <span class="hljs-number">2000</span>); <span class="hljs-comment">-- 正确，会自动转换类型</span><br>    <br><span class="hljs-comment">-- 2.数据的长度应在列的规定范围内</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `goods` (id, goods_name, price)<br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">40</span>, <span class="hljs-string">&#x27;平板平板平板平板平板平板平板平板平板平板平板&#x27;</span>, <span class="hljs-number">3000</span>); <span class="hljs-comment">-- 错误，goods_name 长度为 10</span><br><br><span class="hljs-comment">-- 3.在 values 中列出的数据位置必须与被加入的列的排列位置相对应</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `goods` (id, goods_name, price)<br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;平板&#x27;</span>, <span class="hljs-number">40</span>, <span class="hljs-number">1500</span>); <span class="hljs-comment">-- 错误，顺序必须一致</span><br><br><span class="hljs-comment">-- 4.字符和日期型数据应包含在单引号中</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `goods` (id, goods_name, price)<br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">40</span>, 平板, <span class="hljs-number">1500</span>); <span class="hljs-comment">-- 错误，不规范</span><br><br><span class="hljs-comment">-- 5.列可以插入空值【前提是该字段允许为空】</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `goods` (id, goods_name, price)<br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">40</span>, <span class="hljs-string">&#x27;平板&#x27;</span>, <span class="hljs-keyword">NULL</span>);<br><br><span class="hljs-comment">-- 6.insert into 表名(列名..)values (),(),() 的形式添加多条记录</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `goods` (id, goods_name, price)<br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">50</span>, <span class="hljs-string">&#x27;啤酒&#x27;</span>, <span class="hljs-number">200</span>),(<span class="hljs-number">60</span>, <span class="hljs-string">&#x27;矿泉水&#x27;</span>, <span class="hljs-number">10</span>); <span class="hljs-comment">-- 正确</span><br><br><span class="hljs-comment">-- 7.如果是给表中的所有字段添加数据，可以不写前面的字段名称</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `goods` <span class="hljs-comment">/*(id, goods_name, price)*/</span><br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">70</span>, <span class="hljs-string">&#x27;红茶&#x27;</span>, <span class="hljs-number">30</span>);<br><br><span class="hljs-comment">-- 8.默认值的使用，当不给某个字段值时，如果有默认值就会添加，否则报错</span><br>    <span class="hljs-comment">-- 如果某个列没有指定 not null，那么默认值为 null</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `goods` (id, goods_name)<br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">80</span>, <span class="hljs-string">&#x27;耳机&#x27;</span>); <span class="hljs-comment">-- price 没有赋值，会自动添加默认值</span><br><br><span class="hljs-comment">-- 查询表</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `goods`;<br></code></pre></td></tr></table></figure></li>
</ol>
<h4 id="修改-Update"><a href="#修改-Update" class="headerlink" title="修改 Update"></a>修改 Update</h4><ol>
<li><p>基本语法</p>
<ul>
<li><p>使用 update 语句修改表中的数据</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">UPDATE</span> `table_name`<br>    <span class="hljs-keyword">SET</span> `col_name1`<span class="hljs-operator">=</span>`expr1` [, `col_name2`<span class="hljs-operator">=</span>`expr2` ...]<br>    [<span class="hljs-keyword">WHERE</span> where_definition ]<br><span class="hljs-comment">-- 如果没有带 where 条件，默认修改所有记录</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>应用案例</p>
<ol>
<li>在 <code>employee</code> 表中修改表中的数据</li>
<li>将所有员工薪水修改为 <code>5000</code> 元</li>
<li>将姓名为「张三」的员工薪水修改为 <code>3000</code> 元</li>
<li>将「李四」的薪水在原有基础上增加 <code>1000</code> 元</li>
</ol>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 在 employee 表中使用 <span class="hljs-keyword">update</span> 语句修改表中数据<br><br><span class="hljs-comment">-- 将所有员工薪水修改为 5000 元</span><br>    <span class="hljs-comment">-- 如果没有带 where 条件，默认修改所有记录</span><br><span class="hljs-keyword">UPDATE</span> `employee`<br>    <span class="hljs-keyword">SET</span> `salary`<span class="hljs-operator">=</span><span class="hljs-number">5000</span>;<br><br><span class="hljs-comment">-- 将姓名为「张三」的员工薪水修改为 3000 元</span><br><span class="hljs-keyword">UPDATE</span> `employee`<br>    <span class="hljs-keyword">SET</span> `salary`<span class="hljs-operator">=</span><span class="hljs-number">3000</span><br>    <span class="hljs-keyword">WHERE</span> `user_name`<span class="hljs-operator">=</span><span class="hljs-string">&#x27;张三&#x27;</span>;<br><br><span class="hljs-comment">-- 将「李四」的薪水在原有基础上增加 1000 元</span><br>    <span class="hljs-comment">-- 可同时修改多个列的值</span><br><span class="hljs-keyword">UPDATE</span> `employee`<br>    <span class="hljs-keyword">SET</span> `salary`<span class="hljs-operator">=</span>`salary`<span class="hljs-operator">+</span><span class="hljs-number">1000</span>, `job`<span class="hljs-operator">=</span><span class="hljs-string">&#x27;抓小偷&#x27;</span><br>    <span class="hljs-keyword">WHERE</span> `user_name`<span class="hljs-operator">=</span><span class="hljs-string">&#x27;李四&#x27;</span>;<br><br><span class="hljs-comment">-- 查询表数据</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `employee`;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>注意事项与使用细节</p>
<ol>
<li><p><code>UPDATE</code> 语法可以用新值更新原有表行中的各列</p>
</li>
<li><p><code>SET</code> 子句指示要修改哪些列和要给予哪些值</p>
</li>
<li><p><code>WHERE</code> 子句指定应更新哪些行。如没有 <code>WHERE</code> 子句，则更新所有的行（记录），因此一定要<strong>慎用</strong></p>
</li>
<li><p>如果需要修改<strong>多个字段</strong>，可以通过 <code>SET 字段1=值1, 字段2=值2..</code></p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 可同时修改多个列的值</span><br><span class="hljs-keyword">UPDATE</span> `employee`<br>    <span class="hljs-keyword">SET</span> `salary`<span class="hljs-operator">=</span>`salary`<span class="hljs-operator">+</span><span class="hljs-number">1000</span>, `job`<span class="hljs-operator">=</span><span class="hljs-string">&#x27;抓小偷&#x27;</span><br>    <span class="hljs-keyword">WHERE</span> `user_name`<span class="hljs-operator">=</span><span class="hljs-string">&#x27;李四&#x27;</span>; <span class="hljs-comment">-- 如果没有 WHERE 语句，会修改所有的行</span><br></code></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
<h4 id="删除-Delete"><a href="#删除-Delete" class="headerlink" title="删除 Delete"></a>删除 Delete</h4><ol>
<li><p>基本语法</p>
<ul>
<li><p>使用 <code>delete</code> 语句删除表中的数据</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> `table_name`<br>    [<span class="hljs-keyword">WHERE</span> where_definition]<br></code></pre></td></tr></table></figure>
</li>
<li><p>应用案例（使用 <code>employee</code> 测试）</p>
<ul>
<li>删除表中名称为「李四」的记录</li>
<li>删除表中所有记录</li>
</ul>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 测试 <span class="hljs-keyword">delete</span> 语句的使用<br><br><span class="hljs-comment">-- 删除表中名称为「李四」的记录</span><br><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> `employee`<br>    <span class="hljs-keyword">WHERE</span> `user_name`<span class="hljs-operator">=</span><span class="hljs-string">&#x27;李四&#x27;</span>;<br><br><span class="hljs-comment">-- 删除表中所有记录</span><br><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> `employee`;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>注意事项与使用细节</p>
<ol>
<li>如果不使用 <code>WHERE</code> 子句，将删除表中<strong>所有</strong>数据</li>
<li><code>DELETE</code> 语句<strong>不能</strong>删除<strong>某一列</strong>的值（可使用 <code>UPDATE</code> 设为 <code>NULL</code> 或者 <code>&#39;&#39;</code>）</li>
<li>使用 <code>DELETE</code> 语句<strong>仅删除记录</strong>，不删除表本身。如要删除表，使用 <code>DROP TABLE</code> 语句。<code>DROP TABLE 表名;</code></li>
</ol>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- DELETE 语句不能删除某一列的值（可使用 UPDATE 设为 NULL 或者 &#x27;&#x27;）</span><br><span class="hljs-keyword">UPDATE</span> `employee`<br>    <span class="hljs-keyword">SET</span> `job`<span class="hljs-operator">=</span><span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">WHERE</span> `user_name`<span class="hljs-operator">=</span><span class="hljs-string">&#x27;李四&#x27;</span>;<br><br><span class="hljs-comment">-- 使用 DELETE 语句仅删除记录，不删除表本身</span><br>    <span class="hljs-comment">-- 如要删除表，使用 DROP TABLE 语句。DROP TABLE 表名;\</span><br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> `employee`; <span class="hljs-comment">-- 删除 employee 表</span><br></code></pre></td></tr></table></figure></li>
</ol>
<h4 id="查找-SELECT【重要】"><a href="#查找-SELECT【重要】" class="headerlink" title="查找 SELECT【重要】"></a>查找 SELECT【重要】</h4><h5 id="单表"><a href="#单表" class="headerlink" title="单表"></a>单表</h5><ol>
<li><p>基本语法</p>
<ul>
<li><p>使用 <code>select</code> 语句查询表数据</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> [<span class="hljs-keyword">DISTINCT</span>] <span class="hljs-operator">*</span><span class="hljs-operator">|</span>&#123;column1, column2, column3...&#125;<br>    <span class="hljs-keyword">FROM</span> `table_name`;<br></code></pre></td></tr></table></figure>

<ol>
<li><code>SELECT</code> 指定查询哪些列的数据</li>
<li><code>DISTINCT</code> 可选，指显示结果时，是否去掉<strong>重复数据</strong></li>
<li><code>column</code> 指列名</li>
<li><code>*</code> 号代表查询所有列</li>
<li><code>FROM</code> 指定查询的表</li>
</ol>
</li>
<li><p>应用案例（student 表）</p>
<ol>
<li>创建 <code>student</code>表，表中有 <code>7</code> 条数据</li>
<li>查询表中所有学生的信息</li>
<li>查询表中所有学生的姓名和对应的英语成绩</li>
<li>过滤表中重复数据 <code>DISTINCT</code></li>
<li>要查询的记录，每个字段都相同，才会去重</li>
</ol>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs sql"># <span class="hljs-keyword">SELECT</span> 语句的使用<br><br><span class="hljs-comment">-- 创建 student表</span><br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> `student`;<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `student` (<br>    `id` <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">1</span>,<br>    `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>    `chinese` <span class="hljs-type">FLOAT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0.0</span>,<br>    `english` <span class="hljs-type">FLOAT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0.0</span>,<br>    `math` <span class="hljs-type">FLOAT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0.0</span><br>);<br><br><span class="hljs-comment">-- 添加 7 条数据</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `student` (id, NAME, chinese, english, math)<br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;张三&#x27;</span>, <span class="hljs-number">89</span>, <span class="hljs-number">78</span>, <span class="hljs-number">90</span>),<br>        (<span class="hljs-number">2</span>, <span class="hljs-string">&#x27;李四&#x27;</span>, <span class="hljs-number">67</span>, <span class="hljs-number">98</span>, <span class="hljs-number">67</span>),<br>        (<span class="hljs-number">3</span>, <span class="hljs-string">&#x27;王五&#x27;</span>, <span class="hljs-number">88</span>, <span class="hljs-number">95</span>, <span class="hljs-number">85</span>),<br>        (<span class="hljs-number">4</span>, <span class="hljs-string">&#x27;赵云&#x27;</span>, <span class="hljs-number">84</span>, <span class="hljs-number">95</span>, <span class="hljs-number">74</span>),<br>        (<span class="hljs-number">5</span>, <span class="hljs-string">&#x27;张飞&#x27;</span>, <span class="hljs-number">66</span>, <span class="hljs-number">95</span>, <span class="hljs-number">44</span>),<br>        (<span class="hljs-number">6</span>, <span class="hljs-string">&#x27;宋江&#x27;</span>, <span class="hljs-number">87</span>, <span class="hljs-number">84</span>, <span class="hljs-number">85</span>),<br>        (<span class="hljs-number">7</span>, <span class="hljs-string">&#x27;关羽&#x27;</span>, <span class="hljs-number">67</span>, <span class="hljs-number">84</span>, <span class="hljs-number">66</span>);<br><br><span class="hljs-comment">-- 查询表中所有学生的信息</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `student`;<br><br><span class="hljs-comment">-- 查询表中所有学生的姓名和对应的英语成绩</span><br><span class="hljs-keyword">SELECT</span> `name`, `english` <span class="hljs-keyword">FROM</span> `student`;<br><br><span class="hljs-comment">-- 过滤表中重复数据 DISTINCT</span><br>    <span class="hljs-comment">-- 要查询的记录，每个字段都相同，才会去重</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DISTINCT</span> `english` <span class="hljs-keyword">FROM</span> `student`; <span class="hljs-comment">-- 去重查询</span><br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DISTINCT</span> `id`, `name`, `english` <span class="hljs-keyword">FROM</span> `student`; <span class="hljs-comment">-- 不会去重</span><br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>使用表达式</p>
<ul>
<li><p>使用表达式对查询的列进行运算</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span><span class="hljs-operator">|</span>&#123;column1 <span class="hljs-operator">|</span> expression, column2 <span class="hljs-operator">|</span> expression, ...&#125; <span class="hljs-comment">-- expression: 表达式</span><br>    <span class="hljs-keyword">FROM</span> `table_name`;<br></code></pre></td></tr></table></figure>
</li>
<li><p>在 <code>select</code> 语句中使用 <code>as</code> 语句使用别名</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> column_name <span class="hljs-keyword">as</span> 别名 <span class="hljs-keyword">FROM</span> 表名;<br></code></pre></td></tr></table></figure>
</li>
<li><p>应用案例（以 <code>student</code> 表为例）</p>
<ol>
<li>统计每个学生的总分</li>
<li>在所有学生总分加 <code>10</code> 分，统计总分</li>
<li>使用别名表示学生分数</li>
</ol>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sql"># <span class="hljs-keyword">select</span> 语句的使用<br><br><span class="hljs-comment">-- 统计每个学生的总分</span><br><span class="hljs-keyword">SELECT</span> id, `name`, (chinese <span class="hljs-operator">+</span> english <span class="hljs-operator">+</span> math) <span class="hljs-keyword">FROM</span> `student`;<br><br><span class="hljs-comment">-- 在所有学生总分加 10 分，统计总分</span><br><span class="hljs-keyword">SELECT</span> id, `name`, (chinese <span class="hljs-operator">+</span> english <span class="hljs-operator">+</span> math <span class="hljs-operator">+</span> <span class="hljs-number">10</span>) <span class="hljs-keyword">FROM</span> `student`;<br><br><span class="hljs-comment">-- 使用别名表示学生分数</span><br><span class="hljs-keyword">SELECT</span> id <span class="hljs-keyword">AS</span> <span class="hljs-string">&#x27;序号&#x27;</span>, `name` <span class="hljs-keyword">AS</span> <span class="hljs-string">&#x27;姓名&#x27;</span>, <br>    (chinese <span class="hljs-operator">+</span> english <span class="hljs-operator">+</span> math <span class="hljs-operator">+</span> <span class="hljs-number">10</span>) <span class="hljs-keyword">AS</span> <span class="hljs-string">&#x27;总分&#x27;</span> <span class="hljs-keyword">FROM</span> `student`;<br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `student`;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><code>WHERE</code> 子句过滤查询</p>
<ul>
<li><p>在 <code>where</code> 子句中经常使用的运算符</p>
<table>
<thead>
<tr>
<th align="center">类型</th>
<th align="center">语法</th>
<th align="center">介绍</th>
</tr>
</thead>
<tbody><tr>
<td align="center">比较运算符</td>
<td align="center"><code>&gt;, &lt;, &lt;=, &gt;=, =, !=\&lt;&gt;, &lt;=&gt;, &lt;!=&gt;</code></td>
<td align="center">大于、小于、大于(小于)等于、不等于、包含 <code>NULL</code> 的等于（不等于）</td>
</tr>
<tr>
<td align="center">比较运算符</td>
<td align="center"><code>BETWEEN...AND...</code></td>
<td align="center">显示在某一区间的值</td>
</tr>
<tr>
<td align="center">比较运算符</td>
<td align="center"><code>IN(set)</code></td>
<td align="center">显示在 <code>IN</code> 列表中的值，例：<code>IN(100, 200)</code></td>
</tr>
<tr>
<td align="center">比较运算符</td>
<td align="center"><code>LIKE &#39;&#39;</code></td>
<td align="center">模糊查询</td>
</tr>
<tr>
<td align="center">比较运算符</td>
<td align="center"><code>NOT LIKE &#39;&#39;</code></td>
<td align="center">模糊查询</td>
</tr>
<tr>
<td align="center">比较运算符</td>
<td align="center"><code>IS NULL</code></td>
<td align="center">判断是否为空</td>
</tr>
<tr>
<td align="center">逻辑运算符</td>
<td align="center"><code>AND</code></td>
<td align="center">多个条件同时成立</td>
</tr>
<tr>
<td align="center">逻辑运算符</td>
<td align="center"><code>OR</code></td>
<td align="center">多个条件任一成立</td>
</tr>
<tr>
<td align="center">逻辑运算符</td>
<td align="center"><code>NOT</code></td>
<td align="center">不成立，例：<code>WHERE NOT(salary &gt; 100);</code></td>
</tr>
</tbody></table>
</li>
<li><p>应用案例（以 <code>student</code> 表为例）</p>
<ol>
<li>查询姓名为「赵云」的学生成绩</li>
<li>查询「英语成绩」大于 <code>90</code> 分的同学</li>
<li>查询总分大于 <code>200</code> 分的同学</li>
<li>查询 <code>math</code> 大于 <code>60</code> 并且 <code>english</code> 大于 <code>90</code> 的学生成绩</li>
<li>查询「英语成绩」大于「语文成绩」的同学</li>
<li>查询总分大于 <code>200</code> 分并且「数学成绩」小于「语文成绩」的「张姓」学生</li>
<li>查询「英语」分数在 <code>80 ~ 90</code> 之间的同学</li>
<li>查询「数学」分数为 <code>89, 90, 91</code> 的同学</li>
<li>查询所有「姓李」的学生成绩</li>
<li>查询 <code>数学 &gt; 80</code>，<code>语文 &gt; 80</code> 的同学</li>
<li>查询「语文」分数在 <code>80 ~ 90</code> 之间的同学</li>
<li>查询「总分」为 <code>257, 205, 217</code> 的同学</li>
<li>查询所有「姓李」或者「姓宋」的学生成绩</li>
<li>查询「语文」比「数学」多 <code>10</code> 分以上的同学</li>
</ol>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs sql"># <span class="hljs-keyword">SELECT</span> 语句的使用 <span class="hljs-operator">-</span> <span class="hljs-keyword">WHERE</span> 子句<br><br><span class="hljs-comment">-- 1.查询姓名为「赵云」的学生成绩</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `student`<br>    <span class="hljs-keyword">WHERE</span> `name` <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;赵云&#x27;</span>;<br><br><span class="hljs-comment">-- 2.查询「英语成绩」大于 90 分的同学</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `student`<br>    <span class="hljs-keyword">WHERE</span> english <span class="hljs-operator">&gt;</span> <span class="hljs-number">90</span>;<br><br><span class="hljs-comment">-- 3.查询总分大于 200 分的同学</span><br><span class="hljs-keyword">SELECT</span> id, `name`, (chinese <span class="hljs-operator">+</span> english <span class="hljs-operator">+</span> math) <span class="hljs-keyword">AS</span> <span class="hljs-string">&#x27;总分&#x27;</span> <span class="hljs-keyword">FROM</span> `student`<br>    <span class="hljs-keyword">WHERE</span> (chinese <span class="hljs-operator">+</span> english <span class="hljs-operator">+</span> math) <span class="hljs-operator">&gt;</span> <span class="hljs-number">200</span>;<br><br><span class="hljs-comment">-- 4.查询 math 大于 60 并且 english 大于 90 的学生成绩</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `student`<br>    <span class="hljs-keyword">WHERE</span> math <span class="hljs-operator">&gt;</span> <span class="hljs-number">60</span> <span class="hljs-keyword">AND</span> english <span class="hljs-operator">&gt;</span> <span class="hljs-number">90</span>;<br><br><span class="hljs-comment">-- 5.查询「英语成绩」大于「语文成绩」的同学</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `student`<br>    <span class="hljs-keyword">WHERE</span> english <span class="hljs-operator">&gt;</span> chinese;<br><br><span class="hljs-comment">-- 6.查询总分大于 200 分并且「数学成绩」小于「语文成绩」的「张姓」学生</span><br>    <span class="hljs-comment">-- 「`name` LIKE 张%」表示名字以「张」字开头的</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `student`<br>    <span class="hljs-keyword">WHERE</span> (chinese <span class="hljs-operator">+</span> english <span class="hljs-operator">+</span> math) <span class="hljs-operator">&gt;</span> <span class="hljs-number">200</span> <span class="hljs-keyword">AND</span> math <span class="hljs-operator">&lt;</span> chinese <span class="hljs-keyword">AND</span> `name` <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;张%&#x27;</span>;<br>    <br><span class="hljs-comment">-- 7.查询「英语」分数在 80 ~ 90 之间的同学</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `student`<br>    <span class="hljs-keyword">WHERE</span> english <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">80</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">90</span>;<br><br><span class="hljs-comment">-- 8.查询「数学」分数为 89, 90, 91 的同学</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `student`<br>    <span class="hljs-keyword">WHERE</span> math <span class="hljs-keyword">IN</span> (<span class="hljs-number">89</span>, <span class="hljs-number">90</span>, <span class="hljs-number">91</span>);<br><br><span class="hljs-comment">-- 9.查询所有「姓李」的学生成绩</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `student`<br>    <span class="hljs-keyword">WHERE</span> `name` <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;李%&#x27;</span>;<br><br><span class="hljs-comment">-- 10.查询 数学 &gt; 80，语文 &gt; 80 的同学</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `student`<br>    <span class="hljs-keyword">WHERE</span> math <span class="hljs-operator">&gt;</span> <span class="hljs-number">80</span> <span class="hljs-keyword">AND</span> chinese <span class="hljs-operator">&gt;</span> <span class="hljs-number">80</span>;<br><br><span class="hljs-comment">-- 11.查询「语文」分数在 80 ~ 90 之间的同学</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `student`<br>    <span class="hljs-keyword">WHERE</span> chinese <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">80</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">90</span>;<br><br><span class="hljs-comment">-- 12.查询「总分」为 257, 205, 217 的同学</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `student`<br>    <span class="hljs-keyword">WHERE</span> (chinese <span class="hljs-operator">+</span> english <span class="hljs-operator">+</span> math) <span class="hljs-keyword">IN</span> (<span class="hljs-number">257</span>, <span class="hljs-number">205</span>, <span class="hljs-number">217</span>);<br><br><span class="hljs-comment">-- 13.查询所有「姓李」或者「姓宋」的学生成绩</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `student`<br>    <span class="hljs-keyword">WHERE</span> `name` <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;李%&#x27;</span> <span class="hljs-keyword">OR</span> `name` <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;宋%&#x27;</span>;<br><br><span class="hljs-comment">-- 14.查询「语文」比「数学」多 10 分以上的同学</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `student`<br>    <span class="hljs-keyword">WHERE</span> chinese <span class="hljs-operator">&gt;=</span> math <span class="hljs-operator">+</span> <span class="hljs-number">10</span>;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><code>ORDER BY</code> 子句排序查询</p>
<ul>
<li><p>使用 <code>order by</code> 子句排序查询结果</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> column1, column2, column3, ...<br>    <span class="hljs-keyword">FROM</span> table_name;<br>    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">column</span> <span class="hljs-keyword">asc</span><span class="hljs-operator">|</span><span class="hljs-keyword">desc</span>, ...<br></code></pre></td></tr></table></figure>

<ol>
<li><code>ORDER BY</code> 指定排序的列，排序的列既可以是表中的列名，也可以是 <code>SELECT</code> 语句后指定的列名</li>
<li><code>ASC</code> 升序、<code>DESC</code> 降序，如果没有，默认为升序</li>
<li><code>ORDER BY</code> 子句应位于 <code>SELECT</code> 语句的结尾</li>
</ol>
</li>
<li><p>应用案例（以 <code>student</code> 表为例）</p>
<ol>
<li>对「数学成绩」排序后输出（升序）</li>
<li>对「总分」按从高到低的顺序输出</li>
<li>对「姓张」的学生成绩排序输出（升序）</li>
</ol>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sql"># <span class="hljs-keyword">SELECT</span> 语句 <span class="hljs-operator">-</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> 子句<br><br><span class="hljs-comment">-- 对数学成绩排序后输出（升序）</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> `student`<br>    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> math <span class="hljs-comment">/*ASC*/</span>; <span class="hljs-comment">-- 默认为 ASC，所以可以省略</span><br><br><span class="hljs-comment">-- 对总分按从高到低的顺序输出</span><br><span class="hljs-keyword">SELECT</span> id, `name`, (chinese <span class="hljs-operator">+</span> english <span class="hljs-operator">+</span> math) <span class="hljs-keyword">AS</span> <span class="hljs-string">&#x27;总分&#x27;</span> <span class="hljs-keyword">FROM</span> `student`<br>    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> (chinese <span class="hljs-operator">+</span> english <span class="hljs-operator">+</span> math) <span class="hljs-keyword">DESC</span>;<br><br><span class="hljs-comment">-- 对姓张的学生成绩排序输出（升序）</span><br><span class="hljs-keyword">SELECT</span> id, `name`, (chinese <span class="hljs-operator">+</span> english <span class="hljs-operator">+</span> math) <span class="hljs-keyword">AS</span> total_score<br>    <span class="hljs-keyword">FROM</span> `student`<br>    <span class="hljs-keyword">WHERE</span> `name` <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;张%&#x27;</span><br>    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> total_score <span class="hljs-comment">/*ASC*/</span>;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<h5 id="加强查询"><a href="#加强查询" class="headerlink" title="加强查询"></a>加强查询</h5><ol>
<li><p>使用 <code>WHERE</code> 子句</p>
<ul>
<li><p>在 <code>mysql</code> 中，日期类型可以直接比较</p>
</li>
<li><p>查找 <code>1992.1.1</code> 后入职的员工</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 在 mysql 中，日期类型可以直接比较</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> hire_date <span class="hljs-operator">&gt;</span> <span class="hljs-string">&#x27;1992-1-1&#x27;</span>;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>使用 <code>LIKE</code> 操作符（模糊查询）</p>
<ul>
<li><p><code>%</code>: 表示 0 到多个任意字符</p>
</li>
<li><p><code>_</code>: 表示单个任意字符</p>
</li>
<li><p>显示首字符为 S 的员工姓名和工资</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> d_name, sal <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> d_name <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;S%&#x27;</span>;<br></code></pre></td></tr></table></figure>
</li>
<li><p>显示第三个字符为大写 O 的所有员工的姓名和工资</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> d_name <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;__O%&#x27;</span>;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>判断为空不能用 <code>=NULL</code>，而是用 <code>IS NULL</code></p>
<ul>
<li><p>显示没有上级雇员的情况</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> mgr <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NULL</span>;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>查询表结构</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DESC</span> emp;<br></code></pre></td></tr></table></figure>
</li>
<li><p>使用 <code>ORDER BY</code> 子句</p>
<ul>
<li><p>按照工资从低到高顺序，显示雇员的信息</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- ASC 升序（默认）；DESC 降序</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> sal <span class="hljs-comment">/*ASC*/</span>;<br></code></pre></td></tr></table></figure>
</li>
<li><p>按照部门号升序而雇员的工资降序排列，显示雇员信息</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> dept_no, sal <span class="hljs-keyword">DESC</span>;<br></code></pre></td></tr></table></figure>
</li>
<li><p>显示所有员工的姓名、工作和薪金按工作降序排序，若工作相同则按薪金排序</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> e_name, job, sal<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> job <span class="hljs-keyword">DESC</span>, sal;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>分页查询</p>
<ul>
<li><p>基本语法：<code>SELECT ... LIMIT start, rows</code>，表示从 <code>start + 1</code> 行开始取，取出 <code>rows</code> 行，<code>start</code> 从 <code>0</code> 开始计算</p>
</li>
<li><p>计算公式：<code>LIMIT (每页行数 * (页数-1)), 每页行数</code></p>
</li>
<li><p>按照雇员的 <code>emp_no</code> 号升序取出，每页显示 <code>3</code> 条记录，分别显示第 1 页，第 2 页，第 3 页</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> emp_no<br>    LIMIT <span class="hljs-number">0</span>, <span class="hljs-number">3</span>;<br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> emp_no<br>    LIMIT <span class="hljs-number">3</span>, <span class="hljs-number">3</span>;<br>    <br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> emp_no<br>    LIMIT <span class="hljs-number">6</span>, <span class="hljs-number">3</span>;<br></code></pre></td></tr></table></figure>
</li>
<li><p>按照雇员的 <code>emp_no</code> 号降序取出，每页显示 <code>5</code> 条记录，分别显示第 3 页，第 5 页</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> emp_no <span class="hljs-keyword">DESC</span><br>    LIMIT <span class="hljs-number">10</span>, <span class="hljs-number">5</span>;<br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> emp_no <span class="hljs-keyword">DESC</span><br>    LIMIT <span class="hljs-number">20</span>, <span class="hljs-number">5</span>;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>使用分组函数和分组子句 <code>GROUP BY</code></p>
<ul>
<li><p>显示每种岗位的雇员总数、平均工资</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> job, <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>), <span class="hljs-built_in">AVG</span>(sal)<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> job;<br></code></pre></td></tr></table></figure>
</li>
<li><p>显示雇员总数，以及获得奖金的雇员数</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>), <span class="hljs-built_in">COUNT</span>(comm)<br>    <span class="hljs-keyword">FROM</span> emp;<br></code></pre></td></tr></table></figure>
</li>
<li><p>显示雇员总数，以及没有获得奖金的雇员数</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>), <span class="hljs-built_in">COUNT</span>(IF(comm <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NULL</span>, <span class="hljs-number">1</span>, <span class="hljs-keyword">NULL</span>))<br>    <span class="hljs-keyword">FROM</span> emp;<br><span class="hljs-comment">/* 下面的写法效果相同*/</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>), <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-operator">-</span> <span class="hljs-built_in">COUNT</span>(comm)<br>    <span class="hljs-keyword">FROM</span> emp;<br></code></pre></td></tr></table></figure>
</li>
<li><p>显示管理者（有下属）的总人数</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- DISTINCT 去重</span><br><span class="hljs-keyword">SELECT</span> mgr, <span class="hljs-built_in">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> mgr)<br>    <span class="hljs-keyword">FROM</span> emp;<br></code></pre></td></tr></table></figure>
</li>
<li><p>显示雇员工资的最大差额</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MAX</span>(sal) <span class="hljs-operator">-</span> <span class="hljs-built_in">MIN</span>(sal)<br>    <span class="hljs-keyword">FROM</span> emp;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>数据分组的总结</p>
<ul>
<li><p>如果 <code>SELECT</code> 语句同时包含有 <code>GROUP BY, HAVING, LIMIT, ORDER BY</code> 那么它们的顺序是：<code>GROUP BY, HAVING, ORDERBY, LIMIT</code></p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> column1, column2, column3... <span class="hljs-keyword">FROM</span> table_name<br>    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> column4<br>    <span class="hljs-keyword">HAVING</span> <span class="hljs-keyword">condition</span><br>    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> column5<br>    LIMIT start_num, rows_num;<br></code></pre></td></tr></table></figure>
</li>
<li><p>统计平均工资大于 <code>1000</code> 的部门，按照平均工资从高到低排序，并取出前两行记录</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> dept_no, <span class="hljs-built_in">AVG</span>(sal) <span class="hljs-keyword">AS</span> avg_sal <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> dept_no<br>    <span class="hljs-keyword">HAVING</span> avg_sal <span class="hljs-operator">&gt;</span> <span class="hljs-number">1000</span><br>    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> avg_sal <span class="hljs-keyword">DESC</span><br>    LIMIT <span class="hljs-number">0</span>, <span class="hljs-number">2</span>;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<h5 id="多表查询【重要】"><a href="#多表查询【重要】" class="headerlink" title="多表查询【重要】"></a>多表查询【重要】</h5><ol>
<li><p>介绍<br> 多表查询是指基于两个或两个以上的表查询，在实际的软件开发中，单表查询远远不能满足查询需求，下面将使用 <code>emp, dept, sal_grade</code> 这三张表演示如何进行多表查询</p>
</li>
<li><p>多表查询规则</p>
<ol>
<li>从<strong>第一张表</strong>中取出一行，和<strong>第二张表</strong>的<strong>每一条</strong>记录进行组合，返回结果（含有两张表的所有列）</li>
<li><code>一共返回的记录数 = 第一张表的行数 * 第二张表的行数</code></li>
<li>这样的多表查询默认处理返回的结果，称为<strong>笛卡尔集</strong></li>
<li>解决多表查询的关键就是要写出正确的过滤条件 <code>WHERE</code></li>
<li>多表查询的条件不能少于 <code>表的个数-1</code>，否则会出现<strong>笛卡尔集</strong></li>
</ol>
</li>
<li><p>自连接</p>
<ul>
<li><p>自连接是指在同一张表的连接查询（将同一张表看作两张表）</p>
</li>
<li><p>自连接的特点：</p>
<ol>
<li>把同一张表当做两张表使用</li>
<li>需要给表取别名，<code>表名 表别名</code></li>
<li>列名不明确，可以指定列的别名，<code>列名 AS 列别名</code></li>
</ol>
</li>
<li><p>显示员工名字和他的上级名字</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 分析：1. 员工名字和上级名字都在 emp 表</span><br>    <span class="hljs-comment">-- 2. 员工和上级是通过 emp 表的 mgr 列关联</span><br><br><span class="hljs-keyword">SELECT</span> worker.e_name <span class="hljs-keyword">AS</span> <span class="hljs-string">&#x27;职员名&#x27;</span>, boss.e_name <span class="hljs-keyword">AS</span> <span class="hljs-string">&#x27;上级名&#x27;</span><br>    <span class="hljs-keyword">FROM</span> emp worker, emp boss<br>    <span class="hljs-keyword">WHERE</span> worker.mgr <span class="hljs-operator">=</span> boss.emp_no;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>应用案例</p>
<ul>
<li><p>显示雇员名，雇员工资及所在部门的名称</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">/*</span><br><span class="hljs-comment">    分析：</span><br><span class="hljs-comment">    1. 雇员名，雇员工资 来自 emp 表</span><br><span class="hljs-comment">    2. 所在部门名称 来自 dept 表</span><br><span class="hljs-comment">    3. 需要对两张表进行查询</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">SELECT</span> e_name, sal, d_name<br>    <span class="hljs-keyword">FROM</span> emp, dept<br>    <span class="hljs-keyword">WHERE</span> emp.dept_no <span class="hljs-operator">=</span> dept.dept_no;<br></code></pre></td></tr></table></figure>
</li>
<li><p>显示部门号为 <code>10</code> 的部门名、员工名和工资</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> d_name, e_name, sal<br>    <span class="hljs-keyword">FROM</span> emp, dept<br>    <span class="hljs-keyword">WHERE</span> emp.dept_no <span class="hljs-operator">=</span> dept.dept_no <span class="hljs-keyword">AND</span> emp.dept_no <span class="hljs-operator">=</span> <span class="hljs-number">10</span>;<br></code></pre></td></tr></table></figure>
</li>
<li><p>显示各个员工的姓名，工资，及其工资的级别</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">/*</span><br><span class="hljs-comment">    分析：</span><br><span class="hljs-comment">    1. 需要对 emp, sal_grade 两张表进行查询</span><br><span class="hljs-comment">    2. emp 中的每一行依次与 sal_grade 的每一行进行组合</span><br><span class="hljs-comment">    3. 只有 sal 在 lo_sal 和 hi_sal 之间的才是符合要求的</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">SELECT</span> e_name, sal, grade<br>    <span class="hljs-keyword">FROM</span> emp, sal_grade<br>    <span class="hljs-keyword">WHERE</span> sal <span class="hljs-keyword">BETWEEN</span> lo_sal <span class="hljs-keyword">AND</span> hi_sal;<br></code></pre></td></tr></table></figure>
</li>
<li><p>显示雇员名，雇员工资以及所在部门的名字，并按照部门降序排序</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> e_name, sal, d_name, dept.dept_no<br>    <span class="hljs-keyword">FROM</span> emp, dept<br>    <span class="hljs-keyword">WHERE</span> emp.dept_no <span class="hljs-operator">=</span> dept.dept_no<br>    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> dept.dept_no <span class="hljs-keyword">DESC</span>;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<h5 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h5><p>子查询是指嵌入在其他 <code>sql</code> 语句中的 <code>SELECT</code> 语句，也叫<strong>嵌套查询</strong></p>
<ol>
<li><p>单行子查询</p>
<ul>
<li><p>单行子查询是指只返回一行数据的子查询语句</p>
</li>
<li><p>思考：如何显示与 <code>SMITH</code> 同一部门的所有员工</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">/* </span><br><span class="hljs-comment">    1. 先查询 SMITH 部门号</span><br><span class="hljs-comment">    2. 把上面的 SELECT 语句当做一个子查询来使用</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> dept_no <span class="hljs-operator">=</span> (<br>        <span class="hljs-keyword">SELECT</span> dept_no <span class="hljs-keyword">FROM</span> emp<br>        <span class="hljs-keyword">WHERE</span> e_name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;SMITH&#x27;</span><br>    );<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>多行子查询</p>
<ul>
<li><p>多行子查询指返回多行数据的子查询，使用关键字 <code>IN</code></p>
</li>
<li><p>思考：如何查询和部门 <code>10</code> 工作相同的雇员的名字、岗位、工资、部门号，但不包含 <code>10</code> 自己</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 1. 查询部门 10 的工作</span><br><span class="hljs-keyword">SELECT</span> job <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> dept_no <span class="hljs-operator">=</span> <span class="hljs-number">10</span>;<br>    <br><span class="hljs-comment">-- 2. 查询这些工作的雇员相关信息</span><br><span class="hljs-keyword">SELECT</span> e_name, job, sal, dept_no<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> job <span class="hljs-keyword">IN</span> (<br>        <span class="hljs-keyword">SELECT</span> job <span class="hljs-keyword">FROM</span> emp<br>        <span class="hljs-keyword">WHERE</span> dept_no <span class="hljs-operator">=</span> <span class="hljs-number">10</span><br>    );<br><br><span class="hljs-comment">-- 3. 排除部门 10 的员工</span><br><span class="hljs-keyword">SELECT</span> e_name, job, sal, dept_no<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> job <span class="hljs-keyword">IN</span> ( <span class="hljs-comment">-- IN 关键字</span><br>        <span class="hljs-keyword">SELECT</span> job <span class="hljs-keyword">FROM</span> emp<br>        <span class="hljs-keyword">WHERE</span> dept_no <span class="hljs-operator">=</span> <span class="hljs-number">10</span><br>    ) <span class="hljs-keyword">AND</span> dept_no <span class="hljs-operator">&lt;&gt;</span> <span class="hljs-number">10</span>; <span class="hljs-comment">/* != */</span><br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>子查询当做临时表</p>
<ul>
<li><p>把子查询当做一个临时表，可以解决很多复杂的查询</p>
</li>
<li><p>思考：如何查询 <code>emp</code> 各个岗位中，工资最高的员工</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 先得到各个岗位中，工资最高的岗位</span><br><span class="hljs-keyword">SELECT</span> job, <span class="hljs-built_in">MAX</span>(sal)<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> job;<br><br><span class="hljs-comment">-- 把上面的表当做临时表</span><br><span class="hljs-keyword">SELECT</span> e_name, emp.job, sal<br>    <span class="hljs-keyword">FROM</span> (<br>        <span class="hljs-keyword">SELECT</span> job, <span class="hljs-built_in">MAX</span>(sal) <span class="hljs-keyword">AS</span> max_sal<br>        <span class="hljs-keyword">FROM</span> emp<br>        <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> job<br>    ) temp, emp<br>    <span class="hljs-keyword">WHERE</span> temp.job <span class="hljs-operator">=</span> emp.job <br>    <span class="hljs-keyword">AND</span> sal <span class="hljs-operator">=</span> max_sal;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><code>ALL</code> 与 <code>ANY</code> 操作符</p>
<ul>
<li><p>在多行子查询中使用 <code>ALL</code> 操作符</p>
</li>
<li><p>思考：如何显示工资高于 <code>30</code> 部门所有员工的员工姓名、工资和部门号</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> e_name, sal, dept_no<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> sal <span class="hljs-operator">&gt;</span> <span class="hljs-keyword">ALL</span> (<br>        <span class="hljs-keyword">SELECT</span> sal <br>            <span class="hljs-keyword">FROM</span> emp <br>            <span class="hljs-keyword">WHERE</span> dept_no <span class="hljs-operator">=</span> <span class="hljs-number">30</span><br>        );<br><span class="hljs-comment">-- 方法 2</span><br><span class="hljs-keyword">SELECT</span> e_name, sal, dept_no<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> sal <span class="hljs-operator">&gt;</span> (<br>        <span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MAX</span>(sal)<br>            <span class="hljs-keyword">FROM</span> emp<br>            <span class="hljs-keyword">WHERE</span> dept_no <span class="hljs-operator">=</span> <span class="hljs-number">30</span><br>        );<br></code></pre></td></tr></table></figure>
</li>
<li><p>在多行子查询中使用 <code>ANY</code> 操作符</p>
</li>
<li><p>思考：如何显示工资高于 <code>30</code> 号部门中任意一个员工的员工姓名、工资和部门号</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> e_name, sal, dept_no<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> sal <span class="hljs-operator">&gt;</span> <span class="hljs-keyword">ANY</span> (<br>        <span class="hljs-keyword">SELECT</span> sal<br>            <span class="hljs-keyword">FROM</span> emp<br>            <span class="hljs-keyword">WHERE</span> dept_no <span class="hljs-operator">=</span> <span class="hljs-number">30</span><br>        );<br><span class="hljs-comment">-- 方法 2</span><br><span class="hljs-keyword">SELECT</span> e_name, sal, dept_no<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> sal <span class="hljs-operator">&gt;</span> (<br>        <span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MIN</span>(sal)<br>            <span class="hljs-keyword">FROM</span> emp<br>            <span class="hljs-keyword">WHERE</span> dept_no <span class="hljs-operator">=</span> <span class="hljs-number">30</span><br>        );<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>多列子查询</p>
<ul>
<li><p>多列子查询是指查询返回多个列数据的子查询语句</p>
</li>
<li><p><code>(字段1, 字段2 ...) = (SELECT 字段1, 字段2 FROM ...)</code></p>
</li>
<li><p>思考：如何查询与 <code>ALLEN</code> 的部门和岗位完全相同的所有员工（不含 <code>ALLEN</code> 本人）</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 1. 得到 ALLEN 的部门和岗位</span><br><span class="hljs-keyword">SELECT</span> dept_no, job <br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> e_name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;ALLEN&#x27;</span>;<br><br><span class="hljs-comment">-- 2. 查询这些部门和岗位的员工</span><br>    <span class="hljs-comment">-- 多列子查询</span><br><span class="hljs-keyword">SELECT</span> e_name, sal, dept_no, job<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> (dept_no, job) <span class="hljs-operator">=</span> (<br>        <span class="hljs-keyword">SELECT</span> dept_no, job<br>            <span class="hljs-keyword">FROM</span> emp<br>            <span class="hljs-keyword">WHERE</span> e_name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;ALLEN&#x27;</span><br>        ) <span class="hljs-keyword">AND</span> e_name <span class="hljs-operator">&lt;&gt;</span> <span class="hljs-string">&#x27;ALLEN&#x27;</span>;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>子查询练习</p>
<ol>
<li><p>查询每个部门工资高于本部门平均工资的人</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 1. 查询每个部门的部门号和 平均工资</span><br><span class="hljs-keyword">SELECT</span> dept_no, <span class="hljs-built_in">AVG</span>(sal)<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> dept_no;<br><br><span class="hljs-comment">-- 2. 把上面的表当做子查询，和 emp 表进行多表查询</span><br><span class="hljs-keyword">SELECT</span> e_name, sal, emp.dept_no, avg_sal<br>    <span class="hljs-keyword">FROM</span> emp, (<br>        <span class="hljs-keyword">SELECT</span> dept_no, <span class="hljs-built_in">AVG</span>(sal) <span class="hljs-keyword">AS</span> avg_sal<br>            <span class="hljs-keyword">FROM</span> emp<br>            <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> dept_no<br>        ) temp<br>    <span class="hljs-keyword">WHERE</span> emp.dept_no <span class="hljs-operator">=</span> temp.dept_no<br>    <span class="hljs-keyword">AND</span> sal <span class="hljs-operator">&gt;</span> avg_sal;<br></code></pre></td></tr></table></figure>
</li>
<li><p>查找每个部门工资最高的人</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> e_name, job, sal, emp.dept_no<br>    <span class="hljs-keyword">FROM</span> emp, (<br>        <span class="hljs-keyword">SELECT</span> dept_no, <span class="hljs-built_in">MAX</span>(sal) <span class="hljs-keyword">AS</span> max_sal<br>            <span class="hljs-keyword">FROM</span> emp<br>            <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> dept_no<br>        ) temp<br>    <span class="hljs-keyword">WHERE</span> emp.dept_no <span class="hljs-operator">=</span> temp.dept_no<br>    <span class="hljs-keyword">AND</span> sal <span class="hljs-operator">=</span> max_sal;<br></code></pre></td></tr></table></figure>
</li>
<li><p>查询每个部门的信息（部门名、编号、地址）和人员数量</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 先查询每个部门的编号和人数</span><br><span class="hljs-keyword">SELECT</span> dept_no, <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">AS</span> num<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> dept_no<br><br><span class="hljs-comment">-- 把上面表作为子查询</span><br><span class="hljs-keyword">SELECT</span> d_name, dept.dept_no, loc, num<br>    <span class="hljs-keyword">FROM</span> dept, (<br>        <span class="hljs-keyword">SELECT</span> dept_no, <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">AS</span> num<br>            <span class="hljs-keyword">FROM</span> emp<br>            <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> dept_no<br>        ) temp<br>    <span class="hljs-keyword">WHERE</span> dept.dept_no <span class="hljs-operator">=</span> temp.dept_no;<br><br><span class="hljs-comment">-- 第二种写法，表.* 表示将该表所有列都显示出来</span><br><span class="hljs-keyword">SELECT</span> d_name, loc, temp.<span class="hljs-operator">*</span><br>    <span class="hljs-keyword">FROM</span> dept, (<br>        <span class="hljs-keyword">SELECT</span> dept_no, <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">AS</span> num<br>            <span class="hljs-keyword">FROM</span> emp<br>            <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> dept_no<br>        ) temp<br>    <span class="hljs-keyword">WHERE</span> dept.dept_no <span class="hljs-operator">=</span> temp.dept_no;<br></code></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
<h5 id="自我复制数据（表复制-x2F-蠕虫复制）"><a href="#自我复制数据（表复制-x2F-蠕虫复制）" class="headerlink" title="自我复制数据（表复制&#x2F;蠕虫复制）"></a>自我复制数据（表复制&#x2F;蠕虫复制）</h5><p>有时，为了对某个 <code>sql</code> 语句进行效率测试，可以使用此法为表创建海量数据</p>
<ul>
<li><p>演示如何进行表复制</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 演示表的复制<br><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> my_tab01 (<br>    id <span class="hljs-type">INT</span>,<br>    `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>),<br>    sal <span class="hljs-keyword">DOUBLE</span>,<br>    job <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>),<br>    dept_no <span class="hljs-type">INT</span><br>);<br><br><span class="hljs-keyword">DESC</span> my_tab01;<br><br><span class="hljs-comment">-- 演示如何自我复制</span><br><span class="hljs-comment">-- 1. 先把 emp 表的记录复制到 my_tab01</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> my_tab01 (<br>    id, `name`, sal, job, dept_no)<br>    <span class="hljs-keyword">SELECT</span> emp_no, e_name, sal, job, dept_no<br>        <span class="hljs-keyword">FROM</span> emp;<br><br><span class="hljs-comment">-- 2. 自我复制</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> my_tab01<br>    <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> my_tab01;<br></code></pre></td></tr></table></figure>
</li>
<li><p>如何删除一张表的重复记录（面试题）</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 如何删除一张表的重复记录<br><span class="hljs-comment">-- 1. 先创建一张表 my_tab02</span><br><span class="hljs-comment">-- 2. 让 my_tab02 表有重复记录</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> my_tab02 <br>    <span class="hljs-keyword">LIKE</span> emp; <span class="hljs-comment">-- 把 emp 表的结构（列）复制到 my_tab02</span><br>    <br><span class="hljs-keyword">DESC</span> my_tab02; <span class="hljs-comment">-- 结构与 emp 相同</span><br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> my_tab02<br>    <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> emp; <span class="hljs-comment">-- 复制 emp 所有内容到 my_tab02</span><br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> my_tab02;<br><br><span class="hljs-comment">-- 3. 考虑去重</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">    1. 先创建一张临时表 my_tmp，该表的结构与 my_tab02 相同</span><br><span class="hljs-comment">    2. 把 my_tmp 记录，通过 distinct 关键字处理后，把记录复制到 my_tmp</span><br><span class="hljs-comment">    3. 清除 my_tab02 的所有记录</span><br><span class="hljs-comment">    4. 把 my_tmp 表的记录复制到 my_tab02</span><br><span class="hljs-comment">    5. drop 掉临时表 my_tmp</span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> my_tmp <span class="hljs-keyword">LIKE</span> my_tab02;<br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> my_tmp<br>    <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DISTINCT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> my_tab02;<br><br><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> my_tab02;<br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> my_tab02<br>    <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> my_tmp;<br><br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> my_tmp;<br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> my_tab02;<br></code></pre></td></tr></table></figure></li>
</ul>
<h5 id="合并查询"><a href="#合并查询" class="headerlink" title="合并查询"></a>合并查询</h5><p>有时在实际应用中，为了合并多个 <code>SELECT</code> 语句的结果，可以使用集合操作符号 <code>union, union all</code></p>
<ol>
<li><p>union all</p>
<ul>
<li><p>该操作符用于取得两个结果集的并集。当使用该操作符时，不会取消重复行</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> e_name, sal, job<br>    <span class="hljs-keyword">FROM</span> emp <br>    <span class="hljs-keyword">WHERE</span> sal <span class="hljs-operator">&gt;</span> <span class="hljs-number">2500</span><br><span class="hljs-keyword">UNION</span> <span class="hljs-keyword">ALL</span><br><span class="hljs-keyword">SELECT</span> e_name, sal, job <br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> job <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;MANAGER&#x27;</span>;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>union</p>
<ul>
<li><p>该操作符与 <code>union all</code> 相似，但是会自动去掉结果中的重复行</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> e_name, sal, job<br>    <span class="hljs-keyword">FROM</span> emp <br>    <span class="hljs-keyword">WHERE</span> sal <span class="hljs-operator">&gt;</span> <span class="hljs-number">2500</span><br><span class="hljs-keyword">UNION</span><br><span class="hljs-keyword">SELECT</span> e_name, sal, job <br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> job <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;MANAGER&#x27;</span>;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<h3 id="MySQL-函数【重要】"><a href="#MySQL-函数【重要】" class="headerlink" title="MySQL 函数【重要】"></a>MySQL 函数【重要】</h3><h4 id="统计函数"><a href="#统计函数" class="headerlink" title="统计函数"></a>统计函数</h4><ol>
<li><p>合计&#x2F;统计函数 <code>COUNT</code></p>
<ul>
<li><p><code>COUNT</code> 返回查询结果中行的总数</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>)<span class="hljs-operator">|</span><span class="hljs-built_in">COUNT</span>(列名) <span class="hljs-keyword">FROM</span> table_name<br>    [<span class="hljs-keyword">WHERE</span> where_definition]<br></code></pre></td></tr></table></figure>

<ol>
<li><code>COUNT(*)</code> 返回满足条件的记录的行数</li>
<li><code>COUNT(列)</code> 统计满足条件的某列有多少行，但是会排除为 <code>NULL</code> 的情况</li>
</ol>
</li>
<li><p>应用案例（以 <code>student</code> 表为例）</p>
<ol>
<li>统计一个班级共有多少学生</li>
<li>统计「数学成绩」大于 <code>80</code> 的学生有多少个</li>
<li>统计「总分」大于 <code>250</code> 的人数有多少</li>
<li>演示 <code>COUNT(*)</code> 和 <code>COUNT(列)</code> 的区别</li>
</ol>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 演示统计函数 COUNT 的使用<br><br><span class="hljs-comment">-- 统计一个班级共有多少学生</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">FROM</span> student;<br><br><span class="hljs-comment">-- 统计「数学成绩」大于 80 的学生有多少个</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">FROM</span> student<br>    <span class="hljs-keyword">WHERE</span> math <span class="hljs-operator">&gt;</span> <span class="hljs-number">80</span>;<br><br><span class="hljs-comment">-- 统计「总分」大于 250 的人数有多少</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">FROM</span> student<br>    <span class="hljs-keyword">WHERE</span> chinese <span class="hljs-operator">+</span> english <span class="hljs-operator">+</span> math <span class="hljs-operator">&gt;</span> <span class="hljs-number">250</span>;<br><br><span class="hljs-comment">-- COUNT(*) 和 COUNT(列) 的区别</span><br>    <span class="hljs-comment">-- count(*) 返回满足条件的记录的行数</span><br>    <span class="hljs-comment">-- count(列) 统计满足条件的某列有多少行，但是会排除为 null 的情况</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t14 (<br>    `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>));<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t14 <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;tom&#x27;</span>), (<span class="hljs-string">&#x27;jack&#x27;</span>), (<span class="hljs-string">&#x27;mary&#x27;</span>), (<span class="hljs-keyword">NULL</span>);<br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t14;<br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">FROM</span> t14; <span class="hljs-comment">-- 4</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(`name`) <span class="hljs-keyword">FROM</span> t14; <span class="hljs-comment">-- 3</span><br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>合计函数 <code>SUM</code></p>
<ul>
<li><p><code>SUM</code> 函数返回满足 <code>WHERE</code> 条件的总行数（一般用在数值列）</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">SUM</span>(列名) &#123;, <span class="hljs-built_in">SUM</span>(列名)...&#125; <span class="hljs-keyword">FROM</span> table_name<br>    [<span class="hljs-keyword">WHERE</span> where_definition]<br></code></pre></td></tr></table></figure>

<ol>
<li><code>SUM</code> 仅对数值起作用，否则会报错</li>
<li>对多列求和，<code>,</code> 号不能少</li>
</ol>
</li>
<li><p>应用案例（以 <code>student</code> 表为例）</p>
<ol>
<li>统计一个班级「数学」总成绩</li>
<li>统计一个班级「语文」、「英语」、「数学」各科的总成绩</li>
<li>统计一个班级「语文」、「英语」、「数学」的成绩总和</li>
<li>统计一个班级「语文」成绩平均分</li>
</ol>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 演示统计函数 SUM 的使用<br><br><span class="hljs-comment">-- 统计一个班级「数学」总成绩</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">SUM</span>(math) <span class="hljs-keyword">FROM</span> student;<br><br><span class="hljs-comment">-- 统计一个班级「语文」、「英语」、「数学」各科的总成绩</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">SUM</span>(chinese), <span class="hljs-built_in">SUM</span>(english), <span class="hljs-built_in">SUM</span>(math) <span class="hljs-keyword">FROM</span> student;<br><br><span class="hljs-comment">-- 统计一个班级「语文」、「英语」、「数学」的成绩总和</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">SUM</span>(chinese <span class="hljs-operator">+</span> english <span class="hljs-operator">+</span> math) <span class="hljs-keyword">FROM</span> student;<br><br><span class="hljs-comment">-- 统计一个班级「语文」成绩平均分</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">SUM</span>(chinese) <span class="hljs-operator">/</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">FROM</span> student;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>合计函数 <code>AVG</code></p>
<ul>
<li><p><code>AVG</code> 函数返回满足 <code>WHERE</code> 条件的一列的平均值</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">AVG</span>(列名) &#123;, <span class="hljs-built_in">AVG</span>(列名)&#125; <span class="hljs-keyword">FROM</span> table_name<br>    [<span class="hljs-keyword">WHERE</span> where_definition]<br></code></pre></td></tr></table></figure>
</li>
<li><p>应用案例（以 <code>student</code> 表为例）</p>
<ol>
<li>求一个班级「数学」平均分</li>
<li>求一个班级「总分」平均分</li>
</ol>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>合计函数 <code>MAX/MIN</code></p>
<ul>
<li><p><code>MAX/MIN</code> 函数返回满足 <code>WHERE</code> 条件的一列的<code>最大/最小</code>值</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MAX</span>(列名) FORM table_name<br>    [<span class="hljs-keyword">WHERE</span> where_definition]<br></code></pre></td></tr></table></figure>
</li>
<li><p>应用案例（以 <code>student</code> 表为例）</p>
<ol>
<li>求班级「语文」最高分和最低分</li>
<li>求班级最高分和最低分</li>
</ol>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 演示统计函数 MAX<span class="hljs-operator">/</span>MIN 的使用<br><br><span class="hljs-comment">-- 求班级「语文」最高分和最低分</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MAX</span>(chinese), <span class="hljs-built_in">MIN</span>(chinese) <span class="hljs-keyword">FROM</span> student;<br><br><span class="hljs-comment">-- 求班级最高分和最低分</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MAX</span>(chinese <span class="hljs-operator">+</span> english <span class="hljs-operator">+</span> math) <span class="hljs-keyword">AS</span> max_score, <br>    <span class="hljs-built_in">MIN</span>(chinese <span class="hljs-operator">+</span> english <span class="hljs-operator">+</span> math) <span class="hljs-keyword">AS</span> min_score<br>    <span class="hljs-keyword">FROM</span> student;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>分组统计</p>
<ul>
<li><p>使用 <code>GROUP BY</code> 子句对列进行分组</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> column1, column2, column3... <span class="hljs-keyword">FROM</span> `<span class="hljs-keyword">table</span>`<br>    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">column</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>使用 <code>HAVING</code> 子句对分组后的结果进行过滤</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> column1, column2, column3...<br>    <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">table</span><br>    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">column</span> HAVING...<br></code></pre></td></tr></table></figure>

<ul>
<li><code>HAVING</code> 子句用于限制分组显示结果</li>
</ul>
</li>
<li><p>应用案例（以 <code>dept</code> 部门表为例）</p>
<ol>
<li>显示每个部门的平均工资和最高工资</li>
<li>显示每个部门的每种岗位的平均工资和最低工资</li>
<li>用别名显示平均工资低于 <code>2000</code> 的部门号和它的平均工资</li>
</ol>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 演示 <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> 的使用<br><br><span class="hljs-comment">-- dept 部门表</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> dept ( <span class="hljs-comment">/*部门表*/</span><br>    dept_no MEDIUMINT UNSIGNED <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0</span>, <span class="hljs-comment">-- 编号</span><br>    d_name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> &quot;&quot;, <span class="hljs-comment">-- 名称</span><br>    loc <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">13</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> &quot;&quot; <span class="hljs-comment">-- 地区</span><br>);<br><span class="hljs-comment">-- 在部门表添加数据</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> dept <span class="hljs-keyword">VALUES</span><br>    (<span class="hljs-number">10</span>, <span class="hljs-string">&#x27;ACCOUNTING&#x27;</span>, <span class="hljs-string">&#x27;NEW YORK&#x27;</span>), <span class="hljs-comment">-- 财务部</span><br>    (<span class="hljs-number">20</span>, <span class="hljs-string">&#x27;RESEARCH&#x27;</span>, <span class="hljs-string">&#x27;DALLAS&#x27;</span>), <span class="hljs-comment">-- 研发部</span><br>    (<span class="hljs-number">30</span>, <span class="hljs-string">&#x27;SALES&#x27;</span>, <span class="hljs-string">&#x27;CHICAGO&#x27;</span>), <span class="hljs-comment">-- 销售部</span><br>    (<span class="hljs-number">40</span>, <span class="hljs-string">&#x27;OPERATIONS&#x27;</span>, <span class="hljs-string">&#x27;BOSTON&#x27;</span>); <span class="hljs-comment">-- 业务部</span><br><br><span class="hljs-comment">-- emp 员工表</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> emp ( <span class="hljs-comment">/*员工表*/</span><br>    emp_no MEDIUMINT UNSIGNED <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0</span>, <span class="hljs-comment">-- 编号</span><br>    d_name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> &quot;&quot;, <span class="hljs-comment">-- 名字</span><br>    job <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">9</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> &quot;&quot;, <span class="hljs-comment">-- 工作</span><br>    mgr MEDIUMINT UNSIGNED <span class="hljs-comment">/*无符号*/</span>, <span class="hljs-comment">-- 上级编号</span><br>    hire_date <span class="hljs-type">DATE</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>, <span class="hljs-comment">-- 入职时间</span><br>    sal <span class="hljs-type">DECIMAL</span>(<span class="hljs-number">7</span>, <span class="hljs-number">2</span>), <span class="hljs-comment">-- 薪水</span><br>    comm <span class="hljs-type">DECIMAL</span>(<span class="hljs-number">7</span>, <span class="hljs-number">2</span>), <span class="hljs-comment">-- 奖金</span><br>    dept_no MEDIUMINT UNSIGNED <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0</span> <span class="hljs-comment">-- 部门编号</span><br>);<br><span class="hljs-comment">-- 在员工表添加数据</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> emp <span class="hljs-keyword">VALUES</span><br>    (<span class="hljs-number">7369</span>,<span class="hljs-string">&#x27;SMITH&#x27;</span>,<span class="hljs-string">&#x27;CLERK&#x27;</span>,<span class="hljs-number">7902</span>,<span class="hljs-string">&#x27;1990-12-17&#x27;</span>,<span class="hljs-number">800.00</span>,<span class="hljs-keyword">NULL</span>,<span class="hljs-number">20</span>),<br>    (<span class="hljs-number">7499</span>,<span class="hljs-string">&#x27;ALLEN&#x27;</span>,<span class="hljs-string">&#x27;SALESMAN&#x27;</span>,<span class="hljs-number">7698</span>,<span class="hljs-string">&#x27;1991-2-20&#x27;</span>,<span class="hljs-number">1600.00</span>,<span class="hljs-number">300.00</span>,<span class="hljs-number">30</span>),<br>    (<span class="hljs-number">7521</span>,<span class="hljs-string">&#x27;WARD&#x27;</span>,<span class="hljs-string">&#x27;SALESMAN&#x27;</span>,<span class="hljs-number">7698</span>,<span class="hljs-string">&#x27;1991-2-22&#x27;</span>,<span class="hljs-number">1250.00</span>,<span class="hljs-number">500.00</span>,<span class="hljs-number">30</span>),<br>    (<span class="hljs-number">7566</span>,<span class="hljs-string">&#x27;JONES&#x27;</span>,<span class="hljs-string">&#x27;MANAGER&#x27;</span>,<span class="hljs-number">7839</span>,<span class="hljs-string">&#x27;1991-4-2&#x27;</span>,<span class="hljs-number">2975.00</span>,<span class="hljs-keyword">NULL</span>,<span class="hljs-number">20</span>),<br>    (<span class="hljs-number">7654</span>,<span class="hljs-string">&#x27;MARTIN&#x27;</span>,<span class="hljs-string">&#x27;SALESMAN&#x27;</span>,<span class="hljs-number">7698</span>,<span class="hljs-string">&#x27;1991-9-28&#x27;</span>,<span class="hljs-number">1250.00</span>,<span class="hljs-number">1400.00</span>,<span class="hljs-number">30</span>),<br>    (<span class="hljs-number">7698</span>,<span class="hljs-string">&#x27;BLAKE&#x27;</span>,<span class="hljs-string">&#x27;MANAGER&#x27;</span>,<span class="hljs-number">7839</span>,<span class="hljs-string">&#x27;1991-5-1&#x27;</span>,<span class="hljs-number">2850.00</span>,<span class="hljs-keyword">NULL</span>,<span class="hljs-number">30</span>),<br>    (<span class="hljs-number">7782</span>,<span class="hljs-string">&#x27;CLARK&#x27;</span>,<span class="hljs-string">&#x27;MANAGER&#x27;</span>,<span class="hljs-number">7839</span>,<span class="hljs-string">&#x27;1991-6-9&#x27;</span>,<span class="hljs-number">2450.00</span>,<span class="hljs-keyword">NULL</span>,<span class="hljs-number">10</span>),<br>    (<span class="hljs-number">7788</span>,<span class="hljs-string">&#x27;SCOTT&#x27;</span>,<span class="hljs-string">&#x27;ANALYST&#x27;</span>,<span class="hljs-number">7566</span>,<span class="hljs-string">&#x27;1997-4-19&#x27;</span>,<span class="hljs-number">3000.00</span>,<span class="hljs-keyword">NULL</span>,<span class="hljs-number">20</span>),<br>    (<span class="hljs-number">7839</span>,<span class="hljs-string">&#x27;KING&#x27;</span>,<span class="hljs-string">&#x27;PRESIDENT&#x27;</span>,<span class="hljs-keyword">NULL</span>,<span class="hljs-string">&#x27;1991-11-17&#x27;</span>,<span class="hljs-number">5000.00</span>,<span class="hljs-keyword">NULL</span>,<span class="hljs-number">10</span>),<br>    (<span class="hljs-number">7844</span>,<span class="hljs-string">&#x27;TURNER&#x27;</span>,<span class="hljs-string">&#x27;SALESMAN&#x27;</span>,<span class="hljs-number">7698</span>,<span class="hljs-string">&#x27;1991-9-8&#x27;</span>,<span class="hljs-number">1500.00</span>,<span class="hljs-keyword">NULL</span>,<span class="hljs-number">30</span>),<br>    (<span class="hljs-number">7900</span>,<span class="hljs-string">&#x27;JAMES&#x27;</span>,<span class="hljs-string">&#x27;CLERK&#x27;</span>,<span class="hljs-number">7698</span>,<span class="hljs-string">&#x27;1991-12-3&#x27;</span>,<span class="hljs-number">950.00</span>,<span class="hljs-keyword">NULL</span>,<span class="hljs-number">30</span>),<br>    (<span class="hljs-number">7902</span>,<span class="hljs-string">&#x27;FORD&#x27;</span>,<span class="hljs-string">&#x27;ANALYST&#x27;</span>,<span class="hljs-number">7566</span>,<span class="hljs-string">&#x27;1991-12-3&#x27;</span>,<span class="hljs-number">3000.00</span>,<span class="hljs-keyword">NULL</span>,<span class="hljs-number">20</span>),<br>    (<span class="hljs-number">7934</span>,<span class="hljs-string">&#x27;MILLER&#x27;</span>,<span class="hljs-string">&#x27;CLERK&#x27;</span>,<span class="hljs-number">7782</span>,<span class="hljs-string">&#x27;1992-1-23&#x27;</span>,<span class="hljs-number">1300.00</span>,<span class="hljs-keyword">NULL</span>,<span class="hljs-number">10</span>);<br><br><span class="hljs-comment">-- sal_grade 工资级别表</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> sal_grade (<br>    grade MEDIUMINT UNSIGNED <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0</span>, <span class="hljs-comment">-- 工资级别</span><br>    lo_sal <span class="hljs-type">DECIMAL</span>(<span class="hljs-number">17</span>, <span class="hljs-number">2</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>, <span class="hljs-comment">-- 该级别最低工资</span><br>    hi_sal <span class="hljs-type">DECIMAL</span>(<span class="hljs-number">17</span>, <span class="hljs-number">2</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-comment">-- 该级别最高工资</span><br>);<br><span class="hljs-comment">-- 在工资级别表中添加数据</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> sal_grade <span class="hljs-keyword">VALUES</span><br>    (<span class="hljs-number">1</span>,<span class="hljs-number">700</span>,<span class="hljs-number">1200</span>),<br>    (<span class="hljs-number">2</span>,<span class="hljs-number">1201</span>,<span class="hljs-number">1400</span>),<br>    (<span class="hljs-number">3</span>,<span class="hljs-number">1401</span>,<span class="hljs-number">2000</span>),<br>    (<span class="hljs-number">4</span>,<span class="hljs-number">2001</span>,<span class="hljs-number">3000</span>),<br>    (<span class="hljs-number">5</span>,<span class="hljs-number">3001</span>,<span class="hljs-number">9999</span>);<br><br># 演示 <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> <span class="hljs-operator">+</span> <span class="hljs-keyword">having</span> <br><span class="hljs-comment">-- 显示每个部门的平均工资和最高工资</span><br>    <span class="hljs-comment">-- 分析：1. avg(sal) max(sal)</span><br>    <span class="hljs-comment">-- 2. 按照部门来分组查询</span><br><span class="hljs-keyword">SELECT</span>  dept_no, <span class="hljs-built_in">AVG</span>(sal), <span class="hljs-built_in">MAX</span>(sal)<br>    <span class="hljs-keyword">FROM</span> emp <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> dept_no;<br><br><span class="hljs-comment">-- 显示每个部门的每种岗位的平均工资和最低工资</span><br>    <span class="hljs-comment">-- 分析：1. 显示每个部门的平均工资和最低工资</span><br>    <span class="hljs-comment">-- 2. 显示每个部门的每种岗位的平均工资和最低工资</span><br><span class="hljs-keyword">SELECT</span>  dept_no, job, <span class="hljs-built_in">AVG</span>(sal), <span class="hljs-built_in">MIN</span>(sal)<br>    <span class="hljs-keyword">FROM</span> emp <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> dept_no, job;<br><br><span class="hljs-comment">-- 用别名显示平均工资低于 2000 的部门号和它的平均工资</span><br>    <span class="hljs-comment">-- 分析[化繁为简]：1. 显示各个部门的平均工资和部门号</span><br>    <span class="hljs-comment">-- 2. 筛选工资低于 2000 的部门</span><br>    <span class="hljs-comment">-- 3. 使用别名进行过滤</span><br><span class="hljs-keyword">SELECT</span> dept_no, <span class="hljs-built_in">AVG</span>(sal) <span class="hljs-keyword">AS</span> avg_sal<br>    <span class="hljs-keyword">FROM</span> emp <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> dept_no <br>        <span class="hljs-keyword">HAVING</span> avg_sal <span class="hljs-operator">&lt;</span> <span class="hljs-number">2000</span>;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<h4 id="字符串函数"><a href="#字符串函数" class="headerlink" title="字符串函数"></a>字符串函数</h4><ol>
<li><p>字符串函数</p>
<table>
<thead>
<tr>
<th align="left">字符串函数</th>
<th align="left">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>CHARSET (str)</code></td>
<td align="left">返回字串字符集</td>
</tr>
<tr>
<td align="left"><code>CONCAT (string [,..])</code></td>
<td align="left">连接字串</td>
</tr>
<tr>
<td align="left"><code>INSTR (string, substring)</code></td>
<td align="left">返回 <code>substring</code> 在 <code>string</code> 中出现的位置，没有返回 <code>0</code></td>
</tr>
<tr>
<td align="left"><code>UCASE (string)</code></td>
<td align="left">转换成大写</td>
</tr>
<tr>
<td align="left"><code>LCASE (string)</code></td>
<td align="left">转换成小写</td>
</tr>
<tr>
<td align="left"><code>LEFT (string, length)</code></td>
<td align="left">从 <code>string</code> 中的左边起取 <code>length</code> 个字符</td>
</tr>
<tr>
<td align="left"><code>LENGTH (string)</code></td>
<td align="left"><code>string</code> 长度（按照字节）</td>
</tr>
<tr>
<td align="left"><code>REPLACE (str, search_str, replace_str)</code></td>
<td align="left">在 <code>str</code> 中用 <code>replace_str</code> 替换 <code>search_str</code></td>
</tr>
<tr>
<td align="left"><code>STRCMP(string1,string2)</code></td>
<td align="left">逐字符比较两字串大小，</td>
</tr>
<tr>
<td align="left"><code>SUBSTRING (str,position [,length])</code></td>
<td align="left">从 <code>str</code> 的 <code>position</code> 开始（从 <code>1</code> 开始计算），取 <code>length</code> 个字符</td>
</tr>
<tr>
<td align="left"><code>LTRIM (string), RTRIM(string), TRIM(string)</code></td>
<td align="left">去除前端空格、后端空格，以及前后两端的空格</td>
</tr>
</tbody></table>
<ul>
<li><code>DUAL</code>: 亚元表，用于测试代码</li>
</ul>
</li>
<li><p>应用案例（emp 表）</p>
<ul>
<li><p>以首字母小写的方式显示所有员工 <code>emp</code> 的姓名</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 演示字符串函数的使用<br><br><span class="hljs-comment">-- 以首字母小写的方式显示所有员工 emp 的姓名</span><br><span class="hljs-keyword">SELECT</span> d_name, <br>    CONCAT(<span class="hljs-keyword">LEFT</span>(LCASE(d_name),<span class="hljs-number">1</span>), <br>    <span class="hljs-built_in">SUBSTRING</span>(d_name, <span class="hljs-number">2</span>)) <span class="hljs-keyword">AS</span> new_name<br>    <span class="hljs-keyword">FROM</span> emp;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<h4 id="数学函数"><a href="#数学函数" class="headerlink" title="数学函数"></a>数学函数</h4><table>
<thead>
<tr>
<th align="left">数学函数</th>
<th align="left">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>ABS (num)</code></td>
<td align="left">绝对值</td>
</tr>
<tr>
<td align="left"><code>BIN (decimal number)</code></td>
<td align="left">十进制转二进制</td>
</tr>
<tr>
<td align="left"><code>CEILING (number)</code></td>
<td align="left">向上取整，得到比 <code>num</code> 大的最小整数</td>
</tr>
<tr>
<td align="left"><code>CONV(number, from base, to_base)</code></td>
<td align="left">进制转换</td>
</tr>
<tr>
<td align="left"><code>FLOOR (number)</code></td>
<td align="left">向下取整，得到比 <code>num</code> 小的最大整数</td>
</tr>
<tr>
<td align="left"><code>FORMAT (number, decimal_places)</code></td>
<td align="left">保留小数位数（四舍五入）</td>
</tr>
<tr>
<td align="left"><code>HEX (DecimalNumber)</code></td>
<td align="left">转十六进制</td>
</tr>
<tr>
<td align="left"><code>LEAST (number, number2 [,...])</code></td>
<td align="left">求最小值</td>
</tr>
<tr>
<td align="left"><code>MOD(numerator, denominator)</code></td>
<td align="left">求余</td>
</tr>
<tr>
<td align="left"><code>RAND([seed])</code></td>
<td align="left"><code>rand()</code> 返回一个随机的浮点值 <code>V</code>，其范围为 <code>0 ≤ V ≤ 1.0</code>。若已指定一个整数参数 <code>N</code>，则它被用作种子值，<code>seed</code> 不变，该随机数也不变</td>
</tr>
</tbody></table>
<h4 id="时间日期"><a href="#时间日期" class="headerlink" title="时间日期"></a>时间日期</h4><ol>
<li><p>日期相关函数</p>
<table>
<thead>
<tr>
<th align="left">日期函数</th>
<th align="left">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>CURRENT_DATE()</code></td>
<td align="left">当前日期</td>
</tr>
<tr>
<td align="left"><code>CURRENT_TIME()</code></td>
<td align="left">当前时间</td>
</tr>
<tr>
<td align="left"><code>CURRENT_TIMESTAMP()</code></td>
<td align="left">当前时间戳</td>
</tr>
<tr>
<td align="left"><code>DATE (datetime)</code></td>
<td align="left">返回 <code>datetime</code> 的日期部分</td>
</tr>
<tr>
<td align="left"><code>DATE_ADD (date, INTERVAL d_value d_type)</code></td>
<td align="left">在 <code>date</code> 中加上日期或时间（<code>YEAR, MINUTE, SECOND, HOUR, DAY</code>），<code>date</code> 为 <code>DATE, DATETIME</code> 或 <code>TIMESTAMP</code></td>
</tr>
<tr>
<td align="left"><code>DATE_SUB (date, INTERVAL d_value d_type)</code></td>
<td align="left">在 <code>date</code> 上减去一个时间（<code>YEAR, MINUTE, SECOND, HOUR, DAY</code>），<code>date</code> 为 <code>DATE, DATETIME</code> 或 <code>TIMESTAMP</code></td>
</tr>
<tr>
<td align="left"><code>DATEDIFF (date1, date2)</code></td>
<td align="left">两个日期差（结果为天），可以取负数，<code>date</code> 为 <code>DATE, DATETIME</code> 或 <code>TIMESTAMP</code></td>
</tr>
<tr>
<td align="left"><code>TIMEDIFF (date1, date2)</code></td>
<td align="left">两个时间差（X小时X分钟X秒）</td>
</tr>
<tr>
<td align="left"><code>NOW()</code></td>
<td align="left">当前时间</td>
</tr>
<tr>
<td align="left"><code>YEAR/MONTH/... DATE(datetime)</code></td>
<td align="left">只显示指定的时间单位</td>
</tr>
<tr>
<td align="left"><code>UNIX_TIMESTAMP()</code></td>
<td align="left">返回 <code>1970-1-1</code> 到现在的秒数</td>
</tr>
<tr>
<td align="left"><code>FROM_UNIXTIME()</code></td>
<td align="left">把一个 <code>UNIX_TIMESTAMP</code> 秒数，转成指定格式的日期</td>
</tr>
</tbody></table>
<ul>
<li>在实际开发中，我们也经常使用 <code>int</code> 来保存一个 <code>unix</code> 时间戳，然后使用 <code>from_unixtime()</code> 进行转换</li>
</ul>
</li>
<li><p>应用案例（mes 表）</p>
<ol>
<li>显示所有新闻信息，发布日期只显示日期，不显示时间</li>
<li>查询在 20 分钟内发布的帖子（时间轴）</li>
<li>求出 <code>2011-11-11</code> 和 <code>1990-1-1</code> 相差多少天</li>
<li>求出生到现在活了多少天</li>
<li>如果能活到 80 岁，还能活多少天</li>
</ol>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 演示日期相关函数<br><br><span class="hljs-comment">-- CURRENT_DATE(): 当前日期</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">CURRENT_DATE</span>() <span class="hljs-keyword">FROM</span> DUAL<br><br><span class="hljs-comment">-- CURRENT_TIME(): 当前时间</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">CURRENT_TIME</span>() <span class="hljs-keyword">FROM</span> DUAL<br><br><span class="hljs-comment">-- CURRENT_TIMESTAMP(): 当前时间戳</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>() <span class="hljs-keyword">FROM</span> DUAL<br><br><span class="hljs-comment">-- NOW() 返回当前时期时间</span><br><span class="hljs-keyword">SELECT</span> NOW() <span class="hljs-keyword">FROM</span> DUAL;<br><br><span class="hljs-comment">-- 创建测试表</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> mes(<br>    id <span class="hljs-type">INT</span>,<br>    content <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">30</span>),<br>    send_time DATETIME<br>);<br><span class="hljs-comment">-- 写入数据</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> mes <span class="hljs-keyword">VALUES</span><br>    (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;北京新闻&#x27;</span>, <span class="hljs-built_in">CURRENT_TIMESTAMP</span> ()),<br>    (<span class="hljs-number">2</span>, <span class="hljs-string">&#x27;上海新闻&#x27;</span>, <span class="hljs-built_in">CURRENT_TIME</span>()),<br>    (<span class="hljs-number">3</span>, <span class="hljs-string">&#x27;南京新闻&#x27;</span>, NOW());<br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> mes;<br><br><span class="hljs-comment">-- 显示所有新闻信息，发布日期只显示日期，不显示时间</span><br><span class="hljs-keyword">SELECT</span> id, content, <span class="hljs-type">DATE</span>(send_time)<br>    <span class="hljs-keyword">FROM</span> mes;<br>    <br><span class="hljs-comment">-- 查询在 20 分钟内发布的帖子</span><br>    <span class="hljs-comment">-- INTERVAL 后可以是 年月日时分秒</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> mes<br>    <span class="hljs-keyword">WHERE</span> DATE_ADD(send_time, <span class="hljs-type">INTERVAL</span> <span class="hljs-number">20</span> <span class="hljs-keyword">MINUTE</span>) <span class="hljs-operator">&gt;=</span> NOW();<br><span class="hljs-comment">-- 查询在 20 分钟内发布的帖子</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> mes<br>    <span class="hljs-keyword">WHERE</span> DATE_SUB(NOW(), <span class="hljs-type">INTERVAL</span> <span class="hljs-number">20</span> <span class="hljs-keyword">MINUTE</span>) <span class="hljs-operator">&lt;=</span> send_time;<br><br><span class="hljs-comment">-- 求出 2011-11-11 和 1990-1-1 相差多少天</span><br><span class="hljs-keyword">SELECT</span> DATEDIFF(<span class="hljs-string">&#x27;2011-11-11&#x27;</span>, <span class="hljs-string">&#x27;1990-01-01&#x27;</span>) <span class="hljs-keyword">FROM</span> DUAL;<br><br><span class="hljs-comment">-- 求出生到现在活了多少天</span><br><span class="hljs-keyword">SELECT</span> DATEDIFF(<span class="hljs-built_in">CURRENT_DATE</span> <span class="hljs-comment">/*NOW()*/</span>, <span class="hljs-string">&#x27;2000-01-01&#x27;</span>) <span class="hljs-keyword">FROM</span> DUAL;<br><br><span class="hljs-comment">-- 如果能活到 80 岁，还能活多少天</span><br><span class="hljs-keyword">SELECT</span> DATEDIFF(DATE_ADD(<span class="hljs-string">&#x27;2000-01-01&#x27;</span>, <span class="hljs-type">INTERVAL</span> <span class="hljs-number">80</span> <span class="hljs-keyword">YEAR</span>), NOW())<br>    <span class="hljs-keyword">FROM</span> DUAL;<br><br><span class="hljs-comment">-- 两个时间差（X小时X分钟X秒）</span><br><span class="hljs-keyword">SELECT</span> TIMEDIFF(<span class="hljs-string">&#x27;20:13:39&#x27;</span>, <span class="hljs-string">&#x27;09:33:03&#x27;</span>) <span class="hljs-keyword">FROM</span> DUAL;<br><br><span class="hljs-comment">-- YEAR/MONTH/DAY/HOUR/MINUTE/SECOND/ DATE(datetime)</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">YEAR</span>(NOW()) <span class="hljs-keyword">FROM</span> DUAL;<br><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DAY</span>(<span class="hljs-string">&#x27;2013-12-22&#x27;</span>) <span class="hljs-keyword">FROM</span> DUAL;<br><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">HOUR</span>(NOW()) <span class="hljs-keyword">FROM</span> DUAL;<br><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">SECOND</span>(<span class="hljs-string">&#x27;20:11:20&#x27;</span>) <span class="hljs-keyword">FROM</span> DUAL;<br><br><span class="hljs-comment">-- unix_timestamp 返回 1970-1-1 到现在的秒数</span><br><span class="hljs-keyword">SELECT</span> UNIX_TIMESTAMP() <span class="hljs-keyword">FROM</span> DUAL;<br><br><span class="hljs-comment">-- FROM_UNIXTIME() 把一个 UNIX_TIMESTAMP 秒数，转成指定格式的日期</span><br><span class="hljs-keyword">SELECT</span> FROM_UNIXTIME(<span class="hljs-number">1662520519</span>, <span class="hljs-string">&#x27;%Y-%m-%d&#x27;</span>) <span class="hljs-keyword">FROM</span> DUAL;<br><span class="hljs-keyword">SELECT</span> FROM_UNIXTIME(<span class="hljs-number">1662520519</span>, <span class="hljs-string">&#x27;%Y-%m-%d %H:%i:%s&#x27;</span>) <span class="hljs-keyword">FROM</span> DUAL;<br></code></pre></td></tr></table></figure></li>
</ol>
<h4 id="加密函数"><a href="#加密函数" class="headerlink" title="加密函数"></a>加密函数</h4><ol>
<li><p>加密函数和系统函数</p>
<table>
<thead>
<tr>
<th align="left">函数</th>
<th align="left">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>USER()</code></td>
<td align="left">查询当前用户以及登录的 IP</td>
</tr>
<tr>
<td align="left"><code>DATABASE()</code></td>
<td align="left">查询当前使用的数据库名称</td>
</tr>
<tr>
<td align="left"><code>MD5(str)</code></td>
<td align="left">为字符串算出一个 <code>MD5 32</code> 的字符串，常用于（用户密码）加密</td>
</tr>
<tr>
<td align="left"><code>PASSWORD(str)</code></td>
<td align="left">从原文密码 <code>str</code> 计算并返回密码字符串，通常用于对 <code>mysql</code> 数据库的用户密码加密</td>
</tr>
</tbody></table>
</li>
<li><p>应用案例（users 表）</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 演示加密函数和系统函数<br><br><span class="hljs-comment">-- USER() 查询登录到 mysql 的有哪些用户以及登录的 IP</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">USER</span>() <span class="hljs-keyword">FROM</span> DUAL; <span class="hljs-comment">-- 用户@IP地址</span><br><br><span class="hljs-comment">-- DATABASE() 查询当前使用的数据库名称</span><br><span class="hljs-keyword">SELECT</span> DATABASE() <span class="hljs-keyword">FROM</span> DUAL;<br><br><span class="hljs-comment">-- MD5(str) 为字符串算出一个 MD5 32 位的字符串，（用户密码）加密</span><br>    <span class="hljs-comment">-- root 密码是 123456 -&gt; 加密 md5 -&gt; 在数据库中存放的是加密后的密码</span><br><span class="hljs-keyword">SELECT</span> MD5(<span class="hljs-string">&#x27;123456&#x27;</span>) <span class="hljs-keyword">FROM</span> DUAL;<br><br><span class="hljs-comment">-- 演示用户表，存放 md5 密码</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> users (<br>    id <span class="hljs-type">INT</span>,<br>    `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>    pwd <span class="hljs-type">CHAR</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;&#x27;</span><br>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> users <span class="hljs-keyword">VALUES</span> (<br>    <span class="hljs-number">100</span>, <span class="hljs-string">&#x27;Mary&#x27;</span>, MD5(<span class="hljs-string">&#x27;0000&#x27;</span>));<br><span class="hljs-comment">-- 查询数据</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> users<br>    <span class="hljs-keyword">WHERE</span> `name`<span class="hljs-operator">=</span><span class="hljs-string">&#x27;Mary&#x27;</span> <span class="hljs-keyword">AND</span> pwd<span class="hljs-operator">=</span>MD5(<span class="hljs-string">&#x27;0000&#x27;</span>);<br><br><span class="hljs-comment">-- PASSWORD(str) 从原文密码 str 计算并返回密码字符串</span><br>    <span class="hljs-comment">-- 通常用于对 mysql 数据库的用户密码加密</span><br>    <span class="hljs-comment">-- mysql 数据库的用户密码默认为 PASSWORD 函数加密</span><br><span class="hljs-keyword">SELECT</span> PASSWORD(<span class="hljs-string">&#x27;0000&#x27;</span>) <span class="hljs-keyword">FROM</span> DUAL;<br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> mysql.user;<br></code></pre></td></tr></table></figure></li>
</ol>
<h4 id="流程控制"><a href="#流程控制" class="headerlink" title="流程控制"></a>流程控制</h4><ol>
<li><p>流程控制函数</p>
<table>
<thead>
<tr>
<th align="left">函数</th>
<th align="left">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>IF (expr1, expr2, expr3)</code></td>
<td align="left">如果 <code>expr1</code> 为 <code>true</code>，则返回 <code>expr2</code>，否则返回 <code>expr3</code></td>
</tr>
<tr>
<td align="left"><code>IFNULL (expr1, expr2)</code></td>
<td align="left">如果 <code>expr1</code> 不为 <code>NULL</code>，则返回 <code>expr1</code>，否则返回 <code>expr2</code></td>
</tr>
<tr>
<td align="left"><code>SELECT CASE WHEN expr1 THEN expr2 WHEN expr3 THEN expr4 ELSE expr5 END;</code></td>
<td align="left">如果 <code>expr1</code> 为 <code>true</code>，则返回 <code>expr2</code>，否则继续判断如果 <code>expr3</code> 为 <code>true</code>，返回 <code>expr4</code>，否则返回 <code>expr5</code>（类似多重分支）</td>
</tr>
</tbody></table>
<ul>
<li>判断是否为空 <code>IS NULL</code>，判断不为空 <code>IS NUT NULL</code></li>
</ul>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 演示流程控制语句<br><br><span class="hljs-comment">-- IF(expr1, expr2, expr3) 如果 expr1 为 true，则返回 expr2，否则返回 expr3</span><br><span class="hljs-keyword">SELECT</span> IF(<span class="hljs-literal">TRUE</span>, <span class="hljs-string">&#x27;北京&#x27;</span>, <span class="hljs-string">&#x27;上海&#x27;</span>) <span class="hljs-keyword">FROM</span> DUAL; <span class="hljs-comment">-- 北京</span><br><span class="hljs-keyword">SELECT</span> IF(<span class="hljs-literal">FALSE</span>, <span class="hljs-string">&#x27;北京&#x27;</span>, <span class="hljs-string">&#x27;上海&#x27;</span>) <span class="hljs-keyword">FROM</span> DUAL; <span class="hljs-comment">-- 上海</span><br><br><span class="hljs-comment">-- IFNULL(expr1, expr2) 如果 expr1 不为 NULL，则返回 expr1，否则返回 expr2</span><br><span class="hljs-keyword">SELECT</span> IFNULL(<span class="hljs-keyword">NULL</span>, <span class="hljs-string">&#x27;Hello&#x27;</span>) <span class="hljs-keyword">FROM</span> DUAL; <span class="hljs-comment">-- Hello</span><br><span class="hljs-keyword">SELECT</span> IFNULL(<span class="hljs-string">&#x27;Jack&#x27;</span>, <span class="hljs-string">&#x27;Hello&#x27;</span>) <span class="hljs-keyword">FROM</span> DUAL; <span class="hljs-comment">-- Jack</span><br><br><span class="hljs-comment">-- SELECT CASE WHEN expr1 THEN expr2 WHEN expr3 THEN expr4 ELSE expr5 END;</span><br>    <span class="hljs-comment">-- 如果 expr1 为 true，则返回 expr2，如果 expr3 为 true，返回 expr4，否则返回 expr5（类似多重分支）</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">CASE</span><br>    <span class="hljs-keyword">WHEN</span> <span class="hljs-literal">FALSE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">&#x27;Jack&#x27;</span><br>    <span class="hljs-keyword">WHEN</span> <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">&#x27;Tom&#x27;</span> <span class="hljs-comment">-- Tom</span><br>    <span class="hljs-keyword">ELSE</span> <span class="hljs-string">&#x27;Mary&#x27;</span> <span class="hljs-keyword">END</span>;<br></code></pre></td></tr></table></figure>
</li>
<li><p>应用案例（以 emp 表为例）</p>
<ol>
<li>查询 <code>emp</code> 表，如果 <code>comm</code> 是 <code>nul1</code>，则显示 <code>0.0</code></li>
<li>如果 <code>emp</code> 表的 <code>job</code> 是 <code>CLERK</code> 则显示职员，如果是 <code>MANAGER</code> 则显示经理，如果是 <code>SALESMAN</code> 则显示销售人员，其它正常显示</li>
</ol>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 查询 emp 表，如果 comm 是 nul1，则显示 0.0</span><br><span class="hljs-keyword">SELECT</span> emp_no, d_name, IFNULL(comm, <span class="hljs-number">0.0</span>) <span class="hljs-keyword">FROM</span> emp;<br><br><span class="hljs-comment">-- 如果 emp 表的 job 是 CLERK 则显示职员</span><br><span class="hljs-comment">-- 如果是 MANAGER 则显示经理</span><br><span class="hljs-comment">-- 如果是 SALESMAN 则显示销售人员</span><br><span class="hljs-comment">-- 其它正常显示</span><br><span class="hljs-keyword">SELECT</span> emp_no, d_name, (<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">CASE</span><br>        <span class="hljs-keyword">WHEN</span> job<span class="hljs-operator">=</span><span class="hljs-string">&#x27;CLERK&#x27;</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">&#x27;职员&#x27;</span><br>        <span class="hljs-keyword">WHEN</span> job<span class="hljs-operator">=</span><span class="hljs-string">&#x27;MANAGER&#x27;</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">&#x27;经理&#x27;</span><br>        <span class="hljs-keyword">WHEN</span> job<span class="hljs-operator">=</span><span class="hljs-string">&#x27;SALESMAN&#x27;</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">&#x27;销售人员&#x27;</span><br>        <span class="hljs-keyword">ELSE</span> job <span class="hljs-keyword">END</span>) <span class="hljs-keyword">AS</span> <span class="hljs-string">&#x27;职位&#x27;</span><br>    <span class="hljs-keyword">FROM</span> emp;<br></code></pre></td></tr></table></figure></li>
</ol>
<h3 id="MySQL-内连接"><a href="#MySQL-内连接" class="headerlink" title="MySQL 内连接"></a>MySQL 内连接</h3><h3 id="MySQL-外连接【重要】"><a href="#MySQL-外连接【重要】" class="headerlink" title="MySQL 外连接【重要】"></a>MySQL 外连接【重要】</h3><ol>
<li><p>为什么需要外连接<br> 前面使用的多表查询，是利用 <code>WHERE</code> 子句对两张表或者多张表形成的笛卡尔集进行筛选，根据条件显示所有匹配的记录，匹配不上的则不显示。因此，要想得到所有信息，需要使用到外连接</p>
</li>
<li><p>两种外连接</p>
<ol>
<li><p>左外连接：如果需要<strong>左侧</strong>的表<strong>完全显示</strong>，则使用左外连接</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- tab1 为左表，tab2 为右表</span><br><span class="hljs-keyword">SELECT</span> ... <br>    <span class="hljs-keyword">FROM</span> tab1 <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> tab2<br>    <span class="hljs-keyword">ON</span> conditions<br></code></pre></td></tr></table></figure>
</li>
<li><p>右外连接：如果需要<strong>右侧</strong>的表<strong>完全显示</strong>，则使用右外连接</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- tab1 为左表，tab2 为右表</span><br><span class="hljs-keyword">SELECT</span> ... <br>    <span class="hljs-keyword">FROM</span> tab1 <span class="hljs-keyword">RIGHT</span> <span class="hljs-keyword">JOIN</span> tab2<br>    <span class="hljs-keyword">ON</span> conditions<br></code></pre></td></tr></table></figure></li>
</ol>
</li>
<li><p>应用案例</p>
<ul>
<li><p>创建一张学生表和一张成绩表，使用左外连接显示所有人的成绩，如果没有成绩，也要显示该人的姓名和 <code>id</code> 号，成绩显示为空<br>  <img src="/img/mk-2022-09-15-11-26.png" srcset="/img/loading.gif" lazyload alt="学生表和成绩表"></p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 创建 stu 学生表</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> stu (<br>    id <span class="hljs-type">INT</span>,<br>    `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>)<br>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> stu <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;Jack&#x27;</span>), (<span class="hljs-number">2</span>, <span class="hljs-string">&#x27;Tom&#x27;</span>), (<span class="hljs-number">3</span>, <span class="hljs-string">&#x27;Kitty&#x27;</span>), (<span class="hljs-number">4</span>, <span class="hljs-string">&#x27;Nona&#x27;</span>);<br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> stu;<br><br><span class="hljs-comment">-- 创建 exam 成绩表</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> exam (<br>    id <span class="hljs-type">INT</span>,<br>    grade <span class="hljs-type">INT</span><br>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> exam <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, <span class="hljs-number">56</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">76</span>), (<span class="hljs-number">11</span>, <span class="hljs-number">8</span>);<br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> exam;<br><br><span class="hljs-comment">-- 使用左连接，显示所有人的成绩，如果没有成绩，</span><br><span class="hljs-comment">-- 也要显示该人的姓名和 id 号，成绩显示为空</span><br><br><span class="hljs-comment">-- 之前的写法</span><br><span class="hljs-keyword">SELECT</span> `name`, stu.id, grade<br>    <span class="hljs-keyword">FROM</span> stu, exam<br>    <span class="hljs-keyword">WHERE</span> stu.id <span class="hljs-operator">=</span> exam.id;<br><br><span class="hljs-comment">-- 改成左外连接</span><br><span class="hljs-keyword">SELECT</span> `name`, stu.id, grade<br>    <span class="hljs-keyword">FROM</span> stu <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> exam<br>    <span class="hljs-keyword">ON</span> stu.id <span class="hljs-operator">=</span> exam.id;<br></code></pre></td></tr></table></figure>
</li>
<li><p>使用右外连接显示所有成绩，如果没有名字匹配，显示 <code>NULL</code></p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> `name`, stu.id, grade<br>    <span class="hljs-keyword">FROM</span> stu <span class="hljs-keyword">RIGHT</span> <span class="hljs-keyword">JOIN</span> exam<br>    <span class="hljs-keyword">ON</span> stu.id <span class="hljs-operator">=</span> exam.id;<br></code></pre></td></tr></table></figure>
</li>
<li><p>列出部门名称和这些部门的员工名称和工作，同时要求显示出那些<strong>没有员工</strong>的部门</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 左外连接</span><br><span class="hljs-keyword">SELECT</span> d_name, dept.dept_no, e_name, job<br>    <span class="hljs-keyword">FROM</span> dept <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> emp<br>    <span class="hljs-keyword">ON</span> dept.dept_no <span class="hljs-operator">=</span> emp.dept_no<br>    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> d_name;<br><br><span class="hljs-comment">-- 右外连接</span><br><span class="hljs-keyword">SELECT</span> d_name, dept.dept_no, e_name, job<br>    <span class="hljs-keyword">FROM</span> emp <span class="hljs-keyword">RIGHT</span> <span class="hljs-keyword">JOIN</span> dept<br>    <span class="hljs-keyword">ON</span> dept.dept_no <span class="hljs-operator">=</span> emp.dept_no<br>    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> d_name;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<h3 id="MySQL-约束"><a href="#MySQL-约束" class="headerlink" title="MySQL 约束"></a>MySQL 约束</h3><blockquote>
<p>约束用于确保数据库的数据满足特定的商业规则，在 Mysql 中，约束包括：&#96;NOT NULL（非空）, UNIQUE（唯一）, PRIMARY KEY（主键）, FOREIGN KEY（外键） 和 CHECK（检查）五种</p>
</blockquote>
<h4 id="PRIMARY-KEY（主键）"><a href="#PRIMARY-KEY（主键）" class="headerlink" title="PRIMARY KEY（主键）"></a>PRIMARY KEY（主键）</h4><ol>
<li><p>基本介绍</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">字段名 字段类型 <span class="hljs-keyword">PRIMARY</span> KEY<br></code></pre></td></tr></table></figure>

<p> 用于唯一的标示表行的数据，当定义主键结束后，<strong>该列不能重复</strong>而且<strong>不能</strong>为 <code>NULL</code></p>
</li>
<li><p>应用案例</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 新建一张表</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t17 (<br>    id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY, <span class="hljs-comment">-- 表示 id 列是主键</span><br>    `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>),<br>    email <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>)<br>);<br><br><span class="hljs-comment">-- 添加数据</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t17 <span class="hljs-keyword">VALUES</span><br>    (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;Jack&#x27;</span>, <span class="hljs-string">&#x27;jack@qq.com&#x27;</span>),<br>    (<span class="hljs-number">2</span>, <span class="hljs-string">&#x27;Tom&#x27;</span>, <span class="hljs-string">&#x27;tom@qq.com&#x27;</span>);<br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t17 <span class="hljs-keyword">VALUES</span> <span class="hljs-comment">-- 错误，主键不能重复</span><br>    (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;Mary&#x27;</span>, <span class="hljs-string">&#x27;mary@qq.com&#x27;</span>);<br></code></pre></td></tr></table></figure>
</li>
<li><p>注意事项与使用细节</p>
<ol>
<li><p><code>PRIMARY KEY</code> 不能重复而且<strong>不能</strong>为 <code>NULL</code></p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 添加数据，主键列的值不可以重复</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t17 <span class="hljs-keyword">VALUES</span><br>    (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;Jack&#x27;</span>, <span class="hljs-string">&#x27;jack@qq.com&#x27;</span>),<br>    (<span class="hljs-number">2</span>, <span class="hljs-string">&#x27;Tom&#x27;</span>, <span class="hljs-string">&#x27;tom@qq.com&#x27;</span>);<br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t17 <span class="hljs-keyword">VALUES</span> <span class="hljs-comment">-- 错误，主键不能重复</span><br>    (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;Mary&#x27;</span>, <span class="hljs-string">&#x27;mary@qq.com&#x27;</span>);<br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t17 <span class="hljs-keyword">VALUES</span> <span class="hljs-comment">-- 错误，主键不能为空</span><br>    (<span class="hljs-keyword">NULL</span>, <span class="hljs-string">&#x27;Mary&#x27;</span>, <span class="hljs-string">&#x27;mary@qq.com&#x27;</span>);<br></code></pre></td></tr></table></figure>
</li>
<li><p>一张表最多只能有一个主键，但可以是复合主键</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 一张表最多只能有一个主键</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t18 (<br>    id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY,<br>    `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">PRIMARY</span> KEY, <span class="hljs-comment">-- 错误</span><br>    email <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>)<br>);<br><span class="hljs-comment">-- 演示复合主键，id + name 是一个主键</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t18 (<br>    id <span class="hljs-type">INT</span>,<br>    `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>),<br>    email <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>),<br>    <span class="hljs-keyword">PRIMARY</span> KEY (id, `name`) <span class="hljs-comment">-- 复合主键</span><br>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t18 <span class="hljs-keyword">VALUES</span><br>    (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;Jack&#x27;</span>, <span class="hljs-string">&#x27;jack@qq.com&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t18 <span class="hljs-keyword">VALUES</span> <span class="hljs-comment">-- 正确</span><br>    (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;Tom&#x27;</span>, <span class="hljs-string">&#x27;tom@qq.com&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t18 <span class="hljs-keyword">VALUES</span> <span class="hljs-comment">-- 错误</span><br>    (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;Tom&#x27;</span>, <span class="hljs-string">&#x27;tom@qq.com&#x27;</span>);<br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t18;<br></code></pre></td></tr></table></figure>
</li>
<li><p>主键的指定方式有两种</p>
<ol>
<li><p>直接在字段名后指定：<code>字段名 PRIMARY KEY</code></p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t19 (<br>    id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY,<br>    `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>),<br>    email <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>)<br>);<br></code></pre></td></tr></table></figure>
</li>
<li><p>在表定义最后指定：<code>PRIMARY KEY(列名);</code></p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t20 (<br>    id <span class="hljs-type">INT</span>,<br>    `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>),<br>    email <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>),<br>    <span class="hljs-keyword">PRIMARY</span> KEY (`name`)<br>);<br></code></pre></td></tr></table></figure></li>
</ol>
</li>
<li><p>使用 <code>DESC(表名)</code>，可以看到 <code>PRIMARY KEY</code> 的情况</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DESC</span> t20; <span class="hljs-comment">-- 查看 t20 表的结构，显示约束情况</span><br><span class="hljs-keyword">DESC</span> t18; <span class="hljs-comment">-- 复合主键 id + name 是一个主键</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>在实际开发中，每个表往往都会设计一个主键</p>
</li>
</ol>
</li>
</ol>
<h4 id="NOT-NULL（非空）与-UNIQUE（唯一）"><a href="#NOT-NULL（非空）与-UNIQUE（唯一）" class="headerlink" title="NOT NULL（非空）与 UNIQUE（唯一）"></a>NOT NULL（非空）与 UNIQUE（唯一）</h4><ol>
<li><p>NOT NULL</p>
<ul>
<li><p>如果在列上定义了 <code>NOT NULL</code>，那么当插入数据时，必须为列提供数据</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">字段名 字段类型 <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span><br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>UNIQUE</p>
<ul>
<li><p>当定义了唯一约束后，该列值是不能重复的</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">字段名 字段类型 <span class="hljs-keyword">UNIQUE</span><br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>注意事项</p>
<ol>
<li>如果没有指定 <code>NOT NULL</code>，则 <code>UNIQUE</code> 字段可以有多个 <code>NULL</code></li>
<li>一张表可以有<strong>多个</strong> <code>UNIQUE</code> 字段</li>
</ol>
</li>
<li><p>应用案例</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs sql"># <span class="hljs-keyword">UNIQUE</span> 的使用<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t21 (<br>    id <span class="hljs-type">INT</span> <span class="hljs-keyword">UNIQUE</span>, <span class="hljs-comment">-- 表示 id 列不可以重复</span><br>    `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>),<br>    email <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>)<br>);<br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t21 <span class="hljs-keyword">VALUES</span><br>    (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;Jack&#x27;</span>, <span class="hljs-string">&#x27;jack@qq.com&#x27;</span>);<br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t21 <span class="hljs-keyword">VALUES</span> <span class="hljs-comment">-- 错误，重复添加</span><br>    (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;Tom&#x27;</span>, <span class="hljs-string">&#x27;tom@qq.com&#x27;</span>);<br>    <br><span class="hljs-comment">-- 如果没有指定 NOT NULL，则 UNIQUE 字段可以有多个 NULL</span><br><span class="hljs-comment">-- 如果一个列（字段），是 UNIQUE NOT NULL 使用的效果类似 PRIMARY KEY</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t21 <span class="hljs-keyword">VALUES</span><br>    (<span class="hljs-keyword">NULL</span>, <span class="hljs-string">&#x27;Tom&#x27;</span>, <span class="hljs-string">&#x27;tom@qq.com&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t21 <span class="hljs-keyword">VALUES</span> <span class="hljs-comment">-- 正确，可以有多个 NULL </span><br>    (<span class="hljs-keyword">NULL</span>, <span class="hljs-string">&#x27;Tom&#x27;</span>, <span class="hljs-string">&#x27;tom@qq.com&#x27;</span>);<br><br><span class="hljs-comment">-- 一张表可以有多个 UNIQUE 字段</span><br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> t22;<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t22 (<br>    id <span class="hljs-type">INT</span> <span class="hljs-keyword">UNIQUE</span>,<br>    `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">UNIQUE</span>,<br>    email <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>)<br>);<br><span class="hljs-keyword">DESC</span> T22;<br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t21;<br></code></pre></td></tr></table></figure></li>
</ol>
<h4 id="FOREIGN-KEY（外键）"><a href="#FOREIGN-KEY（外键）" class="headerlink" title="FOREIGN KEY（外键）"></a>FOREIGN KEY（外键）</h4><ol>
<li><p>基本介绍</p>
<ul>
<li><p>用于定义主表和从表之间的关系：<strong>外键约束</strong>要定义在<strong>从表</strong>上，主表则必须具有<strong>主键约束</strong>或是 <code>UNIQUE</code> 约束，当定义外键约束后，要求外键列数据必须在主表的主键列存在或是为 <code>NULL</code></p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">FOREIGN</span> KEY (本表字段名) <span class="hljs-keyword">REFERENCES</span><br>主表名(主键名或 `<span class="hljs-keyword">UNIQUE</span>` 字段名)<br></code></pre></td></tr></table></figure>
</li>
<li><p>外键示意图<br>  <img src="/img/mk-2022-09-16-20-59.png" srcset="/img/loading.gif" lazyload alt="外键示意图"></p>
<ol>
<li>如果把学生表的 <code>class_id</code> 做成外键约束，那么<strong>班级表</strong>中就必须有与之对应的 <code>id</code> 号</li>
<li>比如，如果要在学生表中加入一行，<code>class_id</code> 为 <code>300</code>，因为<strong>班级表</strong>没有 <code>id=300</code> 的班级，就会添加失败</li>
<li>再比如，如果要删除<strong>班级表</strong> <code>id=200</code> 的一行，只能先删除 <code>class_id=200</code> 的所有学生，才能删除 <code>id=200</code> 的班级。而学生表中 <code>class_id=200</code> 的班级中有一个 <code>name=jack</code> 的学生，所以会删除失败</li>
</ol>
</li>
</ul>
</li>
<li><p>应用案例</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 演示外键约束的使用<br><span class="hljs-comment">-- 先创建主表，再创建从表</span><br><span class="hljs-comment">-- 创建主表 my_class</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> my_class (<br>    id <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>, <span class="hljs-comment">-- 班级编号</span><br>    `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>    <span class="hljs-keyword">PRIMARY</span> KEY (id) <span class="hljs-comment">-- 主键约束</span><br>);<br><br><span class="hljs-comment">-- 创建从表 my_stu</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> my_stu (<br>    id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY, <span class="hljs-comment">-- 学生编号</span><br>    `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>    class_id <span class="hljs-type">INT</span>, <span class="hljs-comment">-- 学生所在班级编号</span><br>    <span class="hljs-comment">-- 下面指定外键关系</span><br>    <span class="hljs-keyword">FOREIGN</span> KEY (class_id) <span class="hljs-keyword">REFERENCES</span> my_class(id)<br>);<br><br><span class="hljs-comment">-- 在班级表中添加数据</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> my_class<br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">100</span>, <span class="hljs-string">&#x27;Java&#x27;</span>), (<span class="hljs-number">200</span>, <span class="hljs-string">&#x27;Web&#x27;</span>);<br><br><span class="hljs-comment">-- 在学生表中添加数据</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> my_stu <span class="hljs-comment">-- 成功</span><br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;Tom&#x27;</span>, <span class="hljs-number">100</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> my_stu <span class="hljs-comment">-- 成功</span><br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">2</span>, <span class="hljs-string">&#x27;Jack&#x27;</span>, <span class="hljs-number">200</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> my_stu <span class="hljs-comment">-- 失败，因为 my_class 表中 id=300 的班级不存在</span><br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">3</span>, <span class="hljs-string">&#x27;Mary&#x27;</span>, <span class="hljs-number">300</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> my_stu <span class="hljs-comment">-- 成功，外键没有写 NOT NULL</span><br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">4</span>, <span class="hljs-string">&#x27;King&#x27;</span>, <span class="hljs-keyword">NULL</span>);<br><br><span class="hljs-comment">-- 尝试删除 200 班级</span><br><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> my_class<br>    <span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">=</span> <span class="hljs-number">200</span>; <span class="hljs-comment">-- 删除失败，因为 id=200 班级中有学生</span><br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> my_class;<br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> my_stu;<br></code></pre></td></tr></table></figure>
</li>
<li><p>注意事项与使用细节</p>
<ol>
<li>外键指向的表的字段，要求是 <code>PRIMARY KEY</code> 或者 <code>UNIQUE</code></li>
<li>引擎类型是 <code>InnoDB</code> 的表才支持外键</li>
<li>外键字段的类型要和主键字段的类型一致（长度可以不同）</li>
<li>外键字段的值，必须在主键字段中出现过，或者为 <code>NULL</code>（前提是<strong>外键字段</strong>允许为 <code>NULL</code>）</li>
<li>一旦建立主外键关系，数据就不能随意删除了</li>
</ol>
</li>
</ol>
<h4 id="CHECK"><a href="#CHECK" class="headerlink" title="CHECK"></a>CHECK</h4><ol>
<li><p>基本介绍</p>
<ul>
<li>用于强制行数据必须满足的条件，假定在 <code>sal</code> 列上定义了 <code>check</code> 约束，并要求 <code>sal</code> 列值在 <code>1000~2000</code> 之间，如果不在该范围内就会提示出错</li>
<li><code>oracle</code> 和 <code>sql server</code> 均支持 <code>check</code>，但是 <code>mysql 5.7</code> 目前还不支持 <code>check</code>，只能做语法校检，但<strong>不会生效</strong></li>
<li>基本语法：<code>列名 类型 CHECK (check 条件)</code></li>
</ul>
</li>
<li><p>应用案例</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 演示 <span class="hljs-keyword">check</span> 的使用<br><br><span class="hljs-comment">-- mysql 5.7 目前还不支持 check，只能做语法校检，但不会生效</span><br><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t23 (<br>    id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY,<br>    `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>),<br>    sex <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">6</span>) <span class="hljs-keyword">CHECK</span> (sex <span class="hljs-keyword">IN</span>(<span class="hljs-string">&#x27;man&#x27;</span>, <span class="hljs-string">&#x27;woman&#x27;</span>)),<br>    sal <span class="hljs-keyword">DOUBLE</span> <span class="hljs-keyword">CHECK</span> (sal <span class="hljs-operator">&gt;</span> <span class="hljs-number">1000</span> <span class="hljs-keyword">AND</span> sal <span class="hljs-operator">&lt;</span> <span class="hljs-number">2000</span>)<br>);<br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t23 <span class="hljs-comment">-- 成功，说明 mysql 5.7 中，只做语法校验，不会生效</span><br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;Jack&#x27;</span>, <span class="hljs-string">&#x27;mid&#x27;</span>, <span class="hljs-number">1</span>);<br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t23;<br></code></pre></td></tr></table></figure></li>
</ol>
<h4 id="自增长"><a href="#自增长" class="headerlink" title="自增长"></a>自增长</h4><ol>
<li><p>基本介绍<br>在某张表中，存在一个 <code>id</code> 列（整数），自增长指在添加记录时，该列从 <code>1</code> 开始自动增长</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql">字段名 <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREMENT;<br><br># 添加自增长<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> tab_name (字段<span class="hljs-number">1</span>, 字段<span class="hljs-number">2.</span>..) <span class="hljs-keyword">values</span> (<span class="hljs-keyword">NULL</span>, <span class="hljs-string">&#x27;value&#x27;</span>...);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> tab_name (字段<span class="hljs-number">2.</span>..) <span class="hljs-keyword">values</span> (<span class="hljs-string">&#x27;value&#x27;</span>...);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> tab_name <span class="hljs-keyword">values</span> (<span class="hljs-string">&#x27;value&#x27;</span>...);<br></code></pre></td></tr></table></figure>
</li>
<li><p>应用案例</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 演示自增长的使用<br><br><span class="hljs-comment">-- 创建表</span><br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> t24;<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t24 (<br>    id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREMENT,<br>    email <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>    `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;&#x27;</span><br>);<br><br><span class="hljs-keyword">DESC</span> t24;<br><br><span class="hljs-comment">-- 测试自增长的使用</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t24 (id, email, `name`)<br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-keyword">NULL</span>, <span class="hljs-string">&#x27;jack@qq.com&#x27;</span>, <span class="hljs-string">&#x27;Jack&#x27;</span>);<br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t24 (email, `name`)<br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;tom@qq.com&#x27;</span>, <span class="hljs-string">&#x27;Tom&#x27;</span>);<br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t24<br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-keyword">NULL</span>, <span class="hljs-string">&#x27;mary@qq.com&#x27;</span>, <span class="hljs-string">&#x27;Mary&#x27;</span>);<br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t24;<br></code></pre></td></tr></table></figure>
</li>
<li><p>注意事项与使用细节</p>
<ol>
<li><p>一般来说自增长需要与 <code>PRIMARY KEY</code> 配合使用</p>
</li>
<li><p>自增长也可以单独使用（需要配合 <code>UNIQUE</code>）</p>
</li>
<li><p>自增长修饰的字段大多为整数型（小数也可以，但是使用非常少）</p>
</li>
<li><p>自增长默认从 <code>1</code> 开始，可通过如下命令修改：<code>ALTER TABLE tab_name AUTO_INCREMENT = start_num ;</code></p>
</li>
<li><p>如果自增长字段（列）已有指定的值，则以指定的值为准。如果使用了自增长，一般来说，就按照自增长的规则来添加数据</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 修改默认的自增长开始值</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t25 (<br>    id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREMENT,<br>    email <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>    `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;&#x27;</span><br>);<br><span class="hljs-comment">-- 修改开始值</span><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> t25 AUTO_INCREMENT <span class="hljs-operator">=</span> <span class="hljs-number">100</span>;<br><br><span class="hljs-comment">-- 添加记录</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t25 (id, email, `name`)<br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-keyword">NULL</span>, <span class="hljs-string">&#x27;jack@qq.com&#x27;</span>, <span class="hljs-string">&#x27;Jack&#x27;</span>); <span class="hljs-comment">-- 100</span><br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t25 (email, `name`)<br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;tom@qq.com&#x27;</span>, <span class="hljs-string">&#x27;Tom&#x27;</span>); <span class="hljs-comment">-- 101</span><br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t25<br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-keyword">NULL</span>, <span class="hljs-string">&#x27;mary@qq.com&#x27;</span>, <span class="hljs-string">&#x27;Mary&#x27;</span>); <span class="hljs-comment">-- 102</span><br><br><span class="hljs-comment">-- 赋给自增长字段指定值</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t25<br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">666</span>, <span class="hljs-string">&#x27;king@qq.com&#x27;</span>, <span class="hljs-string">&#x27;King&#x27;</span>); <span class="hljs-comment">-- 666</span><br><br><span class="hljs-comment">-- 再次自增长，会以 666 为开始值</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t25<br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-keyword">NULL</span>, <span class="hljs-string">&#x27;max@qq.com&#x27;</span>, <span class="hljs-string">&#x27;Max&#x27;</span>); <span class="hljs-comment">-- 667</span><br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t25;<br></code></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
<h4 id="商店售货系统表设计案例"><a href="#商店售货系统表设计案例" class="headerlink" title="商店售货系统表设计案例"></a>商店售货系统表设计案例</h4><p>现有一个商店的数据库 <code>shop_db</code>，记录客户及其购物情况，由下面三个表组成：</p>
<ul>
<li>商品表 <code>goods</code>（商品号 <code>goods_id</code>、商品名 <code>goods_name</code>、单价 <code>unit_price</code>、商品类别 <code>category</code>、供应商 <code>provider</code>）</li>
<li>客户表 <code>customer</code>（客户号 <code>customer_id</code>、姓名 <code>name</code>、住址 <code>address</code>、电邮 <code>email</code>、性别 <code>sex</code>、身份证 <code>card_id</code>）</li>
<li>购物信息表 <code>purchase</code>（购买订单号 <code>order_id</code>、客户号 <code>customer_id</code>、商品号 <code>goods_id</code>、购买数量 <code>nums</code>）</li>
</ul>
<p>建表，在定义中要求声明（进行合理设计）：</p>
<ol>
<li>每个表的主外键</li>
<li>客户的姓名不能为空值</li>
<li>电邮不能够重复</li>
<li>客户的性别为：男&#x2F;女</li>
<li>单价 <code>unit_price</code> 在 <code>1.0~9999.99</code> 之间</li>
</ol>
<ul>
<li><p>代码示例</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 商店售货系统表设计案例<br><br><span class="hljs-comment">-- 创建数据库 shop_db</span><br><span class="hljs-keyword">CREATE</span> DATABASE shop_db;<br><br><span class="hljs-comment">-- 使用数据库 shop_db</span><br>USE shop_db;<br><br><span class="hljs-comment">-- 创建主表 goods</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> goods (<br>    good_id <span class="hljs-type">INT</span> UNSIGNED, <span class="hljs-comment">-- 使用无符号，没有负数</span><br>    good_name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">64</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>    unit_price <span class="hljs-type">DECIMAL</span>(<span class="hljs-number">10</span>,<span class="hljs-number">2</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0</span> <br>        <span class="hljs-keyword">CHECK</span> (unit_price <span class="hljs-operator">&gt;=</span> <span class="hljs-number">1.0</span> <span class="hljs-keyword">AND</span> unit_price <span class="hljs-operator">&lt;=</span> <span class="hljs-number">9999.99</span>),<br>    category <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>    provider <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">64</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>    <span class="hljs-keyword">PRIMARY</span> KEY (good_id)<br>);<br><br><span class="hljs-comment">-- 创建主表 customer</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> customer (<br>    customer_id <span class="hljs-type">CHAR</span>(<span class="hljs-number">8</span>),<br>    `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>    address <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">64</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>    email <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">64</span>) <span class="hljs-keyword">UNIQUE</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>    sex ENUM(<span class="hljs-string">&#x27;man&#x27;</span>, <span class="hljs-string">&#x27;woman&#x27;</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>, <span class="hljs-comment">-- 枚举类型</span><br>    card_id <span class="hljs-type">CHAR</span>(<span class="hljs-number">18</span>),<br>    <span class="hljs-keyword">PRIMARY</span> KEY (customer_id)<br>);<br><br><span class="hljs-comment">-- 创建从表 purchase</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> purchase (<br>    order_id <span class="hljs-type">INT</span> UNSIGNED,<br>    customer_id <span class="hljs-type">CHAR</span>(<span class="hljs-number">8</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>    good_id <span class="hljs-type">INT</span> UNSIGNED <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0</span>,<br>    nums <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0</span>,<br>    <span class="hljs-keyword">PRIMARY</span> KEY (order_id),<br>    <span class="hljs-keyword">FOREIGN</span> KEY (customer_id) <span class="hljs-keyword">REFERENCES</span> customer (customer_id),<br>    <span class="hljs-keyword">FOREIGN</span> KEY (good_id) <span class="hljs-keyword">REFERENCES</span> goods(good_id)<br>);<br><br><span class="hljs-keyword">DESC</span> goods;<br><span class="hljs-keyword">DESC</span> customer;<br><span class="hljs-keyword">DESC</span> purchase;<br><br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> purchase;<br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> goods, customer;<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="MySQL-索引【重要】"><a href="#MySQL-索引【重要】" class="headerlink" title="MySQL 索引【重要】"></a>MySQL 索引【重要】</h3><h4 id="索引的介绍"><a href="#索引的介绍" class="headerlink" title="索引的介绍"></a>索引的介绍</h4><h5 id="索引的特点"><a href="#索引的特点" class="headerlink" title="索引的特点"></a>索引的特点</h5><p>索引的基本语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> INDEX index_name <span class="hljs-keyword">ON</span> tab_name (col_name);<br></code></pre></td></tr></table></figure>

<ol>
<li>索引可以显著提高数据库的查询速度，但过度使用索引会降低更新表的速度</li>
<li>索引本身会用占用空间</li>
<li>创建索引后，只对创建了索引的字段（列）有效</li>
</ol>
<h5 id="索引的原理"><a href="#索引的原理" class="headerlink" title="索引的原理"></a>索引的原理</h5><ol>
<li>如果没有创建索引，查询时会进行<strong>全表扫描</strong>，查询速度慢</li>
<li>创建索引后，会形成一个索引的数据结构（比如二叉树），利于检索</li>
<li>索引的磁盘占用空间较大</li>
<li>对 <code>DML(UPDATE, DELETE, INSERT)</code> 语句的效率影响</li>
</ol>
<h4 id="索引的类型"><a href="#索引的类型" class="headerlink" title="索引的类型"></a>索引的类型</h4><ol>
<li><p>主键索引<br> <code>PRIMARY KEY</code> 主键约束，同时也是索引，称为主键索引</p>
</li>
<li><p>唯一索引（UNIQUE）<br> <code>UNIQUE</code> 唯一约束，同时也是 <code>UNIQUE</code> 索引</p>
</li>
<li><p>普通索引（INDEX）</p>
</li>
<li><p>全文索引（FULLTEXT）</p>
<ul>
<li>一般开发，不使用 <code>mysql</code> 自带的全文索引</li>
<li>而是使用，全文搜索 <code>Solr</code> 和 <code>ElasticSearch(ES)</code></li>
</ul>
</li>
<li><p>如何选择索引类型</p>
<ol>
<li>如果某列的值，是不会重复的，则优先考虑使用 <code>UNIQUE</code> 索引，否则使用普通索引</li>
</ol>
</li>
</ol>
<h4 id="索引的使用"><a href="#索引的使用" class="headerlink" title="索引的使用"></a>索引的使用</h4><ol>
<li><p>创建表，查询是否有索引</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 创建表</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t25 (<br>    id <span class="hljs-type">INT</span>,<br>    `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>)<br>);<br>    <br><span class="hljs-comment">-- 查询表是否有索引</span><br><span class="hljs-keyword">SHOW</span> INDEXES <span class="hljs-keyword">FROM</span> t25;<br></code></pre></td></tr></table></figure>
</li>
<li><p>添加索引</p>
<ul>
<li><p>添加唯一索引</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 方式 <span class="hljs-number">1</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `t25` (<br>    `id` <span class="hljs-type">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,<br>    `name` <span class="hljs-type">varchar</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,<br>    <span class="hljs-keyword">UNIQUE</span> KEY `id_index` (`id`) <span class="hljs-comment">-- 添加唯一索引</span><br>);<br><br># 方式 <span class="hljs-number">2</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">UNIQUE</span> INDEX id_index <span class="hljs-keyword">ON</span> t25 (id);<br><br># 方式 <span class="hljs-number">3</span><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> t25 <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">UNIQUE</span> INDEX id_index (id);<br></code></pre></td></tr></table></figure>
</li>
<li><p>添加普通索引</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 方式 <span class="hljs-number">1</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `t25` (<br>    `id` <span class="hljs-type">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,<br>    `name` <span class="hljs-type">varchar</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,<br>    KEY `name_index` (`name`) <span class="hljs-comment">-- 添加普通索引</span><br>);<br><br># 方式 <span class="hljs-number">2</span><br><span class="hljs-keyword">CREATE</span> INDEX id_index <span class="hljs-keyword">ON</span> t25 (id);<br><br># 方式 <span class="hljs-number">3</span><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> t25 <span class="hljs-keyword">ADD</span> INDEX id_index (id);<br></code></pre></td></tr></table></figure>
</li>
<li><p>添加主键索引</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 方式 <span class="hljs-number">1</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `t25` (<br>    `id` <span class="hljs-type">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,<br>    `name` <span class="hljs-type">varchar</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,<br>    <span class="hljs-keyword">PRIMARY</span> KEY (`id`) <span class="hljs-comment">-- 添加主键索引</span><br>);<br><br># 方式 <span class="hljs-number">2</span><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> t25 <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">PRIMARY</span> KEY (id);<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>删除索引</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 删除索引</span><br><span class="hljs-keyword">DROP</span> INDEX id_index <span class="hljs-keyword">ON</span> t25;<br><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> t25 <span class="hljs-keyword">DROP</span> INDEX id_index;<br><br><span class="hljs-comment">-- 删除主键索引（删除主键）</span><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> t25 <span class="hljs-keyword">DROP</span> <span class="hljs-keyword">PRIMARY</span> KEY;<br></code></pre></td></tr></table></figure>
</li>
<li><p>查询索引</p>
<ol>
<li><p>方式 1</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SHOW</span> INDEX <span class="hljs-keyword">FROM</span> t25;<br></code></pre></td></tr></table></figure>
</li>
<li><p>方式 2</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SHOW</span> INDEXES <span class="hljs-keyword">FROM</span> t25;<br></code></pre></td></tr></table></figure>
</li>
<li><p>方式 3</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SHOW</span> KEYS <span class="hljs-keyword">FROM</span> t25;<br></code></pre></td></tr></table></figure>
</li>
<li><p>方式 4</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DESC</span> t25; <span class="hljs-comment">-- 不详细</span><br></code></pre></td></tr></table></figure></li>
</ol>
</li>
<li><p>应用案例</p>
<ol>
<li><p>创建一张订单表 <code>order (id, 商品名(name), 订购人(buyer), 数量(nums))</code>，要求 <code>id</code> 为主键，请使用两种方式来创建索引</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `<span class="hljs-keyword">order</span>` (<br>    id <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0</span>,<br>    `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>    buyer <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>    nums <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0</span><br>    <span class="hljs-comment">-- primary key (id)</span><br>);<br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> `<span class="hljs-keyword">order</span>` <span class="hljs-keyword">DROP</span> <span class="hljs-keyword">PRIMARY</span> KEY;<br><br><span class="hljs-comment">-- 方式 2</span><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> `<span class="hljs-keyword">order</span>` <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">PRIMARY</span> KEY (id);<br><br><span class="hljs-keyword">SHOW</span> INDEX <span class="hljs-keyword">FROM</span> `<span class="hljs-keyword">order</span>`;<br></code></pre></td></tr></table></figure>
</li>
<li><p>创建一张特价菜谱表 <code>menu (id, 菜谱名(name), 厨师(chef), 顾客身份证号(customer_card), price)</code>，要求 <code>id</code> 为主键，顾客身份证号为 <code>unique</code>，请使用三种方式来创建 <code>unique</code> 索引</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> menu (<br>    id <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,<br>    `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,<br>    chef <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,<br>    customer_card <span class="hljs-type">CHAR</span>(<span class="hljs-number">18</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,<br>    <span class="hljs-keyword">UNIQUE</span> KEY card_index (customer_card),<br>    <span class="hljs-keyword">PRIMARY</span> KEY (id)<br>);<br><span class="hljs-keyword">SHOW</span> INDEX <span class="hljs-keyword">FROM</span> menu;<br><br><span class="hljs-comment">-- 删除索引</span><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> menu <span class="hljs-keyword">DROP</span> INDEX card_index;<br><br><span class="hljs-comment">-- 创建唯一索引</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">UNIQUE</span> INDEX card_index <span class="hljs-keyword">ON</span> menu (customer_card);<br><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> menu <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">UNIQUE</span> INDEX card_index (customer_card);<br></code></pre></td></tr></table></figure>
</li>
<li><p>创建一张运动员表 <code>sportsman (id, name, 爱好(hobby))</code>，要求 <code>id</code> 为主键，名字为普通索引，请使用三种方式来创建索引</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> sportsman (<br>    id <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,<br>    `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,<br>    hobby <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,<br>    <span class="hljs-keyword">PRIMARY</span> KEY (id),<br>    KEY id_index (id)<br>);<br><br><span class="hljs-keyword">DROP</span> INDEX id_index <span class="hljs-keyword">ON</span> sportsman;<br><br><span class="hljs-keyword">CREATE</span> INDEX id_index <span class="hljs-keyword">ON</span> sportsman (id);<br><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> sportsman <span class="hljs-keyword">ADD</span> INDEX id_index (id);<br></code></pre></td></tr></table></figure></li>
</ol>
</li>
<li><p>索引小结</p>
<ul>
<li>哪些列上适合使用索引：<ol>
<li>较频繁的作为查询条件字段应该创建索引<ul>
<li><code>SELECT * FROM EMP WHERE emp_no = 1;</code></li>
</ul>
</li>
<li>唯一性太差的字段不适合单独创建索引，即使频繁作为查询条件<ul>
<li><code>SELECT * FROM emp WHERE sex = &#39;男&#39;;</code></li>
</ul>
</li>
<li>更新非常频繁的字段不适合创建索引<ul>
<li><code>SELECT * FROM emp WHERE login_count = 1;</code></li>
</ul>
</li>
<li>不会出现在 WHERE 子句中字段不该创建索引</li>
</ol>
</li>
</ul>
</li>
</ol>
<h3 id="MySQL-事务"><a href="#MySQL-事务" class="headerlink" title="MySQL 事务"></a>MySQL 事务</h3><h4 id="事务管理"><a href="#事务管理" class="headerlink" title="事务管理"></a>事务管理</h4><h5 id="什么是事务"><a href="#什么是事务" class="headerlink" title="什么是事务"></a>什么是事务</h5><p>事务用于保证<strong>数据的一致性</strong>，它由一组相关的 <code>dml</code> 语句组成，该组的 <code>dml</code> 语句要么全部成功，要么全部失败。如：转账就要用事务来处理，用以保证数据的一致性。</p>
<p><img src="/img/mk-2022-09-20-10-04.png" srcset="/img/loading.gif" lazyload alt="事务操作示意图"></p>
<h5 id="事务和锁"><a href="#事务和锁" class="headerlink" title="事务和锁"></a>事务和锁</h5><p>当执行事务操作时（<code>dml</code> 语句），<code>mysql</code> 会在表上加锁，防止其他用户该表的数据，这对用户来讲是非常重要的</p>
<h5 id="事务基本操作"><a href="#事务基本操作" class="headerlink" title="事务基本操作"></a>事务基本操作</h5><ul>
<li><p><code>mysql</code> 数据库控制台事务的几个重要操作：</p>
<table>
<thead>
<tr>
<th align="left">语法</th>
<th align="left">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>start transaction</code></td>
<td align="left">开始一个事务</td>
</tr>
<tr>
<td align="left"><code>savepoint 保存点名</code></td>
<td align="left">设置保存点</td>
</tr>
<tr>
<td align="left"><code>rollback to 保存点名</code></td>
<td align="left">回退事务</td>
</tr>
<tr>
<td align="left"><code>rollback</code></td>
<td align="left">回退全部事务</td>
</tr>
<tr>
<td align="left"><code>commit</code></td>
<td align="left">提交事务，所有的操作生效，不能回退</td>
</tr>
</tbody></table>
</li>
<li><p>保存点 (<code>savepoint</code>) 是事务中的点，用于取消部分事务。当结束事务时 (<code>commit</code>)，会自动的删除该事务所定义的所有保存点，当执行回退事务时，通过指定保存点可以回退到指定的点</p>
</li>
<li><p>使用 <code>commit</code> 语句可以提交事务。当执行了 <code>commit</code> 语句子后，会确认事务的变化、结束事务、删除保存点、释放锁，数据生效。当使用 <code>commit</code> 语句结束事务子后，其它会话（其他连接）将可以查看到事务变化后的新数据（所有数据就正式生效）</p>
</li>
</ul>
<h5 id="事务注意事项与使用细节"><a href="#事务注意事项与使用细节" class="headerlink" title="事务注意事项与使用细节"></a>事务注意事项与使用细节</h5><ol>
<li>如果不开始事务，默认情况下，<code>dml</code> 操作是自动提交的，不能回滚</li>
<li>当开始一个事务时，会自动创建一个默认保存点，执行 <code>rollback</code> 回退到事务开始的状态</li>
<li>可以在事务中（还没有提交时），创建多个保存点，比如：<code>savepoint aaa; 执行 dml; savepoint bbb;</code></li>
<li>在事务没有提交前，可以选择回退到哪个保存点.</li>
<li><code>mysql</code> 的事务机制需要 <code>innodb</code> 的存储引擎才可以使用，<code>MyISAM</code> 不支持事务</li>
<li>开始一个事务 <code>start transaction</code>，或者 <code>set autocommit = off</code></li>
</ol>
<h4 id="隔离级别"><a href="#隔离级别" class="headerlink" title="隔离级别"></a>隔离级别</h4><h5 id="事务隔离级别介绍"><a href="#事务隔离级别介绍" class="headerlink" title="事务隔离级别介绍"></a>事务隔离级别介绍</h5><ol>
<li><p>什么是事务隔离级别<br> 多个连接开启各自事务操作数据库中数据时，数据库系统要负责隔离操作，以保证各个连接在获取数据时的准确性。<code>MySQL</code> 隔离级别定义了<strong>事务与事务之间的隔离程度</strong>，每个开启的事务都是独立的。</p>
</li>
<li><p>如果不考虑隔离性，可能会引发如下问题：</p>
<ul>
<li>脏读 (<code>dirty read</code>)：当一个事务读取另一个事务<strong>尚未提交</strong>的操作时，产生脏读<br>  <img src="/img/mk-2022-09-21-10-24.png" srcset="/img/loading.gif" lazyload alt="脏读"></li>
<li>不可重复读 <code>(nonrepeatable read)</code>：不可重复读是指一个事务先后执行同一条 SQL，但两次读取到的数据不同，就是不可重复读。<br>  <img src="/img/mk-2022-09-21-10-32.png" srcset="/img/loading.gif" lazyload alt="不可重复读"><ul>
<li>不可重复读和脏读的区别：脏读可以读到其他事务中未提交的数据，而不可重复读是读取到了其他事务已经提交的数据，但前后两次读取的结果不同</li>
</ul>
</li>
<li>幻读 <code>(phantom read)</code>：<code>事务A</code> 在执行读取操作，需要两次统计数据的总量，前一次查询数据总量后，此时 <code>事务B</code> 执行了新增数据的操作并提交后，这个时候 <code>事务A</code> 读取的数据总量和之前统计的不一样，就像产生了幻觉一样，平白无故的多了几条数据，成为幻读。<br>  <img src="/img/mk-2022-09-21-10-31.png" srcset="/img/loading.gif" lazyload alt="幻读"><ul>
<li>不可重复读与幻读的区别<ul>
<li>不可重复读是读取了其他事务更改的数据，针对 <code>update</code> 操作</li>
<li>幻读是读取了其他事务新增的数据，针对 <code>insert</code> 和 <code>delete</code> 操作</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<h5 id="4-种隔离级别"><a href="#4-种隔离级别" class="headerlink" title="4 种隔离级别"></a>4 种隔离级别</h5><table>
<thead>
<tr>
<th align="left">MySQL 隔离级别（4种）</th>
<th align="left">脏读</th>
<th align="left">不可重复读</th>
<th align="left">幻读</th>
<th align="left">加锁读</th>
</tr>
</thead>
<tbody><tr>
<td align="left">读未提交（Read Uncommitted）</td>
<td align="left">✓</td>
<td align="left">✓</td>
<td align="left">✓</td>
<td align="left">不加锁</td>
</tr>
<tr>
<td align="left"><strong>读已提交（Read Committed）</strong></td>
<td align="left">✕</td>
<td align="left">✓</td>
<td align="left">✓</td>
<td align="left">不加锁</td>
</tr>
<tr>
<td align="left">可重复读（Repeatable Read）</td>
<td align="left">✕</td>
<td align="left">✕</td>
<td align="left">✕</td>
<td align="left">不加锁</td>
</tr>
<tr>
<td align="left"><strong>可串行化（Serializable）</strong></td>
<td align="left">✕</td>
<td align="left">✕</td>
<td align="left">✕</td>
<td align="left"><strong>加锁</strong></td>
</tr>
</tbody></table>
<ul>
<li><p>说明：✓ 可能出现，✕ 不会出现</p>
</li>
<li><p>默认级别为 <strong>可重复读</strong></p>
</li>
<li><p>演示 <code>MySQL</code> 中的<strong>脏读</strong></p>
<ol>
<li><p>启动两个 <code>MySQL</code> 控制台</p>
</li>
<li><p>查看当前 <code>MySQL</code> 的隔离级别</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">SELECT</span> @<span class="hljs-variable">@tx</span>_isolation<br><span class="hljs-comment">-- MySQL 8: SELECT @@transaction_isolation;</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-----------------+</span><br><span class="hljs-operator">|</span> @<span class="hljs-variable">@tx</span>_isolation  <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-----------------+</span><br><span class="hljs-operator">|</span> REPEATABLE<span class="hljs-operator">-</span>READ <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">-----------------+</span><br><br><span class="hljs-number">1</span> <span class="hljs-type">row</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span>, <span class="hljs-number">1</span> warning (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure>
</li>
<li><p>把 <code>控制台2</code> 的隔离级别设置为 <code>Read Uncommitted</code></p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">SET</span> SESSION TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;<br><br>Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">0.00</span> sec)<br><br><span class="hljs-comment">-- 查看隔离级别</span><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">SELECT</span> @<span class="hljs-variable">@tx</span>_isolation;<br><span class="hljs-operator">+</span><span class="hljs-comment">------------------+</span><br><span class="hljs-operator">|</span> @<span class="hljs-variable">@tx</span>_isolation   <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------------------+</span><br><span class="hljs-operator">|</span> READ<span class="hljs-operator">-</span>UNCOMMITTED <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------------------+</span><br><span class="hljs-number">1</span> <span class="hljs-type">row</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span>, <span class="hljs-number">1</span> warning (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure>
</li>
<li><p>在两个控制台中启动事务</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">START</span> TRANSACTION;<br><br>Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure>
</li>
<li><p>在 <code>控制台1</code> 中创建表并添加数据</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `account` (<br>    <span class="hljs-operator">-</span><span class="hljs-operator">&gt;</span>     `id` <span class="hljs-type">INT</span>,<br>    <span class="hljs-operator">-</span><span class="hljs-operator">&gt;</span>     `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>),<br>    <span class="hljs-operator">-</span><span class="hljs-operator">&gt;</span>     `money` <span class="hljs-type">INT</span><br>    <span class="hljs-operator">-</span><span class="hljs-operator">&gt;</span> );<br>Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">0.04</span> sec)<br><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> account <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">100</span>, <span class="hljs-string">&#x27;tom&#x27;</span>, <span class="hljs-number">1000</span>);<br><br>Query OK, <span class="hljs-number">1</span> <span class="hljs-type">row</span> affected (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure>
</li>
<li><p>在 <code>控制台2</code> 尝试读取表的内容</p>
<ul>
<li>由于 <code>控制台2</code> 读取到了 <code>控制台1</code> 未提交的数据，所以产生了<strong>脏读</strong></li>
</ul>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> account;<br><span class="hljs-operator">+</span><span class="hljs-comment">------+------+-------+</span><br><span class="hljs-operator">|</span> id   <span class="hljs-operator">|</span> name <span class="hljs-operator">|</span> money <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------+------+-------+</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">100</span> <span class="hljs-operator">|</span> tom  <span class="hljs-operator">|</span>  <span class="hljs-number">1000</span> <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------+------+-------+</span><br><span class="hljs-number">1</span> <span class="hljs-type">row</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure></li>
</ol>
</li>
</ul>
<h5 id="设置隔离级别"><a href="#设置隔离级别" class="headerlink" title="设置隔离级别"></a>设置隔离级别</h5><ul>
<li>查看当前会话隔离级别<ul>
<li><code>SELECT @@tx_isolation</code></li>
<li><code>SELECT @@transaction_isolation; (MySQL 8)</code></li>
</ul>
</li>
<li>查看系统当前隔离级别<ul>
<li><code>SELECT @@global.tx_isolation</code></li>
</ul>
</li>
<li>设置当前会话隔离级别<ul>
<li><code>SET SESSION TRANSACTION ISOLATION LEVEL 隔离级别</code></li>
</ul>
</li>
<li>设置系统当前隔离级别<ul>
<li><code>SET GLOBAL TRANSACTION ISOLATION LEVEL 隔离级别</code></li>
</ul>
</li>
<li>修改默认隔离级别<ul>
<li><p>MySQL 默认的事务隔离级别是 <code>REPEATABLE READ</code>，一般情况下，没有特殊要求，没有必要修改，（因为该级别可以满足大部分项目需求）</p>
</li>
<li><p>全局修改，修改 <code>my.ini</code> 配置文件，在最后加上。</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-comment"># 可选参数有：READ-UNCOMMITTED, READ-COMMITTED, REPEATABLE-READ, SERIALIZABLE</span><br><span class="hljs-section">[mysqld]</span><br><span class="hljs-attr">transaction-isolation</span>=REPEATABLE-READ<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h5 id="事务隔离级别课堂练习"><a href="#事务隔离级别课堂练习" class="headerlink" title="事务隔离级别课堂练习"></a>事务隔离级别课堂练习</h5><ol>
<li>登录 <code>mysql</code> 控制客户端A，创建表 <code>dog(id,name)</code>，开始一个事务，添加两条记录</li>
<li>登录 <code>mysql</code> 控制客户端B，开始一个事务，设置为<strong>读未提交</strong></li>
<li>A客户端修改 <code>dog</code> 一条记录，不要提交。看看B客户端是否看到变化</li>
<li>登录 <code>mysql</code> 客户端C，开始一个事务，设置为读已提交，这时A客户修改一条记录，不要提交，看看 <code>客户端C</code> 是否看到变化</li>
</ol>
<table>
<thead>
<tr>
<th align="left">时间</th>
<th align="left">客户端 A</th>
<th align="left">客户端 B</th>
<th align="left">客户端 C</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left">创建表 <code>dog</code>，开启事务</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">添加两条记录</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">3</td>
<td align="left"></td>
<td align="left">设置为<strong>读未提交</strong></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">4</td>
<td align="left">修改一条记录，不提交</td>
<td align="left">尝试查询记录，可以读到 <code>dog</code> 修改后内容</td>
<td align="left"></td>
<td align="left">客户端B 产生脏读</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left">修改一条记录，不提交</td>
<td align="left"></td>
<td align="left">开始事务，设置为读已提交</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">6</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">查询 <code>dog</code> 记录，无法读到 <code>dog</code> 内容，为空表</td>
<td align="left">没有脏读</td>
</tr>
</tbody></table>
<h4 id="事务的-ACID-特性"><a href="#事务的-ACID-特性" class="headerlink" title="事务的 ACID 特性"></a>事务的 ACID 特性</h4><ol>
<li>原子性 (Atomicity)<br> 原子性是指事务是一个不可分割的工作单位，事务中的操作要么都发生，要么都不发生。</li>
<li>一致性 (Consistency)<br> 事务必须使数据库从一个一致性状态变换到另外一个一致性状态。</li>
<li>隔离性 (Isolation)<br> 事务的隔离性是多个用户并发访问数据库时，数据库为<strong>每一个用户</strong>开启的事务，<strong>不能被其他事务的操作数据所干扰</strong>，多个并发事务之间要相互隔离。</li>
<li>持久性 (Durability)<br> 持久性是指一个事务<strong>一旦被提交</strong>，它对数据库中数据的改变就是<strong>永久性</strong>的接下来即使数据库发生故障也不应该对其有任何影响。</li>
</ol>
<h3 id="MySQL-表类型和存储引擎"><a href="#MySQL-表类型和存储引擎" class="headerlink" title="MySQL 表类型和存储引擎"></a>MySQL 表类型和存储引擎</h3><h4 id="存储引擎基本介绍"><a href="#存储引擎基本介绍" class="headerlink" title="存储引擎基本介绍"></a>存储引擎基本介绍</h4><ol>
<li><p>MySQL 的表类型由存储引擎 (Storage Engines) 决定，主要包括 <code>MyISAM、innoDB、Memory</code> 等</p>
</li>
<li><p>MySQL 数据表主要支持六种类型，分别是：<code>CSV、Memory、ARCHIVE、MRG MYISAM、MYISAM、InnoDB</code></p>
</li>
<li><p>这六种又分为两类：</p>
<ul>
<li>一类是「事务安全型」(transaction-safe)，比如：<code>InnoDB</code></li>
<li>其余都属于第二类，称为「非事务安全型」(non-transaction-safe)，比如：<code>MyISAM</code> 和 <code>Memory</code></li>
</ul>
</li>
<li><p>查看所有的存储引擎</p>
<ul>
<li><p><code>SHOW ENGINES</code></p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs doc">mysql&gt; show engines;<br>+--------------------+---------+----------------------------------------------------------------+--------------+------+------------+<br>| Engine             | Support | Comment                                                        | Transactions | XA   | Savepoints |<br>+--------------------+---------+----------------------------------------------------------------+--------------+------+------------+<br>| InnoDB             | DEFAULT | Supports transactions, row-level locking, and foreign keys     | YES          | YES  | YES        |<br>| MRG_MYISAM         | YES     | Collection of identical MyISAM tables                          | NO           | NO   | NO         |<br>| MEMORY             | YES     | Hash based, stored in memory, useful for temporary tables      | NO           | NO   | NO         |<br>| BLACKHOLE          | YES     | /dev/null storage engine (anything you write to it disappears) | NO           | NO   | NO         |<br>| MyISAM             | YES     | MyISAM storage engine                                          | NO           | NO   | NO         |<br>| CSV                | YES     | CSV storage engine                                             | NO           | NO   | NO         |<br>| ARCHIVE            | YES     | Archive storage engine                                         | NO           | NO   | NO         |<br>| PERFORMANCE_SCHEMA | YES     | Performance Schema                                             | NO           | NO   | NO         |<br>| FEDERATED          | NO      | Federated MySQL storage engine                                 | NULL         | NULL | NULL       |<br>+--------------------+---------+----------------------------------------------------------------+--------------+------+------------+<br>9 rows in set (0.00 sec)<br></code></pre></td></tr></table></figure>
</li>
<li><p>存储引擎介绍</p>
<table>
<thead>
<tr>
<th align="left">存储引擎</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">ARCHIVE</td>
<td align="left">用于数据存档的引擎，数据被插入后就不能在修改了，且不支持索引</td>
</tr>
<tr>
<td align="left">CSV</td>
<td align="left">在存储数据时，会以逗号作为数据项之间的分隔符</td>
</tr>
<tr>
<td align="left">BLACKHOLE</td>
<td align="left">会丢弃写操作，该操作会返回空内容</td>
</tr>
<tr>
<td align="left">FEDERATED</td>
<td align="left">将数据存储在远程数据库中，用来访问远程表的存储引擎。</td>
</tr>
<tr>
<td align="left">InnoDB</td>
<td align="left">具备外键支持功能的事务处理引擎</td>
</tr>
<tr>
<td align="left">MEMORY</td>
<td align="left">置于内存的表</td>
</tr>
<tr>
<td align="left">MERGE</td>
<td align="left">用来管理由多个 <code>MyISAM</code> 表构成的表集合</td>
</tr>
<tr>
<td align="left">MyISAM</td>
<td align="left">主要的非事务处理存储引擎</td>
</tr>
<tr>
<td align="left">NDB</td>
<td align="left"><code>MySQL</code> 集群专用存储引擎</td>
</tr>
</tbody></table>
</li>
</ul>
</li>
<li><p>主要的存储引擎&#x2F;表类型特点<br> <img src="/img/mk-2022-09-22-20-31.png" srcset="/img/loading.gif" lazyload alt="主要的存储引擎特点"></p>
</li>
<li><p>修改存储引擎</p>
<ul>
<li><code>ALTER TABLE 表名 ENGINE = 存储引擎;</code></li>
</ul>
</li>
</ol>
<h4 id="三种最常用的存储引擎"><a href="#三种最常用的存储引擎" class="headerlink" title="三种最常用的存储引擎"></a>三种最常用的存储引擎</h4><ol>
<li><p>基本介绍</p>
<ol>
<li><code>MyISAM</code> 不支持事务、也不支持外键，但其<strong>访问速度快</strong>，对事务完整性没有要求。特点如下：<ol>
<li>添加速度快</li>
<li>不支持外键和事务</li>
<li>表级锁</li>
</ol>
</li>
<li><code>InnoDB</code> 存储引擎提供了具有提交、回滚和崩溃恢复能力的事务安全。但是比起 <code>MyISAM</code> 存储引擎，<code>InnoDB</code> 写的处理效率差一些并且会占用<strong>更多的磁盘空间</strong>以保留数据和索引。特点如下：<ol>
<li>支持事务</li>
<li>支持外键</li>
<li>支持行级锁</li>
</ol>
</li>
<li><code>MEMORY</code> 存储引擎使用存在<strong>内存</strong>中的内容来创建表。每个 <code>MEMORY</code> 表只实际对应一个磁盘文件。<code>MEMORY</code> 类型的表<strong>访问非常得快</strong>，因为它的数据是<strong>放在内存中</strong>的，并且默认使用 <code>HASH</code> 索引。但是 <code>MySQL</code> 服务一旦关闭，<strong>表中的数据就会丢失</strong>掉（<strong>表的结构</strong>还在）。适用于经常操作，但不需要持久化的数据。特点如下：<ol>
<li>数据存储在内存中</li>
<li>执行速度很快（没有 IO 读写）</li>
<li>默认支持索引（基于 HASH 表）</li>
</ol>
</li>
</ol>
</li>
<li><p>应用案例</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 表类型和存储引擎<br><br><span class="hljs-comment">-- 查看索引存储引擎</span><br><span class="hljs-keyword">SHOW</span> ENGINES;<br><br># 演示三种常用的存储引擎<br><br><span class="hljs-comment">-- InnoDB 存储引擎</span><br><span class="hljs-comment">-- 1.支持事务 2.支持外键 3.支持行级锁</span><br><br><span class="hljs-comment">-- MyISAM 存储引擎</span><br><span class="hljs-comment">-- 1.添加速度快 2.不支持外键和事务 3.表级锁</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t28 (<br>    id <span class="hljs-type">INT</span>,<br>    `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>)<br>) ENGINE MYISAM;<br><br><span class="hljs-keyword">START</span> TRANSACTION; <span class="hljs-comment">-- 开始事务</span><br><span class="hljs-keyword">SAVEPOINT</span> t1; <span class="hljs-comment">-- 设置保存点</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t28 <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;jack&#x27;</span>); <span class="hljs-comment">-- 添加数据</span><br><span class="hljs-keyword">ROLLBACK</span> <span class="hljs-keyword">TO</span> t1; <span class="hljs-comment">-- 回滚失败</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t28; <span class="hljs-comment">-- 查询仍然有数据</span><br><br><span class="hljs-comment">-- MEMORY 存储引擎</span><br><span class="hljs-comment">-- 1.数据存储在内存中 2.执行速度很快（没有 IO 读写） 3.默认支持索引（hash 表）</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t29 (<br>    id <span class="hljs-type">INT</span>,<br>    `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>)<br>)ENGINE MEMORY;<br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t29<br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>,<span class="hljs-string">&#x27;tom&#x27;</span>), (<span class="hljs-number">2</span>,<span class="hljs-string">&#x27;jack&#x27;</span>), (<span class="hljs-number">3</span>,<span class="hljs-string">&#x27;mary&#x27;</span>);<br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t29;<br><br><span class="hljs-comment">-- 关闭 MySQL 服务后，表数据丢失，但是表结构无影响</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>如何选择存储引擎</p>
<ol>
<li>如果你的应用不需要事务，处理的只是基本的 <code>CRUD</code> 操作，那么 <code>MyISAM</code> 是不二选择，速度快。</li>
<li>如果需要支持事务，选择 <code>InnoDB</code>。</li>
<li><code>Memory</code> 存储引擎就是将数据存储在内存中，由于没有磁盘 I&#x2F;O 的等待，速度极快。但由于是内存存储引擎，所做的任何修改在服务器重启后都将消失。（经典用法：用户的在线状态）。</li>
</ol>
</li>
</ol>
<h3 id="MySQL-视图"><a href="#MySQL-视图" class="headerlink" title="MySQL 视图"></a>MySQL 视图</h3><h4 id="视图的概念"><a href="#视图的概念" class="headerlink" title="视图的概念"></a>视图的概念</h4><ol>
<li><p>视图是一个虚拟表，其内容由查询定义。同真实的表一样，试图包含列，<strong>其数据来自对应的真实表</strong>（基表）</p>
</li>
<li><p>视图和基表关系示意图<br>  <img src="/img/mk-2022-09-23-14-50.png" srcset="/img/loading.gif" lazyload alt="视图和基表关系"></p>
</li>
<li><p>对视图的总结</p>
<ol>
<li>视图是根据基表（可以是多个基表）来创建的视图是虚拟的表</li>
<li>视图也有列，数据来自基表</li>
<li>通过视图可以修改基表的数据</li>
<li>基表的改变，也会影响到视图的数据</li>
</ol>
</li>
</ol>
<h4 id="视图的使用"><a href="#视图的使用" class="headerlink" title="视图的使用"></a>视图的使用</h4><ol>
<li><p>基本语法</p>
<ul>
<li>创建视图：<code>create view 视图名 as select语句</code></li>
<li>修改视图：<code>alter view 视图名 as select语句</code></li>
<li>查询视图创建方式：<code>show create view 视图名</code></li>
<li>查询视图：<code>select * from 视图名</code></li>
<li>删除视图：<code>drop view 视图名1, 视图名2</code></li>
</ul>
</li>
<li><p>完成需求</p>
<ul>
<li><p>创建一个视图 <code>emp_view01</code>，要求只能查询 <code>emp</code> 表的 <code>emp_no, e_name, job</code> 和 <code>dept_no</code> 信息</p>
</li>
<li><p>修改视图，查看变化</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 演示视图的使用<br><br><span class="hljs-comment">-- 创建视图，该表的基表为 emp</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">VIEW</span> emp_view01 <br>    <span class="hljs-keyword">AS</span> <br>    <span class="hljs-keyword">SELECT</span> emp_no, e_name, job, dept_no <br>    <span class="hljs-keyword">FROM</span> emp;<br><br><span class="hljs-keyword">SHOW</span> <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">VIEW</span> emp_view01;<br><br><span class="hljs-comment">-- 查询视图数据</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> emp_view01;<br><br><span class="hljs-comment">-- 查询视图结构</span><br><span class="hljs-keyword">DESC</span> emp_view01;<br><br><span class="hljs-comment">-- 修改视图，同时会修改基表数据</span><br><span class="hljs-keyword">UPDATE</span> emp_view01<br>    <span class="hljs-keyword">SET</span> job <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;MANAGER&#x27;</span><br>    <span class="hljs-keyword">WHERE</span> emp_no <span class="hljs-operator">=</span> <span class="hljs-number">7369</span>;<br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> emp_view01;<br><br><span class="hljs-comment">-- 视图的数据变化会影响到基表，基表的变化也会影响到视图</span><br><span class="hljs-keyword">UPDATE</span> emp<br>    <span class="hljs-keyword">SET</span> job <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;SALESMAN&#x27;</span><br>    <span class="hljs-keyword">WHERE</span> emp_no <span class="hljs-operator">=</span> <span class="hljs-number">7369</span>;<br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> emp;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>注意事项与使用细节</p>
<ol>
<li><p>创建视图后，数据库目录中对应视图只有一个视图结构文件（形式：视图名.frm）</p>
</li>
<li><p>视图的数据变化会影响到基表，基表的数据变化也会影响到视图</p>
</li>
<li><p>视图中可以再使用视图，数据仍然来自基表</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">VIEW</span> emp_view02<br>    <span class="hljs-keyword">AS</span><br>    <span class="hljs-keyword">SELECT</span> emp_no, e_name <br>    <span class="hljs-keyword">FROM</span> emp_view01;<br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> emp_view02;<br></code></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
<h4 id="视图的应用"><a href="#视图的应用" class="headerlink" title="视图的应用"></a>视图的应用</h4><ol>
<li><p>视图最佳实践</p>
<ol>
<li><strong>安全</strong>。一些数据表有着重要的信息。有些字段是保密的，不能让用户直接看到。这时就可以创建一个视图，在这张视图中只保留一部分字段。这样，用户就可以查询自己需要的字段，不能查看保密的字段。</li>
<li><strong>性能</strong>。关系数据库的数据常常会分表存储，使用外键建立这些表的之间关系。这时，数据库查询通常会用到连接 (<code>JOIN</code>)。这样做不但麻烦，效率相对也比较低。如果建立一个视图，将相关的表和字段组合在一起，就可以避免使用 <code>JOIN</code> 查询数据。</li>
<li><strong>灵活</strong>。如果系统中有一张旧的表，这张表由于设计的问题，即将被废弃。然而，很多应用都是基于这张表，不易修改。这时就可以建立一张视图，视图中的数据直接映射到新建的表。这样，就可以少做很多改动，也达到了升级数据表的目的。</li>
</ol>
</li>
<li><p>视图应用案例</p>
<ul>
<li><p>针对 <code>emp, dept</code> 和 <code>sal_grade</code> 三张表，创建一个视图 <code>emp_view03</code>，可以显示雇员编号，雇员名，雇员部门名称和薪水级别</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 视图应用案例<br><span class="hljs-comment">-- 使用三表联合查询（内连接）</span><br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> emp;<br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> dept;<br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> sal_grade;<br><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">VIEW</span> emp_view03 <br>    <span class="hljs-keyword">AS</span><br>    <span class="hljs-keyword">SELECT</span> emp_no, e_name, d_name, grade<br>    <span class="hljs-keyword">FROM</span> emp, dept, sal_grade<br>    <span class="hljs-keyword">WHERE</span> emp.dept_no <span class="hljs-operator">=</span> dept.dept_no <br>    <span class="hljs-keyword">AND</span> (sal <span class="hljs-keyword">BETWEEN</span> lo_sal <span class="hljs-keyword">AND</span> hi_sal);<br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> emp_view03;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<h3 id="MySQL-管理"><a href="#MySQL-管理" class="headerlink" title="MySQL 管理"></a>MySQL 管理</h3><h4 id="MySQL-用户"><a href="#MySQL-用户" class="headerlink" title="MySQL 用户"></a>MySQL 用户</h4><p>当我们做项目开发时，可以根据不同的开发人员，赋予相应的 <code>MySQL</code> 操作权限。所以，<code>MySQL</code> 数据库管理员 (<code>root</code>) 根据需要创建不同的用户，赋予相应的权限，供其他人员使用</p>
<ul>
<li><p>MySQL 中的用户，都存储在系统数据库 <code>mysql</code> 中的 <code>user</code> 表中<br>  <img src="/img/mk-2022-09-25-10-16.png" srcset="/img/loading.gif" lazyload alt="user 表"></p>
<ul>
<li><code>host</code>: 允许登录的位置，<code>localhost</code> 表示该用户只允许本机登录，也可以指定 <code>ip</code> 地址，比如：<code>192.168.1.100</code></li>
<li><code>user</code>: 用户名</li>
<li><code>authentication_string</code>: 密码，通过 <code>mysql</code> 的 <code>password()</code> 函数加密后的密码</li>
</ul>
</li>
<li><p>用户操作</p>
<ul>
<li><p>创建用户</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 创建用户，同时指定密码<br><span class="hljs-keyword">create</span> <span class="hljs-keyword">user</span> <span class="hljs-string">&#x27;用户名&#x27;</span>@<span class="hljs-string">&#x27;允许登录位置&#x27;</span> identified <span class="hljs-keyword">by</span> <span class="hljs-string">&#x27;密码&#x27;</span>;<br></code></pre></td></tr></table></figure>
</li>
<li><p>删除用户</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 创建用户，同时指定密码<br><span class="hljs-keyword">drop</span> <span class="hljs-keyword">user</span> <span class="hljs-string">&#x27;用户名&#x27;</span>@<span class="hljs-string">&#x27;允许登录位置&#x27;</span>;<br></code></pre></td></tr></table></figure>
</li>
<li><p>修改密码</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 修改自己的密码<br><span class="hljs-keyword">set</span> password <span class="hljs-operator">=</span> password(<span class="hljs-string">&#x27;密码&#x27;</span>);<br><br># 修改他人的密码（需要有修改用户密码权限）<br><span class="hljs-keyword">set</span> password <span class="hljs-keyword">for</span> <span class="hljs-string">&#x27;用户名&#x27;</span>@<span class="hljs-string">&#x27;登录位置&#x27;</span> <span class="hljs-operator">=</span> password(<span class="hljs-string">&#x27;密码&#x27;</span>);      <br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>不同的数据库用户，操作的库和表不相同<br>  <img src="/img/mk-2022-09-25-16-26.png" srcset="/img/loading.gif" lazyload alt="MySQL 用户"><br>  <img src="/img/mk-2022-09-25-16-35.png" srcset="/img/loading.gif" lazyload alt="MySQL 用户"></p>
<ul>
<li>不用的数据库用户，登录到 <code>MySQL DBMS</code> 后，根据相应的权限，可以操作的数据库和数据对象（表、视图、触发器）都不一样</li>
</ul>
</li>
<li><p>细节补充说明</p>
<ol>
<li><p>在创建用户的时候，如果不指定 <code>Host</code>，则为 <code>%</code>，表示所有的 IP 都有连接权限</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">USER</span> <span class="hljs-string">&#x27;用户名&#x27;</span>;<br></code></pre></td></tr></table></figure>
</li>
<li><p>创建用户时，也可以这样指定，表示用户在 <code>192.168.1.*</code> 的 IP 可以登录 MySQL</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 表示用户在 <span class="hljs-number">192.168</span><span class="hljs-number">.1</span>.<span class="hljs-operator">*</span> 的 IP 可以登录 MySQL<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">USER</span> <span class="hljs-string">&#x27;用户名&#x27;</span>@<span class="hljs-string">&#x27;192.168.1.%&#x27;</span>;<br></code></pre></td></tr></table></figure>
</li>
<li><p>删除用户时，如果 <code>Host</code> 不是 <code>%</code>，则需要明确指定 <code>&#39;用户&#39;@&#39;Host 值&#39;</code></p>
</li>
</ol>
</li>
</ul>
<h4 id="MySQL-权限管理"><a href="#MySQL-权限管理" class="headerlink" title="MySQL 权限管理"></a>MySQL 权限管理</h4><ul>
<li><p>MySQL 权限列表</p>
<table>
<thead>
<tr>
<th align="left">权限</th>
<th align="left">作用范围</th>
<th align="left">作  用</th>
</tr>
</thead>
<tbody><tr>
<td align="left">all</td>
<td align="left">服务器</td>
<td align="left">所有权限</td>
</tr>
<tr>
<td align="left">select</td>
<td align="left">表、列</td>
<td align="left">选择行</td>
</tr>
<tr>
<td align="left">insert</td>
<td align="left">表、列</td>
<td align="left">插入行</td>
</tr>
<tr>
<td align="left">update</td>
<td align="left">表、列</td>
<td align="left">更新行</td>
</tr>
<tr>
<td align="left">delete</td>
<td align="left">表</td>
<td align="left">删除行</td>
</tr>
<tr>
<td align="left">create</td>
<td align="left">数据库、表、索引</td>
<td align="left">创建</td>
</tr>
<tr>
<td align="left">drop</td>
<td align="left">数据库、表、视图</td>
<td align="left">删除</td>
</tr>
<tr>
<td align="left">reload</td>
<td align="left">服务器</td>
<td align="left">允许使用flush语句</td>
</tr>
<tr>
<td align="left">shutdown</td>
<td align="left">服务器</td>
<td align="left">关闭服务</td>
</tr>
<tr>
<td align="left">process</td>
<td align="left">服务器</td>
<td align="left">查看线程信息</td>
</tr>
<tr>
<td align="left">file</td>
<td align="left">服务器</td>
<td align="left">文件操作</td>
</tr>
<tr>
<td align="left">grant option</td>
<td align="left">数据库、表、存储过程</td>
<td align="left">授权</td>
</tr>
<tr>
<td align="left">references</td>
<td align="left">数据库、表</td>
<td align="left">外键约束的父表</td>
</tr>
<tr>
<td align="left">index</td>
<td align="left">表</td>
<td align="left">创建&#x2F;删除索引</td>
</tr>
<tr>
<td align="left">alter</td>
<td align="left">表</td>
<td align="left">修改表结构</td>
</tr>
<tr>
<td align="left">show databases</td>
<td align="left">服务器</td>
<td align="left">查看数据库名称</td>
</tr>
<tr>
<td align="left">super</td>
<td align="left">服务器</td>
<td align="left">超级权限</td>
</tr>
<tr>
<td align="left">create temporary tables</td>
<td align="left">表</td>
<td align="left">创建临时表</td>
</tr>
<tr>
<td align="left">lock tables</td>
<td align="left">数据库</td>
<td align="left">锁表</td>
</tr>
<tr>
<td align="left">execute</td>
<td align="left">存储过程</td>
<td align="left">执行</td>
</tr>
<tr>
<td align="left">replication client</td>
<td align="left">服务器</td>
<td align="left">允许查看主&#x2F;从&#x2F;二进制日志状态</td>
</tr>
<tr>
<td align="left">replication slave</td>
<td align="left">服务器</td>
<td align="left">主从复制</td>
</tr>
<tr>
<td align="left">create view</td>
<td align="left">视图</td>
<td align="left">创建视图</td>
</tr>
<tr>
<td align="left">show view</td>
<td align="left">视图</td>
<td align="left">查看视图</td>
</tr>
<tr>
<td align="left">create routine</td>
<td align="left">存储过程</td>
<td align="left">创建存储过程</td>
</tr>
<tr>
<td align="left">alter routine</td>
<td align="left">存储过程</td>
<td align="left">修改&#x2F;删除存储过程</td>
</tr>
<tr>
<td align="left">create user</td>
<td align="left">服务器</td>
<td align="left">创建用户</td>
</tr>
<tr>
<td align="left">event</td>
<td align="left">数据库</td>
<td align="left">创建&#x2F;更改&#x2F;删除&#x2F;查看事件</td>
</tr>
<tr>
<td align="left">trigger</td>
<td align="left">表</td>
<td align="left">触发器</td>
</tr>
<tr>
<td align="left">create tablespace</td>
<td align="left">服务器</td>
<td align="left">创建&#x2F;更改&#x2F;删除表空间&#x2F;日志文件</td>
</tr>
<tr>
<td align="left">proxy</td>
<td align="left">服务器</td>
<td align="left">代理成为其它用户</td>
</tr>
<tr>
<td align="left">usage</td>
<td align="left">服务器</td>
<td align="left">没有权限</td>
</tr>
</tbody></table>
</li>
<li><p>用户授权</p>
<ul>
<li><p>基本语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">grant</span> 权限列表 <span class="hljs-keyword">on</span> 库.对象名 <span class="hljs-keyword">to</span> <span class="hljs-string">&#x27;用户名&#x27;</span>@<span class="hljs-string">&#x27;登录位置&#x27;</span> [identified <span class="hljs-keyword">by</span> <span class="hljs-string">&#x27;密码&#x27;</span>];<br></code></pre></td></tr></table></figure>
</li>
<li><p>说明：</p>
<ol>
<li><p>权限列表，多个权限用逗号分开</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">grant</span> <span class="hljs-keyword">select</span> <span class="hljs-keyword">on</span> ......<br><span class="hljs-keyword">grant</span> <span class="hljs-keyword">select</span>, <span class="hljs-keyword">delete</span>, <span class="hljs-keyword">create</span> <span class="hljs-keyword">on</span> .....<br><span class="hljs-keyword">grant</span> <span class="hljs-keyword">all</span> [privileges] <span class="hljs-keyword">on</span> ...... <span class="hljs-operator">/</span><span class="hljs-operator">/</span>表示赋予该用户在该对象上的所有权限<br></code></pre></td></tr></table></figure>
</li>
<li><p>特别说明<br> <code>*.*</code>: 表示<strong>本系统中</strong>的<strong>所有数据库的所有对象</strong>（表，视图，存储过程）<br> <code>库.*</code>: 表示<strong>某个数据库中</strong>的<strong>所有数据对象</strong>（表，视图，存储过程等）</p>
</li>
<li><p><code>identified by</code> 可以省略，也可以写出</p>
<ol>
<li>如果用户存在，则在授权的同时修改该用户的密码</li>
<li>如果用户不存在，则在授权的同时创建该用户</li>
</ol>
</li>
</ol>
</li>
</ul>
</li>
<li><p>回收用户授权</p>
<ul>
<li><p>基本语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">revoke</span> 权限列表 <span class="hljs-keyword">on</span> 库.对象名 <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;用户名&#x27;</span>@<span class="hljs-string">&#x27;登录位置&#x27;</span>;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>权限生效指令（MySQL 5.7 以下）</p>
<ul>
<li><p>在低版本 MySQL 中，如果权限没有生效，可以执行下面的命令</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">flush privileges;<br></code></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>应用案例</p>
<ol>
<li><p>创建一个用户 <code>jack</code>，密码 <code>123</code>，并且从本地登录</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 用户 <span class="hljs-string">&#x27;root&#x27;</span>@<span class="hljs-string">&#x27;localhost&#x27;</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">USER</span> <span class="hljs-string">&#x27;jack&#x27;</span>@<span class="hljs-string">&#x27;localhost&#x27;</span><br>    IDENTIFIED <span class="hljs-keyword">BY</span> <span class="hljs-string">&#x27;123&#x27;</span>;<br></code></pre></td></tr></table></figure>
</li>
<li><p>使用 <code>root</code> 用户创建 <code>test_db</code> 库和 <code>news</code> 表</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 用户 <span class="hljs-string">&#x27;root&#x27;</span>@<span class="hljs-string">&#x27;localhost&#x27;</span><br><span class="hljs-keyword">CREATE</span> DATABASE test_db<br>    CHARSET <span class="hljs-operator">=</span> utf8<br>    <span class="hljs-keyword">COLLATE</span> utf8_general_ci;<br><br>USE test_db; <span class="hljs-comment">-- 使用 test_db 表</span><br><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `news` (<br>    id <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,<br>    `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span><br>)CHARSET <span class="hljs-operator">=</span> utf8;<br></code></pre></td></tr></table></figure>
</li>
<li><p>给用户分配查看 <code>news</code> 表和添加数据的权限</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 用户 <span class="hljs-string">&#x27;root&#x27;</span>@<span class="hljs-string">&#x27;localhost&#x27;</span><br><span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">SELECT</span>, <span class="hljs-keyword">INSERT</span><br>    <span class="hljs-keyword">ON</span> test_db.news<br>    <span class="hljs-keyword">TO</span> <span class="hljs-string">&#x27;jack&#x27;</span>@<span class="hljs-string">&#x27;localhost&#x27;</span>;<br></code></pre></td></tr></table></figure>
</li>
<li><p>测试看看用户是否只有这几个权限</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 用户 <span class="hljs-string">&#x27;jack&#x27;</span>@<span class="hljs-string">&#x27;localhost&#x27;</span><br># 登录 jack 用户，测试用户权限<br>USE test_db;<br><br><span class="hljs-keyword">DESC</span> news; <span class="hljs-comment">-- 查询表结构</span><br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `news` <span class="hljs-comment">-- 添加数据</span><br>    <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">100</span>, <span class="hljs-string">&#x27;新闻1&#x27;</span>),(<span class="hljs-number">200</span>,<span class="hljs-string">&#x27;新闻2&#x27;</span>);<br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> news; <span class="hljs-comment">-- 查询表数据</span><br><br><span class="hljs-comment">-- 尝试删除数据库，没有权限</span><br><span class="hljs-keyword">DROP</span> DATABASE test_db;<br></code></pre></td></tr></table></figure>
</li>
<li><p>修改密码为 <code>abc</code>，要求：使用 <code>root</code> 用户完成</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 用户 <span class="hljs-string">&#x27;root&#x27;</span>@<span class="hljs-string">&#x27;localhost&#x27;</span><br><span class="hljs-keyword">SET</span> PASSWORD <br>    <span class="hljs-keyword">FOR</span> <span class="hljs-string">&#x27;jack&#x27;</span>@<span class="hljs-string">&#x27;localhost&#x27;</span> <span class="hljs-operator">=</span> PASSWORD(<span class="hljs-string">&#x27;abc&#x27;</span>)<br></code></pre></td></tr></table></figure>
</li>
<li><p>回收用户 jack 的所有权限</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">REVOKE</span> <span class="hljs-keyword">ALL</span> <span class="hljs-keyword">ON</span> test_db.news <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;jack&#x27;</span>@<span class="hljs-string">&#x27;localhost&#x27;</span>;<br></code></pre></td></tr></table></figure>
</li>
<li><p>使用 <code>root</code> 用户删除你的用户</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 用户 <span class="hljs-string">&#x27;root&#x27;</span>@<span class="hljs-string">&#x27;localhost&#x27;</span><br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">USER</span> <span class="hljs-string">&#x27;jack&#x27;</span>@<span class="hljs-string">&#x27;localhost&#x27;</span>;<br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> mysql.user; <span class="hljs-comment">-- 查询用户</span><br></code></pre></td></tr></table></figure></li>
</ol>
</li>
</ul>
<h3 id="第二十二章课后练习"><a href="#第二十二章课后练习" class="headerlink" title="第二十二章课后练习"></a>第二十二章课后练习</h3><ol>
<li><p>使用简单查询语句</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 1. 显示所有部门名称</span><br><span class="hljs-keyword">SELECT</span> d_name <span class="hljs-keyword">FROM</span> dept;<br><br><span class="hljs-comment">-- 2. 显示所有雇员名及其全年收入13月（工资+补助），并指定列别名「年收入」</span><br><span class="hljs-keyword">SELECT</span> e_name, (sal <span class="hljs-operator">+</span> IFNULL(comm, <span class="hljs-number">0</span>)) <span class="hljs-operator">*</span> <span class="hljs-number">13</span> <span class="hljs-keyword">AS</span> <span class="hljs-string">&#x27;年收入&#x27;</span><br>    <span class="hljs-keyword">FROM</span> emp;<br></code></pre></td></tr></table></figure>
</li>
<li><p>限制查询数据</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 1. 显示工资不在 1500 到 2850 之间的所有雇员名及工资</span><br><span class="hljs-keyword">SELECT</span> e_name, sal<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">NOT</span> (sal <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">1500</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">2850</span>);<br>    <span class="hljs-comment">-- where sal &lt; 1500 or sal &gt; 2850;</span><br><br><span class="hljs-comment">-- 2. 显示编号为 7566 的雇员姓名及所在部门编号</span><br><span class="hljs-keyword">SELECT</span> e_name, dept_no<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> emp_no <span class="hljs-operator">=</span> <span class="hljs-number">7566</span>;<br><br><span class="hljs-comment">-- 3. 显示部门 10 和 30 中工资超过 1500 的雇员名及工资</span><br><span class="hljs-keyword">SELECT</span> e_name, sal<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> dept_no <span class="hljs-keyword">IN</span> (<span class="hljs-number">10</span>, <span class="hljs-number">30</span>) <span class="hljs-keyword">AND</span> sal <span class="hljs-operator">&gt;</span> <span class="hljs-number">1500</span>;<br><br><span class="hljs-comment">-- 4. 显示没有上级的雇员名及岗位</span><br><span class="hljs-keyword">SELECT</span> e_name, job<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> mgr <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NULL</span>;<br></code></pre></td></tr></table></figure>
</li>
<li><p>排序数据</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 1. 显示在 1991年2月1日 到 1991年5月1日 之间雇用的雇员名，岗位及雇佣日期，并以雇佣日期进行排序</span><br><span class="hljs-keyword">SELECT</span> e_name, job, hire_date<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> hire_date <br>        <span class="hljs-keyword">BETWEEN</span> <span class="hljs-string">&#x27;1991.2.1&#x27;</span> <span class="hljs-keyword">AND</span> <span class="hljs-string">&#x27;1991.5.1&#x27;</span><br>    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> hire_date <span class="hljs-keyword">ASC</span>;<br><br><span class="hljs-comment">-- 2. 显示获得补助的所有雇员名，工资及补助，并以工资降序排序</span><br><span class="hljs-keyword">SELECT</span> e_name, sal, comm<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> comm <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span><br>    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> sal <span class="hljs-keyword">DESC</span>;<br></code></pre></td></tr></table></figure>
</li>
<li><p>写出正确 SQL 语句</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 1. 查询部门 30 中的所有员工</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> dept_no <span class="hljs-operator">=</span> <span class="hljs-number">30</span>;<br><br><span class="hljs-comment">-- 2. 列出所有办事员 (CLERK) 的姓名，编号和部门编号</span><br><span class="hljs-keyword">SELECT</span> e_name, emp_no, dept_no<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> job <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;clerk&#x27;</span>;<br><br><span class="hljs-comment">-- 3. 找出佣金高于薪金的员工</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> IFNULL(comm,<span class="hljs-number">0</span>) <span class="hljs-operator">&gt;</span> sal;<br><br><span class="hljs-comment">-- 4. 找出佣金高于薪金 30% 的员工</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> IFNULL(comm,<span class="hljs-number">0</span>) <span class="hljs-operator">&gt;</span> (sal<span class="hljs-operator">*</span><span class="hljs-number">0.3</span>);<br><br><span class="hljs-comment">-- 5. 找出部门 10 中所有经理 (MANAGER) 和部门 20 中所有销售 (SALESMAN) 的详细资料</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> (dept_no <span class="hljs-operator">=</span> <span class="hljs-number">10</span> <span class="hljs-keyword">AND</span> job <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;manager&#x27;</span>)<br>        <span class="hljs-keyword">OR</span> (dept_no <span class="hljs-operator">=</span> <span class="hljs-number">20</span> <span class="hljs-keyword">AND</span> job <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;salesman&#x27;</span>);<br><br><span class="hljs-comment">-- 6. 找出部门 10 中所有经理 (MANAGER)，部门 20 中所有销售 (SALESMAN)，还有既不是经理又不是销售，但其薪金大于或等于 2000 的所有员工的详细资料</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> (dept_no <span class="hljs-operator">=</span> <span class="hljs-number">10</span> <span class="hljs-keyword">AND</span> job <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;manager&#x27;</span>)<br>        <span class="hljs-keyword">OR</span> (dept_no <span class="hljs-operator">=</span> <span class="hljs-number">20</span> <span class="hljs-keyword">AND</span> job <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;salesman&#x27;</span>)<br>        <span class="hljs-keyword">OR</span> (<span class="hljs-keyword">NOT</span> (job <span class="hljs-keyword">IN</span>(<span class="hljs-string">&#x27;manager&#x27;</span>,<span class="hljs-string">&#x27;salesman&#x27;</span>)) <span class="hljs-keyword">AND</span> sal <span class="hljs-operator">&gt;=</span> <span class="hljs-number">2000</span>);<br><br><span class="hljs-comment">-- 7. 找出收取佣金的员工不同工作</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DISTINCT</span> job<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> comm <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>;<br><br><span class="hljs-comment">-- 8. 找出不收取佣金或收取的佣金低于 100 的员工</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> comm <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">OR</span> comm <span class="hljs-operator">&lt;</span> <span class="hljs-number">100</span>;<br><br><span class="hljs-comment">-- 9. 找出各月倒数第 3 天受雇的所有员工</span><br><span class="hljs-comment">-- 查询某月最后一天</span><br><span class="hljs-keyword">SELECT</span> LAST_DAY(<span class="hljs-string">&#x27;2011.1.1&#x27;</span>); <span class="hljs-comment">-- 2011-01-31</span><br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> hire_date <span class="hljs-operator">=</span> LAST_DAY(hire_date) <span class="hljs-operator">-</span> <span class="hljs-number">2</span>; <span class="hljs-comment">-- -2 得到倒数第三天的日期</span><br><br><span class="hljs-comment">-- 10. 找出入职时间超过 12 年的员工</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span><br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> DATE_ADD(hire_date, <span class="hljs-type">INTERVAL</span> <span class="hljs-number">12</span> <span class="hljs-keyword">YEAR</span>) <span class="hljs-operator">&lt;</span> NOW();<br>    <span class="hljs-comment">-- WHERE hire_date &lt; NOW() - 11;</span><br><br><span class="hljs-comment">-- 11. 以首字母小写的方式显示所有员工的姓名</span><br><span class="hljs-keyword">SELECT</span> CONCAT(LCASE(<span class="hljs-built_in">SUBSTRING</span>(e_name,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)), <span class="hljs-built_in">SUBSTRING</span>(e_name,<span class="hljs-number">2</span>)) <span class="hljs-string">&#x27;e_name&#x27;</span><br>    <span class="hljs-keyword">FROM</span> emp<br><br><span class="hljs-comment">-- 12. 显示正好为 5 个字符的员工的姓名</span><br><span class="hljs-keyword">SELECT</span> e_name<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> LENGTH(e_name) <span class="hljs-operator">=</span> <span class="hljs-number">5</span>;<br></code></pre></td></tr></table></figure>
</li>
<li><p>写出正确 SQL 语句</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 13.显示不带有&quot;R&quot;的员工的姓名</span><br><span class="hljs-keyword">SELECT</span> e_name<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> e_name <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;%R%&#x27;</span>;<br>    <span class="hljs-comment">-- WHERE INSTR(e_name, &#x27;R&#x27;) = 0;</span><br><br><span class="hljs-comment">-- 14.显示所有员工姓名的前三个字符</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">LEFT</span>(e_name, <span class="hljs-number">3</span>)<br>    <span class="hljs-keyword">FROM</span> emp;<br><br><span class="hljs-comment">-- 15.显示所有员工的姓名，用&quot;a&quot;替换所有&quot;A&quot;</span><br><span class="hljs-keyword">SELECT</span> REPLACE(e_name, <span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>)<br>    <span class="hljs-keyword">FROM</span> emp;<br><br><span class="hljs-comment">-- 16.显示满10年服务年限的员工的姓名和受雇日期</span><br><span class="hljs-keyword">SELECT</span> e_name, hire_date<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> DATE_ADD(hire_date, <span class="hljs-type">INTERVAL</span> <span class="hljs-number">10</span> <span class="hljs-keyword">YEAR</span>) <span class="hljs-operator">&lt;</span> NOW();<br><br><span class="hljs-comment">-- 17.显示员工的详细资料，按姓名排序</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> e_name;<br><br><span class="hljs-comment">-- 18.显示员工的姓名和受雇日期，根据其服务年限，将最老的员工排在最前面</span><br><span class="hljs-keyword">SELECT</span> e_name, hire_date<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> hire_date;<br><br><span class="hljs-comment">-- 19.显示所有员工的姓名、工作和薪金按工作降序排序，若工作相同则按薪金排序</span><br><span class="hljs-keyword">SELECT</span> e_name, job, sal<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> job <span class="hljs-keyword">DESC</span>, sal;<br><br><br><span class="hljs-comment">-- 20.显示所有员工的姓名、加入公司的年份和月份，按受雇日期所在月排序</span><br>    <span class="hljs-comment">-- 若月份相同则将最早年份的员工排在最前面</span><br><span class="hljs-keyword">SELECT</span> e_name, CONCAT(<span class="hljs-keyword">YEAR</span>(hire_date), <span class="hljs-string">&#x27;-&#x27;</span>, <span class="hljs-keyword">MONTH</span>(hire_date))<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">MONTH</span>(hire_date), <span class="hljs-keyword">YEAR</span>(hire_date);<br><br><span class="hljs-comment">-- 21.显示在一个月为30天的情况所有员工的日薪金，忽略余数</span><br><span class="hljs-keyword">SELECT</span> e_name, <span class="hljs-built_in">FLOOR</span>(sal<span class="hljs-operator">/</span><span class="hljs-number">30</span>)<br>    <span class="hljs-keyword">FROM</span> emp;<br><br><span class="hljs-comment">-- 22.找出在（任何年份的）2月受聘的所有员工</span><br><span class="hljs-keyword">SELECT</span> e_name, hire_date<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">MONTH</span>(hire_date) <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;<br><br><span class="hljs-comment">-- 23.对于每个员工显示其加入公司的天数</span><br><span class="hljs-keyword">SELECT</span> e_name, DATEDIFF(NOW(), hire_date)<br>    <span class="hljs-keyword">FROM</span> emp;<br><br><span class="hljs-comment">-- 24.显示姓名字段的任何位置包含&quot;A&quot;的所有员工的姓名</span><br><span class="hljs-keyword">SELECT</span> e_name<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> e_name <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;%A%&#x27;</span>;<br>    <span class="hljs-comment">-- WHERE INSTR(e_name, &#x27;A&#x27;) &lt;&gt; 0;</span><br><br><span class="hljs-comment">-- 25.以年月日的方式显示所有员工的服务年限（大概）</span><br><span class="hljs-keyword">SELECT</span> e_name, <span class="hljs-built_in">FLOOR</span>(DATEDIFF(NOW(), hire_date) <span class="hljs-operator">/</span> <span class="hljs-number">365</span>) <span class="hljs-keyword">AS</span> <span class="hljs-string">&#x27;工作年&#x27;</span>,  <br>        <span class="hljs-built_in">FLOOR</span>(DATEDIFF(NOW(), hire_date) <span class="hljs-operator">%</span> <span class="hljs-number">365</span> <span class="hljs-operator">/</span> <span class="hljs-number">31</span>) <span class="hljs-keyword">AS</span> <span class="hljs-string">&#x27;工作月&#x27;</span>,<br>        DATEDIFF(NOW(), hire_date) <span class="hljs-operator">%</span> <span class="hljs-number">31</span> <span class="hljs-keyword">AS</span> <span class="hljs-string">&#x27;工作日&#x27;</span><br>    <span class="hljs-keyword">FROM</span> emp;<br></code></pre></td></tr></table></figure>
</li>
<li><p>根据 <code>emp</code> 员工表、<code>dept</code> 部门表，写出正确的 <code>SQL</code> 语句</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 1.列出至少有一个员工的所有部门</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">AS</span> c, dept_no<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> dept_no<br>    <span class="hljs-keyword">HAVING</span> c <span class="hljs-operator">&gt;=</span> <span class="hljs-number">1</span>;<br><br><span class="hljs-comment">-- 2.列出薪金比「SMITH」多的所有员工</span><br><span class="hljs-keyword">SELECT</span> e_name, sal<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> sal <span class="hljs-operator">&gt;</span> (<br>        <span class="hljs-keyword">SELECT</span> sal <span class="hljs-keyword">FROM</span> emp <br>            <span class="hljs-keyword">WHERE</span> e_name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;SMITH&#x27;</span><br>    );<br><br><span class="hljs-comment">-- 3.列出受雇日期晚于其直接上级的所有员工</span><br><span class="hljs-keyword">SELECT</span> worker.e_name <span class="hljs-string">&#x27;姓名&#x27;</span>, worker.hire_date <span class="hljs-string">&#x27;入职时间&#x27;</span>,<br>    leader.e_name <span class="hljs-string">&#x27;上级姓名&#x27;</span>, leader.hire_date <span class="hljs-string">&#x27;上级入职时间&#x27;</span><br>    <span class="hljs-keyword">FROM</span> emp <span class="hljs-keyword">AS</span> worker, emp <span class="hljs-keyword">AS</span> leader<br>    <span class="hljs-keyword">WHERE</span> worker.hire_date <span class="hljs-operator">&gt;</span> leader.hire_date<br>        <span class="hljs-keyword">AND</span> worker.mgr <span class="hljs-operator">=</span> leader.emp_no;<br>    <br><br><span class="hljs-comment">-- 4.列出部门名称和这些部门的员工信息，同时列出那些没有员工的部门</span><br><span class="hljs-keyword">SELECT</span> d_name, emp.<span class="hljs-operator">*</span> <span class="hljs-comment">-- emp.*: 所有信息</span><br>    <span class="hljs-keyword">FROM</span> emp <span class="hljs-keyword">RIGHT</span> <span class="hljs-keyword">JOIN</span> dept<br>    <span class="hljs-keyword">ON</span> dept.dept_no <span class="hljs-operator">=</span> emp.dept_no;<br><br><span class="hljs-comment">-- 5.列出所有「CLERK」(办事员)的姓名及其部门名称</span><br><span class="hljs-keyword">SELECT</span> e_name, d_name, emp.dept_no<br>    <span class="hljs-keyword">FROM</span> emp, dept<br>    <span class="hljs-keyword">WHERE</span> job <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;CLERK&#x27;</span> <br>        <span class="hljs-keyword">AND</span> emp.dept_no <span class="hljs-operator">=</span> dept.dept_no;<br><br><span class="hljs-comment">-- 6.列出最低薪金大于1500的工作</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MIN</span>(sal) <span class="hljs-keyword">AS</span> min_sal, job<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> job<br>    <span class="hljs-keyword">HAVING</span> min_sal <span class="hljs-operator">&gt;</span> <span class="hljs-number">1500</span>;<br><br><span class="hljs-comment">-- 7.列出在部门「SALES」(销售部)工作的员工的姓名</span><br><span class="hljs-keyword">SELECT</span> e_name, d_name<br>    <span class="hljs-keyword">FROM</span> emp, dept<br>    <span class="hljs-keyword">WHERE</span> d_name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;SALES&#x27;</span><br>        <span class="hljs-keyword">AND</span> emp.dept_no <span class="hljs-operator">=</span> dept.dept_no;<br><br><span class="hljs-comment">-- 8.列出薪金高于公司平均薪金的所有员工</span><br><span class="hljs-keyword">SELECT</span> e_name, sal<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> sal <span class="hljs-operator">&gt;</span> (<br>        <span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">AVG</span>(sal) <span class="hljs-keyword">FROM</span> emp<br>    );<br><br><span class="hljs-comment">-- 9.列出与「SCOTT」从事相同工作的所有员工</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> job <span class="hljs-operator">=</span> (<br>        <span class="hljs-keyword">SELECT</span> job <span class="hljs-keyword">FROM</span> emp <br>            <span class="hljs-keyword">WHERE</span> e_name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;SCOTT&#x27;</span><br>    );<br><br><span class="hljs-comment">-- 10.列出薪金高于 30 部门所有员工的员工姓名和薪金</span><br><span class="hljs-keyword">SELECT</span> e_name, sal<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> sal <span class="hljs-operator">&gt;</span> (<br>        <span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MAX</span>(sal) <span class="hljs-keyword">FROM</span> emp <span class="hljs-keyword">WHERE</span> dept_no <span class="hljs-operator">=</span> <span class="hljs-number">30</span><br>    );<br><br><span class="hljs-comment">-- 11.列出在每个部门工作的员工数量、平均工资和平均服务年限</span><br><span class="hljs-keyword">SELECT</span> dept_no, <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">AS</span> <span class="hljs-string">&#x27;员工数量&#x27;</span>, FORMAT(<span class="hljs-built_in">AVG</span>(sal),<span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> <span class="hljs-string">&#x27;平均工资&#x27;</span>, <br>    FORMAT(<span class="hljs-built_in">AVG</span>(DATEDIFF(NOW(), hire_date)<span class="hljs-operator">/</span><span class="hljs-number">365</span>),<span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> <span class="hljs-string">&#x27;平均服务年限&#x27;</span><br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> dept_no;<br><br><span class="hljs-comment">-- 12.列出所有员工的姓名、部门名称和总工资（薪金+奖金）</span><br><span class="hljs-keyword">SELECT</span> e_name, d_name, sal <span class="hljs-operator">+</span> IFNULL(comm, <span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">FROM</span> emp, dept<br>    <span class="hljs-keyword">WHERE</span> emp.dept_no <span class="hljs-operator">=</span> dept.dept_no;<br><br><span class="hljs-comment">-- 13.列出所有部门的详细信息和部门人数</span><br><span class="hljs-keyword">SELECT</span> dept.<span class="hljs-operator">*</span>, temp.c<br>    <span class="hljs-keyword">FROM</span> dept <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">AS</span> c, dept_no<br>        <span class="hljs-keyword">FROM</span> emp<br>        <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> dept_no) temp<br>    <span class="hljs-keyword">ON</span> temp.dept_no <span class="hljs-operator">=</span> dept.dept_no;<br><br><span class="hljs-comment">-- 14.列出各种工作的最低工资（薪金+奖金）</span><br><span class="hljs-keyword">SELECT</span> job, <span class="hljs-built_in">MIN</span>(sal <span class="hljs-operator">+</span> IFNULL(comm,<span class="hljs-number">0</span>))<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> job;<br><br><span class="hljs-comment">-- 15.列出「MANAGER」(经理)的最低薪金</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MIN</span>(sal)<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">WHERE</span> job <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;MANAGER&#x27;</span>;<br><br><span class="hljs-comment">-- 16.列出所有员工的年工资，按年薪从低到高排序</span><br><span class="hljs-keyword">SELECT</span> e_name, (sal <span class="hljs-operator">+</span> IFNULL(comm,<span class="hljs-number">0</span>)) <span class="hljs-operator">*</span> <span class="hljs-number">12</span> <span class="hljs-keyword">AS</span> year_sal<br>    <span class="hljs-keyword">FROM</span> emp<br>    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> year_sal;<br></code></pre></td></tr></table></figure></li>
</ol>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Java/" class="category-chain-item">Java</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Java/">#Java</a>
      
        <a href="/tags/%E5%AD%A6%E4%B9%A0/">#学习</a>
      
        <a href="/tags/%E6%8A%80%E6%9C%AF/">#技术</a>
      
    </div>
  
</div>


              

              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/10/05/%E7%AC%AC%E4%B8%80%E7%AB%A0/" title="第一章">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">第一章</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/10/05/java_learn/Java%E5%9F%BA%E7%A1%80%204/" title="Java基础 第四章">
                        <span class="hidden-mobile">Java基础 第四章</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
